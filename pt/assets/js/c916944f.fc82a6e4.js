"use strict";(self.webpackChunkcasdoor_website=self.webpackChunkcasdoor_website||[]).push([[7616],{3905:(e,a,t)=>{t.d(a,{Zo:()=>d,kt:()=>u});var o=t(67294);function n(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function r(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);a&&(o=o.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,o)}return t}function i(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?r(Object(t),!0).forEach((function(a){n(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function p(e,a){if(null==e)return{};var t,o,n=function(e,a){if(null==e)return{};var t,o,n={},r=Object.keys(e);for(o=0;o<r.length;o++)t=r[o],a.indexOf(t)>=0||(n[t]=e[t]);return n}(e,a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)t=r[o],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(n[t]=e[t])}return n}var s=o.createContext({}),l=function(e){var a=o.useContext(s),t=a;return e&&(t="function"==typeof e?e(a):i(i({},a),e)),t},d=function(e){var a=l(e.components);return o.createElement(s.Provider,{value:a},e.children)},m={inlineCode:"code",wrapper:function(e){var a=e.children;return o.createElement(o.Fragment,{},a)}},c=o.forwardRef((function(e,a){var t=e.components,n=e.mdxType,r=e.originalType,s=e.parentName,d=p(e,["components","mdxType","originalType","parentName"]),c=l(t),u=n,g=c["".concat(s,".").concat(u)]||c[u]||m[u]||r;return t?o.createElement(g,i(i({ref:a},d),{},{components:t})):o.createElement(g,i({ref:a},d))}));function u(e,a){var t=arguments,n=a&&a.mdxType;if("string"==typeof e||n){var r=t.length,i=new Array(r);i[0]=c;var p={};for(var s in a)hasOwnProperty.call(a,s)&&(p[s]=a[s]);p.originalType=e,p.mdxType="string"==typeof e?e:n,i[1]=p;for(var l=2;l<r;l++)i[l]=t[l];return o.createElement.apply(null,i)}return o.createElement.apply(null,t)}c.displayName="MDXCreateElement"},91154:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>s,contentTitle:()=>i,default:()=>m,frontMatter:()=>r,metadata:()=>p,toc:()=>l});var o=t(87462),n=(t(67294),t(3905));const r={title:"Nginx",description:"Usando o Casdoor com Nginx",keywords:["nginx","plus","nginx-plus"],authors:["SkipperQ"]},i=void 0,p={unversionedId:"integration/C++/Nginx",id:"integration/C++/Nginx",title:"Nginx",description:"Usando o Casdoor com Nginx",source:"@site/i18n/pt/docusaurus-plugin-content-docs/current/integration/C++/Nginx.md",sourceDirName:"integration/C++",slug:"/integration/C++/Nginx",permalink:"/pt/docs/integration/C++/Nginx",draft:!1,editUrl:"https://github.com/casdoor/casdoor-website/edit/master/docs/integration/C++/Nginx.md",tags:[],version:"current",frontMatter:{title:"Nginx",description:"Usando o Casdoor com Nginx",keywords:["nginx","plus","nginx-plus"],authors:["SkipperQ"]},sidebar:"tutorialSidebar",previous:{title:"C++",permalink:"/pt/docs/category/cpp"},next:{title:"Vers\xe3o Comunit\xe1ria do Nginx",permalink:"/pt/docs/integration/C++/NginxCommunityVersion"}},s={},l=[{value:"Pr\xe9-requisitos",id:"pr\xe9-requisitos",level:2},{value:"Configurando o Casdoor",id:"configurando-o-casdoor",level:2},{value:"Configurando o NGINX Plus",id:"configurando-o-nginx-plus",level:2},{value:"Testando",id:"testando",level:2},{value:"Solu\xe7\xe3o de problemas",id:"solu\xe7\xe3o-de-problemas",level:2}],d={toc:l};function m(e){let{components:a,...r}=e;return(0,n.kt)("wrapper",(0,o.Z)({},d,r,{components:a,mdxType:"MDXLayout"}),(0,n.kt)("p",null,"Habilite o login \xfanico baseado em OpenID Connect para aplica\xe7\xf5es intermediadas pelo NGINX Plus usando o Casdoor como provedor de identidade (IdP)."),(0,n.kt)("p",null,"Este guia explica como habilitar o login \xfanico (SSO) para aplica\xe7\xf5es que est\xe3o sendo intermediadas pelo NGINX Plus. A solu\xe7\xe3o utiliza OpenID Connect como mecanismo de autentica\xe7\xe3o, com ",(0,n.kt)("a",{parentName:"p",href:"https://casdoor.org/"},"Casdoor")," como provedor de identidade (IdP) e NGINX Plus como a parte confiante."),(0,n.kt)("blockquote",null,(0,n.kt)("p",{parentName:"blockquote"},"Veja Tamb\xe9m: Voc\xea pode encontrar mais informa\xe7\xf5es sobre a integra\xe7\xe3o do NGINX Plus com OpenID Connect no reposit\xf3rio do projeto no ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/nginxinc/nginx-openid-connect"},"GitHub"),".")),(0,n.kt)("h2",{id:"pr\xe9-requisitos"},"Pr\xe9-requisitos"),(0,n.kt)("p",null,"As instru\xe7\xf5es presumem que voc\xea tenha o seguinte:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Um servidor Casdoor em execu\xe7\xe3o. Consulte a documenta\xe7\xe3o do Casdoor para ",(0,n.kt)("a",{parentName:"p",href:"https://casdoor.org/docs/basic/server-installation"},"Instala\xe7\xe3o do Servidor")," e ",(0,n.kt)("a",{parentName:"p",href:"https://casdoor.org/docs/basic/try-with-docker"},"Experimente com Docker"),".")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Uma assinatura do NGINX Plus e NGINX Plus R15 ou posterior. Para instru\xe7\xf5es de instala\xe7\xe3o, consulte o ",(0,n.kt)("a",{parentName:"p",href:"https://docs.nginx.com/nginx/admin-guide/installing-nginx/installing-nginx-plus/"},"Guia do Administrador do NGINX Plus"),".")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"O ",(0,n.kt)("a",{parentName:"p",href:"https://www.nginx.com/blog/introduction-nginscript/"},"m\xf3dulo JavaScript do NGINX"),", que \xe9 necess\xe1rio para lidar com a intera\xe7\xe3o entre o NGINX Plus e o IdP. Ap\xf3s instalar o NGINX Plus, instale o m\xf3dulo usando o comando apropriado para o seu sistema operacional."),(0,n.kt)("p",{parentName:"li"},"  Para Debian e Ubuntu:"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"sudo apt install nginx-plus-module-njs\n")),(0,n.kt)("p",{parentName:"li"},"  Para CentOS, RHEL e Oracle Linux:"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"sudo yum install nginx-plus-module-njs\n"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},'A seguinte diretiva deve ser inclu\xedda no contexto de configura\xe7\xe3o de n\xedvel superior ("main") em ',(0,n.kt)("strong",{parentName:"p"},"/etc/nginx/nginx.conf")," para carregar o m\xf3dulo JavaScript do NGINX:"),(0,n.kt)("p",{parentName:"li"},"  ",(0,n.kt)("inlineCode",{parentName:"p"},"load_module modules/ngx_http_js_module.so;")))),(0,n.kt)("h2",{id:"configurando-o-casdoor"},"Configurando o Casdoor"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Nota:")," O procedimento a seguir reflete a interface gr\xe1fica do Casdoor no momento da publica\xe7\xe3o, mas a interface pode sofrer altera\xe7\xf5es. Use este guia como refer\xeancia e adapte-o conforme necess\xe1rio \xe0 interface gr\xe1fica atual do Casdoor."),(0,n.kt)("p",null,"Para criar um cliente Casdoor para o NGINX Plus na interface gr\xe1fica do Casdoor, siga estes passos:"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Fa\xe7a login na sua conta Casdoor em ",(0,n.kt)("strong",{parentName:"p"},(0,n.kt)("a",{parentName:"strong",href:"http://your-casdoor-url.com/login/"},"http://your-casdoor-url.com/login/")),".")),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Na coluna de navega\xe7\xe3o superior, clique em ",(0,n.kt)("strong",{parentName:"p"},"Aplica\xe7\xe3o"),". Na p\xe1gina ",(0,n.kt)("strong",{parentName:"p"},"Aplica\xe7\xe3o")," que se abre, clique no bot\xe3o ",(0,n.kt)("strong",{parentName:"p"},"Adicionar")," no canto superior esquerdo."),(0,n.kt)("p",{parentName:"li"},(0,n.kt)("img",{alt:"addApp",src:t(38655).Z,width:"1974",height:"228"}))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Na p\xe1gina ",(0,n.kt)("strong",{parentName:"p"},"Editar Aplica\xe7\xe3o")," que se abre, altere o valor nos campos ",(0,n.kt)("strong",{parentName:"p"},"Nome")," e ",(0,n.kt)("strong",{parentName:"p"},"Nome de Exibi\xe7\xe3o")," para o nome da aplica\xe7\xe3o para a qual voc\xea est\xe1 habilitando o SSO. Aqui, estamos usando o NGINX Plus."),(0,n.kt)("p",{parentName:"li"},(0,n.kt)("img",{alt:"appName",src:t(82431).Z,width:"570",height:"214"})),(0,n.kt)("p",{parentName:"li"},"No campo ",(0,n.kt)("strong",{parentName:"p"},"URLs de Redirecionamento"),", digite a URL da inst\xe2ncia do NGINX Plus incluindo o n\xfamero da porta e terminando em ",(0,n.kt)("strong",{parentName:"p"},"/_codexch")," (neste guia \xe9 ",(0,n.kt)("a",{parentName:"p",href:"https://your-site-url.com/_codexch"},"https://your-site-url.com:443/_codexch"),")."),(0,n.kt)("p",{parentName:"li"},(0,n.kt)("img",{alt:"redirectURL",src:t(4124).Z,width:"988",height:"252"})),(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"Notas:")),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"Para produ\xe7\xe3o, recomendamos fortemente que voc\xea use SSL/TLS (porta 443)."),(0,n.kt)("li",{parentName:"ul"},"O n\xfamero da porta \xe9 obrigat\xf3rio mesmo quando voc\xea est\xe1 usando a porta padr\xe3o para HTTP (80) ou HTTPS (443)."))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Registre os valores nos campos ",(0,n.kt)("strong",{parentName:"p"},"Client ID")," e ",(0,n.kt)("strong",{parentName:"p"},"Client Secret"),". Voc\xea ir\xe1 copi\xe1-los para o arquivo de configura\xe7\xe3o do NGINX Plus em ",(0,n.kt)("a",{parentName:"p",href:"#jump1"},"Etapa 4 de ",(0,n.kt)("em",{parentName:"a"},"Configurando o NGINX Plus")),".",(0,n.kt)("span",{id:"jump3"})),(0,n.kt)("p",{parentName:"li"},(0,n.kt)("img",{alt:"Cliente",src:t(19598).Z,width:"1004",height:"216"}))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Clique em ",(0,n.kt)("strong",{parentName:"p"},"Fun\xe7\xf5es")," na coluna de navega\xe7\xe3o superior, depois clique no bot\xe3o ",(0,n.kt)("strong",{parentName:"p"},"Adicionar")," no canto superior esquerdo da p\xe1gina que se abre."),(0,n.kt)("p",{parentName:"li"},(0,n.kt)("img",{alt:"addRole",src:t(80816).Z,width:"1986",height:"224"}))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Na p\xe1gina ",(0,n.kt)("strong",{parentName:"p"},"Adicionar")," que se abre, digite um valor nos campos ",(0,n.kt)("strong",{parentName:"p"},"Nome")," e ",(0,n.kt)("strong",{parentName:"p"},"Nome de Exibi\xe7\xe3o")," (aqui \xe9 nginx-casdoor-role) e clique no bot\xe3o ",(0,n.kt)("strong",{parentName:"p"},"Salvar"),"."),(0,n.kt)("p",{parentName:"li"},(0,n.kt)("img",{alt:"roleName",src:t(88165).Z,width:"670",height:"204"}))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Na coluna de navega\xe7\xe3o superior, clique em ",(0,n.kt)("strong",{parentName:"p"},"Usu\xe1rios"),". Na p\xe1gina ",(0,n.kt)("strong",{parentName:"p"},"Usu\xe1rios")," que se abre, clique em ",(0,n.kt)("strong",{parentName:"p"},"Editar")," para editar um dos usu\xe1rios existentes ou clique no bot\xe3o ",(0,n.kt)("strong",{parentName:"p"},"Adicionar")," no canto superior esquerdo para criar um novo usu\xe1rio.")),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Na p\xe1gina ",(0,n.kt)("strong",{parentName:"p"},"Adicionar")," que se abre, modifique o ",(0,n.kt)("strong",{parentName:"p"},"Nome")," e ",(0,n.kt)("strong",{parentName:"p"},"Nome de Exibi\xe7\xe3o")," como desejar (aqui \xe9 user1)."),(0,n.kt)("p",{parentName:"li"},(0,n.kt)("img",{alt:"userName",src:t(17830).Z,width:"436",height:"230"})),(0,n.kt)("p",{parentName:"li"},"Selecione ",(0,n.kt)("strong",{parentName:"p"},"NGINX Plus")," no campo ",(0,n.kt)("strong",{parentName:"p"},"Aplica\xe7\xe3o de Inscri\xe7\xe3o"),"."),(0,n.kt)("p",{parentName:"li"},(0,n.kt)("img",{alt:"signupApp",src:t(30614).Z,width:"432",height:"108"})),(0,n.kt)("p",{parentName:"li"},"No campo ",(0,n.kt)("strong",{parentName:"p"},"Contas Gerenciadas"),", selecione ",(0,n.kt)("strong",{parentName:"p"},"NGINX Plus")," em ",(0,n.kt)("strong",{parentName:"p"},"Aplica\xe7\xe3o")," e preencha o nome de usu\xe1rio e senha."),(0,n.kt)("p",{parentName:"li"},(0,n.kt)("img",{alt:"managedAcc",src:t(15943).Z,width:"1694",height:"238"}))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Volte para a p\xe1gina ",(0,n.kt)("strong",{parentName:"p"},"Fun\xe7\xf5es")," e clique em ",(0,n.kt)("strong",{parentName:"p"},"Editar")," na linha ",(0,n.kt)("strong",{parentName:"p"},"nginx-casdoor-role"),". Na p\xe1gina que se abre, no campo ",(0,n.kt)("strong",{parentName:"p"},"Sub usu\xe1rios"),", selecione o nome de usu\xe1rio que voc\xea acabou de criar (aqui \xe9 built-in/user1)."),(0,n.kt)("p",{parentName:"li"},(0,n.kt)("img",{alt:"subUsers",src:t(95856).Z,width:"528",height:"106"})))),(0,n.kt)("h2",{id:"configurando-o-nginx-plus"},"Configurando o NGINX Plus"),(0,n.kt)("p",null,"Para configurar o NGINX Plus como a parte confiante do OpenID Connect, siga estes passos:"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Comece criando um clone do reposit\xf3rio GitHub ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/nginxinc/nginx-openid-connect"},"nginx-openid-connect"),":"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"git clone https://github.com/nginxinc/nginx-openid-connect\n"))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Copie os seguintes arquivos do clone para o diret\xf3rio ",(0,n.kt)("strong",{parentName:"p"},"/etc/nginx/conf.d"),":"),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"frontend.conf")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"openid_connect.js")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"openid_connect.server_conf")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"openid_connect_configuration.conf")))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Recupere as URLs para o ponto final de autoriza\xe7\xe3o, ponto final de token e arquivo JSON Web Key (JWK) da configura\xe7\xe3o do Casdoor. Abra um terminal e execute o seguinte comando ",(0,n.kt)("inlineCode",{parentName:"p"},"curl"),", canalizando a sa\xedda para o comando ",(0,n.kt)("inlineCode",{parentName:"p"},"python")," indicado para gerar um formato de configura\xe7\xe3o leg\xedvel. Por brevidade, truncamos a sa\xedda para exibir apenas os campos relevantes. ",(0,n.kt)("span",{id:"jump1"})),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-bash"},'curl http://<casdoor-server-address>/.well-known/openid-configuration | python -m json.tool\n{\n    "authorization_endpoint": "https://<casdoor-server-address>/login/oauth/authorize",\n    "...":"...",\n    "token_endpoint": "http://<casdoor-server-address>/api/login/oauth/access_token",\n    "...":"...",\n    "jwks_uri": "http://<casdoor-server-address>/.well-known/jwks",\n    "...":"...",\n}\n'))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Abra ",(0,n.kt)("strong",{parentName:"p"},"/etc/nginx/conf.d/openid_connect_configuration.conf"),' usando o editor de texto de sua prefer\xeancia. Modifique o valor do par\xe2metro "default" para cada uma das seguintes diretivas ',(0,n.kt)("a",{parentName:"p",href:"https://nginx.org/en/docs/http/ngx_http_map_module.html#map"},"map")," com os valores especificados:",(0,n.kt)("span",{id:"jump2"})),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"map $host $oidc_authz_endpoint")," \u2013 Use o valor do ",(0,n.kt)("inlineCode",{parentName:"li"},"authorization_endpoint")," de ",(0,n.kt)("a",{parentName:"li",href:"#jump1"},"Etapa 3")," (neste guia, ",(0,n.kt)("inlineCode",{parentName:"li"},"https://<casdoor-server-address>/login/oauth/authorize"),")"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"map $host $oidc_token_endpoint")," \u2013 Use o valor do ",(0,n.kt)("inlineCode",{parentName:"li"},"token_endpoint")," de ",(0,n.kt)("a",{parentName:"li",href:"#jump1"},"Etapa 3")," (neste guia, ",(0,n.kt)("inlineCode",{parentName:"li"},"http://<casdoor-server-address>/api/login/oauth/access_token"),")"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"map $host $oidc_client")," \u2013 Use o valor no campo ",(0,n.kt)("strong",{parentName:"li"},"Client ID")," de ",(0,n.kt)("a",{parentName:"li",href:"#jump3"},"Etapa 4 de ",(0,n.kt)("em",{parentName:"a"},"Configurando o Casdoor"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"map $host $oidc_client_secret")," \u2013 Use o valor no campo ",(0,n.kt)("strong",{parentName:"li"},"Client Secret")," de ",(0,n.kt)("a",{parentName:"li",href:"#jump3"},"Etapa 2 de ",(0,n.kt)("em",{parentName:"a"},"Configurando o Casdoor"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"map $host $oidc_hmac_key")," \u2013 Use uma frase \xfanica, longa e segura"))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Configure o arquivo JWK com base na vers\xe3o do NGINX Plus em uso:"),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"No NGINX Plus R17 e posteriores, o NGINX Plus pode ler diretamente o arquivo JWK da URL especificada como ",(0,n.kt)("inlineCode",{parentName:"li"},"jwks_uri")," em ",(0,n.kt)("a",{parentName:"li",href:"#jump2"},"Etapa 3"),". Fa\xe7a as seguintes altera\xe7\xf5es em ",(0,n.kt)("strong",{parentName:"li"},"/etc/nginx/conf.d/frontend.conf"),":",(0,n.kt)("ol",{parentName:"li"},(0,n.kt)("li",{parentName:"ol"},"Comente (ou remova) a diretiva ",(0,n.kt)("a",{parentName:"li",href:"http://nginx.org/en/docs/http/ngx_http_auth_jwt_module.html#auth_jwt_key_file"},"auth_jwt_key_file"),"."),(0,n.kt)("li",{parentName:"ol"},"Descomente a diretiva ",(0,n.kt)("a",{parentName:"li",href:"http://nginx.org/en/docs/http/ngx_http_auth_jwt_module.html#auth_jwt_key_request"},"auth_jwt_key_request"),". (O par\xe2metro ",(0,n.kt)("inlineCode",{parentName:"li"},"/_jwks_uri")," refere-se ao valor da vari\xe1vel ",(0,n.kt)("inlineCode",{parentName:"li"},"$oidc_jwt_keyfile"),", que ser\xe1 definido na pr\xf3xima etapa.)"),(0,n.kt)("li",{parentName:"ol"},'Atualize o par\xe2metro "default" da diretiva ',(0,n.kt)("inlineCode",{parentName:"li"},"map $host $oidc_jwt_keyfile")," para o valor obtido do campo ",(0,n.kt)("inlineCode",{parentName:"li"},"jwks_uri")," em ",(0,n.kt)("a",{parentName:"li",href:"#jump2"},"Etapa 3")," (neste guia, ",(0,n.kt)("inlineCode",{parentName:"li"},"http://<casdoor-server-address>/.well-known/jwks"),")."))),(0,n.kt)("li",{parentName:"ul"},"No NGINX Plus R16 e anteriores, ou se preferir, o arquivo JWK deve estar localizado no disco local. Siga estes passos:",(0,n.kt)("ol",{parentName:"li"},(0,n.kt)("li",{parentName:"ol"},"Copie o conte\xfado JSON do arquivo JWK especificado no campo ",(0,n.kt)("inlineCode",{parentName:"li"},"jwks_uri")," em ",(0,n.kt)("a",{parentName:"li",href:"#jump2"},"Etapa 3")," (neste guia, ",(0,n.kt)("inlineCode",{parentName:"li"},"http://<casdoor-server-address>/.well-known/jwks"),") para um arquivo local (por exemplo, ",(0,n.kt)("inlineCode",{parentName:"li"},"/etc/nginx/my_casdoor_jwk.json"),")."),(0,n.kt)("li",{parentName:"ol"},"Em ",(0,n.kt)("strong",{parentName:"li"},"/etc/nginx/conf.d/openid_connect_configuration.conf"),', altere o par\xe2metro "default" da diretiva ',(0,n.kt)("inlineCode",{parentName:"li"},"map $host $oidc_jwt_keyfile")," para o caminho do arquivo local."))))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Certifique-se de que o usu\xe1rio especificado na diretiva ",(0,n.kt)("a",{parentName:"p",href:"http://nginx.org/en/docs/ngx_core_module.html#user"},"user")," dentro do arquivo de configura\xe7\xe3o do NGINX Plus (geralmente ",(0,n.kt)("strong",{parentName:"p"},"/etc/nginx/nginx.conf"),") tenha permiss\xf5es de leitura para o arquivo JWK."))),(0,n.kt)("h2",{id:"testando"},"Testando"),(0,n.kt)("p",null,"Abra um navegador e insira o endere\xe7o da sua inst\xe2ncia NGINX Plus. Em seguida, tente fazer login usando as credenciais de um usu\xe1rio que foi atribu\xeddo \xe0 fun\xe7\xe3o NGINX Plus."),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"teste",src:t(68185).Z,width:"734",height:"710"})),(0,n.kt)("h2",{id:"solu\xe7\xe3o-de-problemas"},"Solu\xe7\xe3o de problemas"),(0,n.kt)("p",null,"Por favor, consulte a se\xe7\xe3o ",(0,n.kt)("strong",{parentName:"p"},(0,n.kt)("a",{parentName:"strong",href:"https://github.com/nginxinc/nginx-openid-connect#troubleshooting"},"Solu\xe7\xe3o de Problemas"))," no reposit\xf3rio ",(0,n.kt)("strong",{parentName:"p"},"nginx-openid-connect")," no GitHub."))}m.isMDXComponent=!0},19598:(e,a,t)=>{t.d(a,{Z:()=>o});const o=t.p+"assets/images/Client-a96b885b28b974e3594d8cc621e20d26.png"},38655:(e,a,t)=>{t.d(a,{Z:()=>o});const o=t.p+"assets/images/addApp-f0c3c3804e0f0c7c46099a967b140011.png"},80816:(e,a,t)=>{t.d(a,{Z:()=>o});const o=t.p+"assets/images/addRole-0472f1742fb90683f03e7754f6b443c9.png"},82431:(e,a,t)=>{t.d(a,{Z:()=>o});const o=t.p+"assets/images/appName-e76303a2d8f848e2cb82e8244580be67.png"},15943:(e,a,t)=>{t.d(a,{Z:()=>o});const o=t.p+"assets/images/managedAcc-2c79bf01d04970685e1db9e8800ab613.png"},4124:(e,a,t)=>{t.d(a,{Z:()=>o});const o=t.p+"assets/images/redirectURL-94f6fbadde9bd1dce2447f42ab5cd556.png"},88165:(e,a,t)=>{t.d(a,{Z:()=>o});const o=t.p+"assets/images/roleName-e4bb131db4aa1457aec6894f674c54c5.png"},30614:(e,a,t)=>{t.d(a,{Z:()=>o});const o=t.p+"assets/images/signupApp-f3444949e6ce9f7becbda49f59490a7f.png"},95856:(e,a,t)=>{t.d(a,{Z:()=>o});const o=t.p+"assets/images/subUsers-c5bcd4229c84f7b62e169783e8418a1a.png"},68185:(e,a,t)=>{t.d(a,{Z:()=>o});const o=t.p+"assets/images/test-61892faf0c0e4fbe4c43b277c0eab745.png"},17830:(e,a,t)=>{t.d(a,{Z:()=>o});const o=t.p+"assets/images/userName-0244eca3ebd618b68ad03ae9cda14dee.png"}}]);