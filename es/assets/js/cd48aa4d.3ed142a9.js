"use strict";(self.webpackChunkcasdoor_website=self.webpackChunkcasdoor_website||[]).push([[1e3],{3905:(e,t,n)=>{n.d(t,{Zo:()=>s,kt:()=>m});var a=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=a.createContext({}),d=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):c(c({},t),e)),n},s=function(e){var t=d(e.components);return a.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,l=e.parentName,s=i(e,["components","mdxType","originalType","parentName"]),u=d(n),m=o,g=u["".concat(l,".").concat(m)]||u[m]||p[m]||r;return n?a.createElement(g,c(c({ref:t},s),{},{components:n})):a.createElement(g,c({ref:t},s))}));function m(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,c=new Array(r);c[0]=u;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i.mdxType="string"==typeof e?e:o,c[1]=i;for(var d=2;d<r;d++)c[d]=n[d];return a.createElement.apply(null,c)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},96259:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>c,default:()=>p,frontMatter:()=>r,metadata:()=>i,toc:()=>d});var a=n(87462),o=(n(67294),n(3905));const r={title:"Tencent Cloud",description:"Usando Casdoor como un SAML IdP",keywords:["SAML","IdP"],authors:["Songjf-ttk"]},c=void 0,i={unversionedId:"how-to-connect/saml/tencent-cloud",id:"how-to-connect/saml/tencent-cloud",title:"Tencent Cloud",description:"Usando Casdoor como un SAML IdP",source:"@site/i18n/es/docusaurus-plugin-content-docs/current/how-to-connect/saml/tencent-cloud.md",sourceDirName:"how-to-connect/saml",slug:"/how-to-connect/saml/tencent-cloud",permalink:"/es/docs/how-to-connect/saml/tencent-cloud",draft:!1,editUrl:"https://github.com/casdoor/casdoor-website/edit/master/docs/how-to-connect/saml/tencent-cloud.md",tags:[],version:"current",frontMatter:{title:"Tencent Cloud",description:"Usando Casdoor como un SAML IdP",keywords:["SAML","IdP"],authors:["Songjf-ttk"]},sidebar:"tutorialSidebar",previous:{title:"Appgate (POST)",permalink:"/es/docs/how-to-connect/saml/appgate"},next:{title:"Face ID",permalink:"/es/docs/how-to-connect/face-id"}},l={},d=[{value:"Casdoor como un SAML IdP en Tencent Cloud",id:"casdoor-como-un-saml-idp-en-tencent-cloud",level:2},{value:"Copiar Saml MetaData",id:"copiar-saml-metadata",level:3},{value:"A\xf1adiendo SAML IdP en Tencent Cloud",id:"a\xf1adiendo-saml-idp-en-tencent-cloud",level:3},{value:"Configurando la aplicaci\xf3n SAML en Casdoor",id:"configurando-la-aplicaci\xf3n-saml-en-casdoor",level:3},{value:"Iniciar sesi\xf3n usando Casdoor SAML",id:"iniciar-sesi\xf3n-usando-casdoor-saml",level:3}],s={toc:d};function p(e){let{components:t,...r}=e;return(0,o.kt)("wrapper",(0,a.Z)({},s,r,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"casdoor-como-un-saml-idp-en-tencent-cloud"},"Casdoor como un SAML IdP en Tencent Cloud"),(0,o.kt)("p",null,"Esta gu\xeda te mostrar\xe1 c\xf3mo configurar Casdoor y Tencent Cloud para a\xf1adir Casdoor como un SAML IdP en Tencent Cloud."),(0,o.kt)("h3",{id:"copiar-saml-metadata"},"Copiar Saml MetaData"),(0,o.kt)("p",null,"En Casdoor, a\xf1ade un certificado de tipo X.509 con algoritmo criptogr\xe1fico RSA."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"A\xf1adir cert",src:n(83897).Z,width:"1694",height:"761"})),(0,o.kt)("p",null,"Luego copia el SamlMetadata en Casdoor."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Copiar metadatos Saml",src:n(92081).Z,width:"1870",height:"554"})),(0,o.kt)("h3",{id:"a\xf1adiendo-saml-idp-en-tencent-cloud"},"A\xf1adiendo SAML IdP en Tencent Cloud"),(0,o.kt)("p",null,"Inicia sesi\xf3n en Tencent Cloud y entra en la interfaz de gesti\xf3n de acceso."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Login Access Management",src:n(76072).Z,width:"1902",height:"831"})),(0,o.kt)("p",null,"Crea un nuevo ",(0,o.kt)("strong",{parentName:"p"},"Identity Providers")," y sube los ",(0,o.kt)("strong",{parentName:"p"},"metadatos saml")," previamente copiados a Tencent Cloud."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Saml idp create",src:n(89494).Z,width:"1898",height:"794"})),(0,o.kt)("p",null,"Luego crea un nuevo ",(0,o.kt)("strong",{parentName:"p"},"ROLE")," y selecciona los ",(0,o.kt)("strong",{parentName:"p"},"Identity Providers")," previos como proveedor idp."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Saml role create",src:n(49532).Z,width:"1915",height:"859"})),(0,o.kt)("h3",{id:"configurando-la-aplicaci\xf3n-saml-en-casdoor"},"Configurando la aplicaci\xf3n SAML en Casdoor"),(0,o.kt)("p",null,"En la p\xe1gina de edici\xf3n de la aplicaci\xf3n, selecciona el certificado que acabas de crear. A\xf1ade el nombre de dominio de la aplicaci\xf3n Tencent Cloud que usar\xe1s en los ",(0,o.kt)("strong",{parentName:"p"},"Redirect URLs"),"."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Select cert and add redirect URLs",src:n(23358).Z,width:"1854",height:"481"})),(0,o.kt)("p",null,"En la p\xe1gina de edici\xf3n de la aplicaci\xf3n, introduce la ",(0,o.kt)("strong",{parentName:"p"},"ACS URL")," y configura el ",(0,o.kt)("strong",{parentName:"p"},"Saml Attribute"),"."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Add acs url and configure saml attribute",src:n(28842).Z,width:"1899",height:"529"})),(0,o.kt)("p",null,"La informaci\xf3n de configuraci\xf3n para Saml Attribute es la siguiente:"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:"left"},"Name"),(0,o.kt)("th",{parentName:"tr",align:"left"},"Name Format"),(0,o.kt)("th",{parentName:"tr",align:"left"},"Value"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},(0,o.kt)("inlineCode",{parentName:"td"},"https://cloud.tencent.com/SAML/Attributes/Role")),(0,o.kt)("td",{parentName:"tr",align:"left"},"Unspecified"),(0,o.kt)("td",{parentName:"tr",align:"left"},"qcs::cam::uin/{AccountID}:roleName/{RoleName1};qcs::cam::uin/{AccountID}:roleName/{RoleName2},qcs::cam::uin/{AccountID}:saml-provider/{ProviderName}")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},(0,o.kt)("inlineCode",{parentName:"td"},"https://cloud.tencent.com/SAML/Attributes/RoleSessionName")),(0,o.kt)("td",{parentName:"tr",align:"left"},"Unspecified"),(0,o.kt)("td",{parentName:"tr",align:"left"},"casdoor")))),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("ul",{parentName:"admonition"},(0,o.kt)("li",{parentName:"ul"},"En el atributo fuente de Role, reemplaza {AccountID}, {RoleName} y {ProviderName} con el siguiente contenido:"),(0,o.kt)("li",{parentName:"ul"},"Reemplaza {AccountID} con tu ID de cuenta de Tencent Cloud, que se puede ver en la ",(0,o.kt)("a",{parentName:"li",href:"https://console.cloud.tencent.com/developer"},"Account Information - Console"),"."),(0,o.kt)("li",{parentName:"ul"},"Reemplaza {RoleName} con el nombre del rol que creaste en Tencent Cloud, que se puede ver en la ",(0,o.kt)("a",{parentName:"li",href:"https://console.cloud.tencent.com/cam/role"},"Roles - Console"),"."),(0,o.kt)("li",{parentName:"ul"},"Reemplaza {ProviderName} con el nombre del proveedor de identidad SAML que creaste en Tencent Cloud, que se puede ver en la ",(0,o.kt)("a",{parentName:"li",href:"https://console.cloud.tencent.com/cam/idp"},"Identity Providers - Console"),".")),(0,o.kt)("p",{parentName:"admonition"},"Puedes visitar la ",(0,o.kt)("a",{parentName:"p",href:"https://cloud.tencent.com/document/product/598/38058"},"documentaci\xf3n")," de Proveedores de Identidad SAML de Tencent Cloud para obtener m\xe1s informaci\xf3n detallada.")),(0,o.kt)("h3",{id:"iniciar-sesi\xf3n-usando-casdoor-saml"},"Iniciar sesi\xf3n usando Casdoor SAML"),(0,o.kt)("p",null,"Los pasos generales de inicio de sesi\xf3n para SAML son los siguientes: Usuario -> Tencent Cloud (no logueado) -> Redirigir a Casdoor para iniciar sesi\xf3n -> Tencent Cloud (logueado). Ahora, usa c\xf3digo externamente para simular los primeros dos pasos y generar una URL que redirige a Casdoor. C\xf3digo de ejemplo:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-go"},'func main() {\n    res, err := http.Get("your casdoor application saml metadata url")\n    if err != nil {\n        panic(err)\n    }\n\n    rawMetadata, err := ioutil.ReadAll(res.Body)\n    if err != nil {\n        panic(err)\n    }\n\n    metadata := &types.EntityDescriptor{}\n    err = xml.Unmarshal(rawMetadata, metadata)\n    if err != nil {\n        panic(err)\n    }\n\n    certStore := dsig.MemoryX509CertificateStore{\n        Roots: []*x509.Certificate{},\n    }\n\n    for _, kd := range metadata.IDPSSODescriptor.KeyDescriptors {\n        for idx, xcert := range kd.KeyInfo.X509Data.X509Certificates {\n            if xcert.Data == "" {\n                panic(fmt.Errorf("metadata certificate(%d) must not be empty", idx))\n            }\n            certData, err := base64.StdEncoding.DecodeString(xcert.Data)\n            if err != nil {\n                panic(err)\n            }\n\n            idpCert, err := x509.ParseCertificate(certData)\n            if err != nil {\n                panic(err)\n            }\n\n            certStore.Roots = append(certStore.Roots, idpCert)\n        }\n    }\n\n    randomKeyStore := dsig.RandomKeyStoreForTest()\n\n    sp := &saml2.SAMLServiceProvider{\n        IdentityProviderSSOURL:      metadata.IDPSSODescriptor.SingleSignOnServices[0].Location,\n        IdentityProviderIssuer:      metadata.EntityID,\n        ServiceProviderIssuer:       "https://cloud.tencent.com",\n        AssertionConsumerServiceURL: "https://cloud.tencent.com/login/saml",\n        SignAuthnRequests:           true,\n        AudienceURI:                 "https://cloud.tencent.com",\n        IDPCertificateStore:         &certStore,\n        SPKeyStore:                  randomKeyStore,\n    }\n\n    println("Visit this URL To Authenticate:")\n    authURL, err := sp.BuildAuthURL("")\n    if err != nil {\n        panic(err)\n    }\n\n    println(authURL)\n}\n')),(0,o.kt)("p",null,"Una vez que ejecutamos el c\xf3digo y obtenemos la ",(0,o.kt)("strong",{parentName:"p"},"auth URL"),", hacer clic en la URL nos permitir\xe1 probar el inicio de sesi\xf3n. proporcionamos una demo de este proceso."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Resultado final",src:n(60773).Z,width:"714",height:"376"})))}p.isMDXComponent=!0},76072:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/saml_tencent-cloud_access_management-becdf44c901f8a05ed373c5a3f831d70.png"},28842:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/saml_tencent-cloud_acs-dee4b189520cfcddeadb3d31fe35e1e1.png"},23358:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/saml_tencent-cloud_app-798995784063235b950b4a410fe4b59c.png"},83897:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/saml_tencent-cloud_cert-acc61a90add8be443c7feff4b5cd6df2.png"},49532:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/saml_tencent-cloud_create_role-1feda08ae98b7add35efcc72e2ae09ae.png"},89494:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/saml_tencent-cloud_idp_create-9aae768d6ca5cf3ceba0505d97151411.png"},60773:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/saml_tencent-cloud_login_test-fdd9d104d5df76a161a29208136134d4.gif"},92081:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/saml_tencent-cloud_metadata-391b8decc7d48c2850d565ea0d1f24e7.png"}}]);