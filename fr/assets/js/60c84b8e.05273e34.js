"use strict";(self.webpackChunkcasdoor_website=self.webpackChunkcasdoor_website||[]).push([[2856],{3905:(e,n,t)=>{t.d(n,{Zo:()=>c,kt:()=>m});var a=t(67294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var s=a.createContext({}),p=function(e){var n=a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},c=function(e){var n=p(e.components);return a.createElement(s.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},d=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),d=p(t),m=r,h=d["".concat(s,".").concat(m)]||d[m]||u[m]||i;return t?a.createElement(h,o(o({ref:n},c),{},{components:t})):a.createElement(h,o({ref:n},c))}));function m(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var i=t.length,o=new Array(i);o[0]=d;var l={};for(var s in n)hasOwnProperty.call(n,s)&&(l[s]=n[s]);l.originalType=e,l.mdxType="string"==typeof e?e:r,o[1]=l;for(var p=2;p<i;p++)o[p]=t[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,t)}d.displayName="MDXCreateElement"},70084:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>o,default:()=>u,frontMatter:()=>i,metadata:()=>l,toc:()=>p});var a=t(87462),r=(t(67294),t(3905));const i={title:"APIs Casbin expos\xe9es",description:"Utilisation des APIs Casbin expos\xe9es pour g\xe9rer les droits d'acc\xe8s des utilisateurs dans les organisations",keywords:["permissions","Casbin"],authors:["MagicalSheep"]},o=void 0,l={unversionedId:"permission/exposed-casbin-apis",id:"permission/exposed-casbin-apis",title:"APIs Casbin expos\xe9es",description:"Utilisation des APIs Casbin expos\xe9es pour g\xe9rer les droits d'acc\xe8s des utilisateurs dans les organisations",source:"@site/i18n/fr/docusaurus-plugin-content-docs/current/permission/exposed-casbin-apis.md",sourceDirName:"permission",slug:"/permission/exposed-casbin-apis",permalink:"/fr/docs/permission/exposed-casbin-apis",draft:!1,editUrl:"https://github.com/casdoor/casdoor-website/edit/master/docs/permission/exposed-casbin-apis.md",tags:[],version:"current",frontMatter:{title:"APIs Casbin expos\xe9es",description:"Utilisation des APIs Casbin expos\xe9es pour g\xe9rer les droits d'acc\xe8s des utilisateurs dans les organisations",keywords:["permissions","Casbin"],authors:["MagicalSheep"]},sidebar:"tutorialSidebar",previous:{title:"Configuration des permissions",permalink:"/fr/docs/permission/permission-configuration"},next:{title:"Adaptateur",permalink:"/fr/docs/permission/adapter"}},s={},p=[{value:"Introduction",id:"introduction",level:2},{value:"Enforcer",id:"enforcer",level:3},{value:"BatchEnforce",id:"batchenforce",level:3},{value:"GetAllObjects",id:"getallobjects",level:3},{value:"GetAllActions",id:"getallactions",level:3},{value:"GetAllRoles",id:"getallroles",level:3},{value:"RunCasbinCommand",id:"runcasbincommand",level:3}],c={toc:p};function u(e){let{components:n,...t}=e;return(0,r.kt)("wrapper",(0,a.Z)({},c,t,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"introduction"},"Introduction"),(0,r.kt)("p",null,"Supposons que le front-end de votre application a obtenu le ",(0,r.kt)("inlineCode",{parentName:"p"},"access_token")," de l'utilisateur connect\xe9 et souhaite maintenant authentifier l'utilisateur pour certains acc\xe8s. Vous ne pouvez pas simplement placer le ",(0,r.kt)("inlineCode",{parentName:"p"},"access_token")," dans l'en-t\xeate de la requ\xeate HTTP pour utiliser ces APIs car Casdoor utilise le champ ",(0,r.kt)("inlineCode",{parentName:"p"},"Authorization")," pour v\xe9rifier la permission d'acc\xe8s. Comme toutes les autres APIs fournies par Casdoor, le champ ",(0,r.kt)("inlineCode",{parentName:"p"},"Authorization")," se compose de l'identifiant client de l'application et du secret, en utilisant le ",(0,r.kt)("a",{parentName:"p",href:"https://datatracker.ietf.org/doc/html/rfc7617"},"sch\xe9ma d'authentification HTTP de base"),". \xc7a ressemble \xe0 ",(0,r.kt)("inlineCode",{parentName:"p"},"Authorization: Basic <Votre_Application_ClientId> <Votre_Application_ClientSecret>"),". Pour cette raison, les APIs Casbin doivent \xeatre appel\xe9es par le serveur backend de l'application. Voici les \xe9tapes \xe0 suivre."),(0,r.kt)("p",null,"Prenez l'application ",(0,r.kt)("a",{parentName:"p",href:"https://door.casdoor.com/applications/casbin/app-vue-python-example"},"app-vue-python-example")," sur le site de d\xe9monstration par exemple, l'en-t\xeate d'autorisation devrait \xeatre : ",(0,r.kt)("inlineCode",{parentName:"p"},"Authorization: Basic 294b09fbc17f95daf2fe dd8982f7046ccba1bbd7851d5c1ece4e52bf039d"),"."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Le front-end transmet le ",(0,r.kt)("inlineCode",{parentName:"li"},"access_token")," au serveur backend via l'en-t\xeate de la requ\xeate HTTP."),(0,r.kt)("li",{parentName:"ol"},"Le serveur backend r\xe9cup\xe8re l'identifiant de l'utilisateur \xe0 partir du ",(0,r.kt)("inlineCode",{parentName:"li"},"access_token"),".")),(0,r.kt)("p",null,"Comme note pr\xe9alable, ces interfaces sont \xe9galement con\xe7ues (pour l'instant) pour le mod\xe8le ",(0,r.kt)("inlineCode",{parentName:"p"},"(sub, obj, act)"),". Le corps est le format de requ\xeate d\xe9fini par le mod\xe8le Casbin de la permission, repr\xe9sentant g\xe9n\xe9ralement ",(0,r.kt)("inlineCode",{parentName:"p"},"sub"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"obj")," et ",(0,r.kt)("inlineCode",{parentName:"p"},"act")," respectivement."),(0,r.kt)("p",null,"En plus de l'interface API pour demander l'application du contr\xf4le des permissions, Casdoor fournit \xe9galement d'autres interfaces qui aident les applications externes \xe0 obtenir des informations sur la politique de permission, qui sont \xe9galement list\xe9es ici."),(0,r.kt)("h3",{id:"enforcer"},"Enforcer"),(0,r.kt)("p",null,"The Enforce API supports multiple query parameters to specify which permission(s) to enforce against. ",(0,r.kt)("strong",{parentName:"p"},"Only one parameter should be provided at a time"),":"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"permissionId"),": The identity of a specific permission policy (format: ",(0,r.kt)("inlineCode",{parentName:"li"},"organization name/permission name"),")"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"modelId"),": The identity of a permission model (format: ",(0,r.kt)("inlineCode",{parentName:"li"},"organization name/model name"),") - enforces against all permissions using this model"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"resourceId"),": The identity of a resource - enforces against all permissions for this resource"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"enforcerId"),": The identity of a specific enforcer"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"owner"),": The organization name - enforces against all permissions in this organization")),(0,r.kt)("p",null,"Request using ",(0,r.kt)("inlineCode",{parentName:"p"},"permissionId"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"curl --location --request POST 'http://localhost:8000/api/enforce?permissionId=example-org/example-permission' \\\n--header 'Content-Type: application/json' \\\n--header 'Authorization: Basic <Your_Application_ClientId> <Your_Application_ClientSecret>' \\\n--data-raw '[\"example-org/example-user\", \"example-resource\", \"example-action\"]'\n")),(0,r.kt)("p",null,"Request using ",(0,r.kt)("inlineCode",{parentName:"p"},"modelId"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"curl --location --request POST 'http://localhost:8000/api/enforce?modelId=example-org/example-model' \\\n--header 'Content-Type: application/json' \\\n--header 'Authorization: Basic <Your_Application_ClientId> <Your_Application_ClientSecret>' \\\n--data-raw '[\"example-org/example-user\", \"example-resource\", \"example-action\"]'\n")),(0,r.kt)("p",null,"Request using ",(0,r.kt)("inlineCode",{parentName:"p"},"resourceId"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"curl --location --request POST 'http://localhost:8000/api/enforce?resourceId=example-org/example-resource' \\\n--header 'Content-Type: application/json' \\\n--header 'Authorization: Basic <Your_Application_ClientId> <Your_Application_ClientSecret>' \\\n--data-raw '[\"example-org/example-user\", \"example-resource\", \"example-action\"]'\n")),(0,r.kt)("p",null,"Response:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "status": "ok",\n    "msg": "",\n    "sub": "",\n    "name": "",\n    "data": [\n        true\n    ],\n    "data2": [\n        "example-org/example-model/example-adapter"\n    ]\n}\n')),(0,r.kt)("p",null,"Note: When using ",(0,r.kt)("inlineCode",{parentName:"p"},"modelId"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"resourceId"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"enforcerId"),", or ",(0,r.kt)("inlineCode",{parentName:"p"},"owner")," parameters, the response ",(0,r.kt)("inlineCode",{parentName:"p"},"data")," array may contain multiple boolean values (one for each permission that was checked), and ",(0,r.kt)("inlineCode",{parentName:"p"},"data2")," contains the corresponding model and adapter identifiers."),(0,r.kt)("h3",{id:"batchenforce"},"BatchEnforce"),(0,r.kt)("p",null,"The BatchEnforce API supports multiple query parameters to specify which permission(s) to enforce against. ",(0,r.kt)("strong",{parentName:"p"},"Only one parameter should be provided at a time"),":"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"permissionId"),": The identity of a specific permission policy (format: ",(0,r.kt)("inlineCode",{parentName:"li"},"organization name/permission name"),")"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"modelId"),": The identity of a permission model (format: ",(0,r.kt)("inlineCode",{parentName:"li"},"organization name/model name"),") - enforces against all permissions using this model"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"enforcerId"),": The identity of a specific enforcer"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"owner"),": The organization name - enforces against all permissions in this organization")),(0,r.kt)("p",null,"Request using ",(0,r.kt)("inlineCode",{parentName:"p"},"permissionId"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'curl --location --request POST \'http://localhost:8000/api/batch-enforce?permissionId=example-org/example-permission\' \\\n--header \'Content-Type: application/json\' \\\n--header \'Authorization: Basic <Your_Application_ClientId> <Your_Application_ClientSecret>\' \\\n--data-raw \'[["example-org/example-user", "example-resource", "example-action"], ["example-org/example-user2", "example-resource", "example-action"], ["example-org/example-user3", "example-resource", "example-action"]]\'\n')),(0,r.kt)("p",null,"Request using ",(0,r.kt)("inlineCode",{parentName:"p"},"modelId"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'curl --location --request POST \'http://localhost:8000/api/batch-enforce?modelId=example-org/example-model\' \\\n--header \'Content-Type: application/json\' \\\n--header \'Authorization: Basic <Your_Application_ClientId> <Your_Application_ClientSecret>\' \\\n--data-raw \'[["example-org/example-user", "example-resource", "example-action"], ["example-org/example-user2", "example-resource", "example-action"]]\'\n')),(0,r.kt)("p",null,"R\xe9ponse :"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "status": "ok",\n    "msg": "",\n    "sub": "",\n    "name": "",\n    "data": [\n        [\n            true,\n            true,\n            false\n        ]\n    ],\n    "data2": [\n        "example-org/example-model/example-adapter"\n    ]\n}\n')),(0,r.kt)("p",null,"Note: When using ",(0,r.kt)("inlineCode",{parentName:"p"},"modelId"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"enforcerId"),", or ",(0,r.kt)("inlineCode",{parentName:"p"},"owner")," parameters, the response ",(0,r.kt)("inlineCode",{parentName:"p"},"data")," array may contain multiple arrays of boolean values (one array for each permission that was checked), and ",(0,r.kt)("inlineCode",{parentName:"p"},"data2")," contains the corresponding model and adapter identifiers."),(0,r.kt)("h3",{id:"getallobjects"},"GetAllObjects"),(0,r.kt)("p",null,"This API retrieves all objects (resources) that a user has access to. It accepts an optional ",(0,r.kt)("inlineCode",{parentName:"p"},"userId")," parameter. If not provided, it uses the logged-in user's session."),(0,r.kt)("p",null,"Request with ",(0,r.kt)("inlineCode",{parentName:"p"},"userId")," parameter:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"curl --location --request GET 'http://localhost:8000/api/get-all-objects?userId=example-org/example-user' \\\n--header 'Authorization: Basic <Your_Application_ClientId> <Your_Application_ClientSecret>'\n")),(0,r.kt)("p",null,"Request using session (userId determined from session):"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"curl --location --request GET 'http://localhost:8000/api/get-all-objects' \\\n--header 'Authorization: Basic <Your_Application_ClientId> <Your_Application_ClientSecret>'\n")),(0,r.kt)("p",null,"R\xe9ponse :"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "status": "ok",\n    "msg": "",\n    "data": [\n        "app-built-in",\n        "example-resource"\n    ]\n}\n')),(0,r.kt)("h3",{id:"getallactions"},"GetAllActions"),(0,r.kt)("p",null,"This API retrieves all actions that a user can perform. It accepts an optional ",(0,r.kt)("inlineCode",{parentName:"p"},"userId")," parameter. If not provided, it uses the logged-in user's session."),(0,r.kt)("p",null,"Request with ",(0,r.kt)("inlineCode",{parentName:"p"},"userId")," parameter:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"curl --location --request GET 'http://localhost:8000/api/get-all-actions?userId=example-org/example-user' \\\n--header 'Authorization: Basic <Your_Application_ClientId> <Your_Application_ClientSecret>'\n")),(0,r.kt)("p",null,"Request using session (userId determined from session):"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"curl --location --request GET 'http://localhost:8000/api/get-all-actions' \\\n--header 'Authorization: Basic <Your_Application_ClientId> <Your_Application_ClientSecret>'\n")),(0,r.kt)("p",null,"R\xe9ponse :"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "status": "ok",\n    "msg": "",\n    "data": [\n        "read",\n        "write",\n        "admin"\n    ]\n}\n')),(0,r.kt)("h3",{id:"getallroles"},"GetAllRoles"),(0,r.kt)("p",null,"This API retrieves all roles assigned to a user. It accepts an optional ",(0,r.kt)("inlineCode",{parentName:"p"},"userId")," parameter. If not provided, it uses the logged-in user's session."),(0,r.kt)("p",null,"Request with ",(0,r.kt)("inlineCode",{parentName:"p"},"userId")," parameter:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"curl --location --request GET 'http://localhost:8000/api/get-all-roles?userId=example-org/example-user' \\\n--header 'Authorization: Basic <Your_Application_ClientId> <Your_Application_ClientSecret>'\n")),(0,r.kt)("p",null,"Request using session (userId determined from session):"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"curl --location --request GET 'http://localhost:8000/api/get-all-roles' \\\n--header 'Authorization: Basic <Your_Application_ClientId> <Your_Application_ClientSecret>'\n")),(0,r.kt)("p",null,"R\xe9ponse :"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "status": "ok",\n    "msg": "",\n    "data": [\n        "role_kcx66l"\n    ]\n}\n')),(0,r.kt)("h3",{id:"runcasbincommand"},"RunCasbinCommand"),(0,r.kt)("p",null,"This API executes Casbin CLI commands and returns their output. It's designed for running language-specific Casbin command-line tools through Casdoor's backend, supporting languages like Java, Go, Node.js, Python, and others."),(0,r.kt)("p",null,"The API includes an in-memory cache that stores command results for 5 minutes. When the same command is executed with identical parameters, the cached result is returned immediately without re-executing the command, improving response times and reducing server load."),(0,r.kt)("p",null,"Request:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"curl --location --request GET 'http://localhost:8000/api/run-casbin-command?language=go&args=[\"-v\"]' \\\n--header 'Authorization: Basic <Your_Application_ClientId> <Your_Application_ClientSecret>'\n")),(0,r.kt)("p",null,"Parameters:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"language"),": The programming language for the Casbin CLI (e.g., ",(0,r.kt)("inlineCode",{parentName:"li"},"go"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"java"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"node"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"python"),")"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"args"),": A JSON-encoded array of command-line arguments (e.g., ",(0,r.kt)("inlineCode",{parentName:"li"},'["-v"]')," for version, ",(0,r.kt)("inlineCode",{parentName:"li"},'["new"]')," for creating new files). Note: URL-encode the JSON array when using it as a query parameter")),(0,r.kt)("p",null,"Response:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "status": "ok",\n    "msg": "",\n    "data": "casbin version 2.x.x"\n}\n')),(0,r.kt)("p",null,"The cache key is generated from the language and arguments, so different commands are cached independently. Expired entries are automatically cleaned up to prevent memory growth."))}u.isMDXComponent=!0}}]);