"use strict";(self.webpackChunkcasdoor_website=self.webpackChunkcasdoor_website||[]).push([[9660],{3905:(e,o,a)=>{a.d(o,{Zo:()=>p,kt:()=>u});var t=a(67294);function r(e,o,a){return o in e?Object.defineProperty(e,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[o]=a,e}function n(e,o){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);o&&(t=t.filter((function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable}))),a.push.apply(a,t)}return a}function s(e){for(var o=1;o<arguments.length;o++){var a=null!=arguments[o]?arguments[o]:{};o%2?n(Object(a),!0).forEach((function(o){r(e,o,a[o])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach((function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))}))}return e}function i(e,o){if(null==e)return{};var a,t,r=function(e,o){if(null==e)return{};var a,t,r={},n=Object.keys(e);for(t=0;t<n.length;t++)a=n[t],o.indexOf(a)>=0||(r[a]=e[a]);return r}(e,o);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(t=0;t<n.length;t++)a=n[t],o.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var c=t.createContext({}),d=function(e){var o=t.useContext(c),a=o;return e&&(a="function"==typeof e?e(o):s(s({},o),e)),a},p=function(e){var o=d(e.components);return t.createElement(c.Provider,{value:o},e.children)},l={inlineCode:"code",wrapper:function(e){var o=e.children;return t.createElement(t.Fragment,{},o)}},m=t.forwardRef((function(e,o){var a=e.components,r=e.mdxType,n=e.originalType,c=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),m=d(a),u=r,k=m["".concat(c,".").concat(u)]||m[u]||l[u]||n;return a?t.createElement(k,s(s({ref:o},p),{},{components:a})):t.createElement(k,s({ref:o},p))}));function u(e,o){var a=arguments,r=o&&o.mdxType;if("string"==typeof e||r){var n=a.length,s=new Array(n);s[0]=m;var i={};for(var c in o)hasOwnProperty.call(o,c)&&(i[c]=o[c]);i.originalType=e,i.mdxType="string"==typeof e?e:r,s[1]=i;for(var d=2;d<n;d++)s[d]=a[d];return t.createElement.apply(null,s)}return t.createElement.apply(null,a)}m.displayName="MDXCreateElement"},36250:(e,o,a)=>{a.r(o),a.d(o,{assets:()=>c,contentTitle:()=>s,default:()=>l,frontMatter:()=>n,metadata:()=>i,toc:()=>d});var t=a(87462),r=(a(67294),a(3905));const n={title:"API P\xfablica Casdoor",description:"API P\xfablica do Casdoor",keywords:["API P\xfablica do Casdoor"],authors:["hsluoyz"]},s=void 0,i={unversionedId:"basic/public-api",id:"basic/public-api",title:"API P\xfablica Casdoor",description:"API P\xfablica do Casdoor",source:"@site/i18n/pt/docusaurus-plugin-content-docs/current/basic/public-api.md",sourceDirName:"basic",slug:"/basic/public-api",permalink:"/pt/docs/basic/public-api",draft:!1,editUrl:"https://github.com/casdoor/casdoor-website/edit/master/docs/basic/public-api.md",tags:[],version:"current",frontMatter:{title:"API P\xfablica Casdoor",description:"API P\xfablica do Casdoor",keywords:["API P\xfablica do Casdoor"],authors:["hsluoyz"]},sidebar:"tutorialSidebar",previous:{title:"(Opcional) Experimente com K8s Helm",permalink:"/pt/docs/basic/try-with-helm"},next:{title:"Tutoriais",permalink:"/pt/docs/basic/tutorials"}},c={},d=[{value:"Como autenticar com a <code>Casdoor Public API</code>",id:"como-autenticar-com-a-casdoor-public-api",level:2},{value:"1. Por <code>Token de acesso</code>",id:"1-por-token-de-acesso",level:3},{value:"Como obter o token de acesso?",id:"como-obter-o-token-de-acesso",level:4},{value:"Como autenticar?",id:"como-autenticar",level:4},{value:"2. Por <code>Client ID</code> e <code>Client secret</code>",id:"2-por-client-id-e-client-secret",level:3},{value:"Como obter o ID do cliente e o segredo?",id:"como-obter-o-id-do-cliente-e-o-segredo",level:4},{value:"Como autenticar?",id:"como-autenticar-1",level:4},{value:"3. Por <code>Access key</code> e <code>Access secret</code>",id:"3-por-access-key-e-access-secret",level:3},{value:"Como autenticar?",id:"como-autenticar-2",level:4},{value:"4. Por <code>username</code> e <code>password</code>",id:"4-por-username-e-password",level:3},{value:"Como autenticar?",id:"como-autenticar-3",level:4}],p={toc:d};function l(e){let{components:o,...n}=e;return(0,r.kt)("wrapper",(0,t.Z)({},p,n,{components:o,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"A interface web do frontend do Casdoor \xe9 uma ",(0,r.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Glossary/SPA"},"SPA (Aplica\xe7\xe3o de P\xe1gina \xdanica)")," desenvolvida em React. O frontend em React consome a API RESTful do Casdoor exposta pelo c\xf3digo backend em Go. Esta API RESTful \xe9 referida como ",(0,r.kt)("inlineCode",{parentName:"p"},"Casdoor Public API"),". Em outras palavras, com chamadas HTTP, voc\xea pode fazer tudo exatamente como a interface web do Casdoor faz. N\xe3o h\xe1 outras limita\xe7\xf5es. A API pode ser utilizada pelos seguintes:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Frontend do Casdoor"),(0,r.kt)("li",{parentName:"ul"},"SDKs de cliente do Casdoor (por exemplo, casdoor-go-sdk)"),(0,r.kt)("li",{parentName:"ul"},"Qualquer outro c\xf3digo personalizado do lado da aplica\xe7\xe3o")),(0,r.kt)("p",null,"A refer\xeancia completa para a ",(0,r.kt)("inlineCode",{parentName:"p"},"Casdoor Public API")," pode ser encontrada no Swagger: ",(0,r.kt)("a",{parentName:"p",href:"https://door.casdoor.com/swagger"},(0,r.kt)("strong",{parentName:"a"},"https://door.casdoor.com/swagger")),". Estes documentos do Swagger s\xe3o gerados automaticamente usando a ferramenta Bee do Beego. Se voc\xea quiser gerar os documentos do Swagger por si mesmo, veja: ",(0,r.kt)("a",{parentName:"p",href:"/docs/developer-guide/swagger/#how-to-generate-the-swagger-file"},"Como gerar o arquivo swagger")),(0,r.kt)("h2",{id:"como-autenticar-com-a-casdoor-public-api"},"Como autenticar com a ",(0,r.kt)("inlineCode",{parentName:"h2"},"Casdoor Public API")),(0,r.kt)("h3",{id:"1-por-token-de-acesso"},"1. Por ",(0,r.kt)("inlineCode",{parentName:"h3"},"Token de acesso")),(0,r.kt)("p",null,"Podemos usar o token de acesso concedido para um usu\xe1rio autenticado para chamar a ",(0,r.kt)("inlineCode",{parentName:"p"},"Casdoor Public API")," como o pr\xf3prio usu\xe1rio."),(0,r.kt)("h4",{id:"como-obter-o-token-de-acesso"},"Como obter o token de acesso?"),(0,r.kt)("p",null,"A aplica\xe7\xe3o pode obter o token de acesso para o usu\xe1rio do Casdoor no final do processo de login OAuth (tamb\xe9m conhecido como obter o token por c\xf3digo e estado). As permiss\xf5es para as chamadas de API ser\xe3o as mesmas que as do usu\xe1rio."),(0,r.kt)("p",null,"Os exemplos abaixo mostram como chamar a fun\xe7\xe3o ",(0,r.kt)("inlineCode",{parentName:"p"},"GetOAuthToken()")," em Go atrav\xe9s do casdoor-go-sdk."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-go"},'func (c *ApiController) Signin() {\n    code := c.Input().Get("code")\n    state := c.Input().Get("state")\n\n    token, err := casdoorsdk.GetOAuthToken(code, state)\n    if err != nil {\n        c.ResponseError(err.Error())\n        return\n    }\n\n    claims, err := casdoorsdk.ParseJwtToken(token.AccessToken)\n    if err != nil {\n        c.ResponseError(err.Error())\n        return\n    }\n\n    if !claims.IsAdmin {\n        claims.Type = "chat-user"\n    }\n\n    err = c.addInitialChat(&claims.User)\n    if err != nil {\n        c.ResponseError(err.Error())\n        return\n    }\n\n    claims.AccessToken = token.AccessToken\n    c.SetSessionClaims(claims)\n\n    c.ResponseOk(claims)\n}\n')),(0,r.kt)("p",null,"Todos os tokens de acesso concedidos tamb\xe9m podem ser acessados via interface web por um usu\xe1rio administrador na p\xe1gina de Tokens. Por exemplo, visite: ",(0,r.kt)("a",{parentName:"p",href:"https://door.casdoor.com/tokens"},"https://door.casdoor.com/tokens")," para o site de demonstra\xe7\xe3o."),(0,r.kt)("h4",{id:"como-autenticar"},"Como autenticar?"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Par\xe2metro HTTP ",(0,r.kt)("inlineCode",{parentName:"p"},"GET"),", o formato da URL \xe9:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"/page?access_token=<The access token>\n")),(0,r.kt)("p",{parentName:"li"},"Exemplo do site de demonstra\xe7\xe3o: ",(0,r.kt)("inlineCode",{parentName:"p"},"https://door.casdoor.com/api/get-global-providers?access_token=eyJhbGciOiJSUzI1NiIs"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Token Bearer HTTP, o formato do cabe\xe7alho HTTP \xe9:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"Authorization: Bearer <The access token>\n")))),(0,r.kt)("h3",{id:"2-por-client-id-e-client-secret"},"2. Por ",(0,r.kt)("inlineCode",{parentName:"h3"},"Client ID")," e ",(0,r.kt)("inlineCode",{parentName:"h3"},"Client secret")),(0,r.kt)("h4",{id:"como-obter-o-id-do-cliente-e-o-segredo"},"Como obter o ID do cliente e o segredo?"),(0,r.kt)("p",null,"A p\xe1gina de edi\xe7\xe3o da aplica\xe7\xe3o (por exemplo, ",(0,r.kt)("a",{parentName:"p",href:"https://door.casdoor.com/applications/casbin/app-vue-python-example"},"https://door.casdoor.com/applications/casbin/app-vue-python-example"),') mostrar\xe1 o ID do cliente e o segredo para uma aplica\xe7\xe3o. Esta autentica\xe7\xe3o \xe9 \xfatil quando voc\xea quer chamar a API como uma "m\xe1quina", "aplica\xe7\xe3o" ou um "servi\xe7o" em vez de um usu\xe1rio. As permiss\xf5es para as chamadas de API ser\xe3o as mesmas que as da aplica\xe7\xe3o (tamb\xe9m conhecida como o administrador da organiza\xe7\xe3o).'),(0,r.kt)("p",null,"Os exemplos abaixo mostram como chamar a fun\xe7\xe3o ",(0,r.kt)("inlineCode",{parentName:"p"},"GetOAuthToken()")," em Go atrav\xe9s do casdoor-go-sdk."),(0,r.kt)("h4",{id:"como-autenticar-1"},"Como autenticar?"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Par\xe2metro HTTP ",(0,r.kt)("inlineCode",{parentName:"p"},"GET"),", o formato da URL \xe9:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"/page?clientId=<The client ID>&clientSecret=<the client secret>\n")),(0,r.kt)("p",{parentName:"li"},"Exemplo do site de demonstra\xe7\xe3o: ",(0,r.kt)("inlineCode",{parentName:"p"},"https://door.casdoor.com/api/get-global-providers?clientId=294b09fbc17f95daf2fe&clientSecret=dd8982f7046ccba1bbd7851d5c1ece4e52bf039d"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Basic_access_authentication"},"Autentica\xe7\xe3o B\xe1sica HTTP"),", o formato do cabe\xe7alho HTTP \xe9:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'Authorization: Basic <The Base64 encoding of client ID and client secret joined by a single colon ":">\n')))),(0,r.kt)("p",null,"Se voc\xea n\xe3o est\xe1 familiarizado com a codifica\xe7\xe3o Base64, voc\xea pode usar uma biblioteca para fazer isso porque a ",(0,r.kt)("inlineCode",{parentName:"p"},"Autentica\xe7\xe3o B\xe1sica HTTP")," \xe9 um padr\xe3o popular suportado por muitos lugares."),(0,r.kt)("h3",{id:"3-por-access-key-e-access-secret"},"3. Por ",(0,r.kt)("inlineCode",{parentName:"h3"},"Access key")," e ",(0,r.kt)("inlineCode",{parentName:"h3"},"Access secret")),(0,r.kt)("p",null,"Podemos usar a chave de acesso e o segredo de acesso de um usu\xe1rio do Casdoor para chamar a ",(0,r.kt)("inlineCode",{parentName:"p"},"Casdoor Public API")," como o pr\xf3prio usu\xe1rio. A chave de acesso e o segredo de acesso podem ser configurados na p\xe1gina de configura\xe7\xf5es do usu\xe1rio por um administrador ou pelo pr\xf3prio usu\xe1rio. a API ",(0,r.kt)("inlineCode",{parentName:"p"},"update-user")," tamb\xe9m pode ser chamada para atualizar esses campos. As permiss\xf5es para as chamadas de API ser\xe3o as mesmas que as do usu\xe1rio."),(0,r.kt)("h4",{id:"como-autenticar-2"},"Como autenticar?"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Create a pair of accessKey and accessSecret in account setting page.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Par\xe2metro HTTP ",(0,r.kt)("inlineCode",{parentName:"p"},"GET"),", o formato da URL \xe9:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"/page?accessKey=<The user's access key>&accessSecret=<the user's access secret>\"\n")))),(0,r.kt)("p",null,"Exemplo do site de demonstra\xe7\xe3o: ",(0,r.kt)("inlineCode",{parentName:"p"},"https://door.casdoor.com/api/get-global-providers?accessKey=b86db9dc-6bd7-4997-935c-af480dd2c796/admin&accessSecret=79911517-fc36-4093-b115-65a9741f6b14")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"User Api Key",src:a(33379).Z,width:"538",height:"231"})),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"curl --location 'http://door.casdoor.com/api/user?accessKey=b86db9dc-6bd7-4997-935c-af480dd2c796&accessSecret=79911517-fc36-4093-b115-65a9741f6b14'\n")),(0,r.kt)("h3",{id:"4-por-username-e-password"},"4. Por ",(0,r.kt)("inlineCode",{parentName:"h3"},"username")," e ",(0,r.kt)("inlineCode",{parentName:"h3"},"password")),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"Este m\xe9todo de autentica\xe7\xe3o n\xe3o \xe9 seguro e \xe9 mantido aqui apenas para fins de compatibilidade ou demonstra\xe7\xe3o. Recomendamos usar os tr\xeas m\xe9todos de autentica\xe7\xe3o anteriores em vez deste."),(0,r.kt)("h4",{parentName:"admonition",id:"o-que-acontecer\xe1"},"O que acontecer\xe1?"),(0,r.kt)("p",{parentName:"admonition"},"As credenciais do usu\xe1rio ser\xe3o expostas como par\xe2metros ",(0,r.kt)("inlineCode",{parentName:"p"},"GET")," na URL da solicita\xe7\xe3o. Al\xe9m disso, as credenciais do usu\xe1rio ser\xe3o capturadas em texto simples pela rede se voc\xea estiver usando HTTP em vez de HTTPS.")),(0,r.kt)("p",null,"Podemos usar o nome de usu\xe1rio e senha de um usu\xe1rio do Casdoor para chamar a ",(0,r.kt)("inlineCode",{parentName:"p"},"Casdoor Public API")," como o pr\xf3prio usu\xe1rio. O nome de usu\xe1rio tem o formato de ",(0,r.kt)("inlineCode",{parentName:"p"},"<Nome da organiza\xe7\xe3o do usu\xe1rio>/<Nome do usu\xe1rio>"),". As permiss\xf5es para as chamadas de API ser\xe3o as mesmas que as do usu\xe1rio."),(0,r.kt)("h4",{id:"como-autenticar-3"},"Como autenticar?"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Par\xe2metro HTTP ",(0,r.kt)("inlineCode",{parentName:"p"},"GET"),", o formato da URL \xe9:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"/page?username=<The user's organization name>/<The user name>&password=<the user's password>\"\n")))),(0,r.kt)("p",null,"Exemplo do site de demonstra\xe7\xe3o: ",(0,r.kt)("inlineCode",{parentName:"p"},"https://door.casdoor.com/api/get-global-providers?username=built-in/admin&password=123")))}l.isMDXComponent=!0},33379:(e,o,a)=>{a.d(o,{Z:()=>t});const t=a.p+"assets/images/user_api_key-dd4f820d64ab1511d1d948bfd1dec81a.png"}}]);