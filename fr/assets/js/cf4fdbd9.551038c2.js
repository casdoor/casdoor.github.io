"use strict";(self.webpackChunkcasdoor_website=self.webpackChunkcasdoor_website||[]).push([[7409],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>m});var o=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=o.createContext({}),s=function(e){var t=o.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},d=function(e){var t=s(e.components);return o.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},p=o.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,l=e.parentName,d=c(e,["components","mdxType","originalType","parentName"]),p=s(n),m=a,f=p["".concat(l,".").concat(m)]||p[m]||u[m]||r;return n?o.createElement(f,i(i({ref:t},d),{},{components:n})):o.createElement(f,i({ref:t},d))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,i=new Array(r);i[0]=p;var c={};for(var l in t)hasOwnProperty.call(t,l)&&(c[l]=t[l]);c.originalType=e,c.mdxType="string"==typeof e?e:a,i[1]=c;for(var s=2;s<r;s++)i[s]=n[s];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}p.displayName="MDXCreateElement"},16259:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>u,frontMatter:()=>r,metadata:()=>c,toc:()=>s});var o=n(87462),a=(n(67294),n(3905));const r={title:"Tencent Cloud",description:"Utilisation de Casdoor comme IdP SAML",keywords:["SAML","IdP"],authors:["Songjf-ttk"]},i=void 0,c={unversionedId:"how-to-connect/saml/tencent-cloud",id:"how-to-connect/saml/tencent-cloud",title:"Tencent Cloud",description:"Utilisation de Casdoor comme IdP SAML",source:"@site/i18n/fr/docusaurus-plugin-content-docs/current/how-to-connect/saml/tencent-cloud.md",sourceDirName:"how-to-connect/saml",slug:"/how-to-connect/saml/tencent-cloud",permalink:"/fr/docs/how-to-connect/saml/tencent-cloud",draft:!1,editUrl:"https://github.com/casdoor/casdoor-website/edit/master/docs/how-to-connect/saml/tencent-cloud.md",tags:[],version:"current",frontMatter:{title:"Tencent Cloud",description:"Utilisation de Casdoor comme IdP SAML",keywords:["SAML","IdP"],authors:["Songjf-ttk"]},sidebar:"tutorialSidebar",previous:{title:"Appgate (POST)",permalink:"/fr/docs/how-to-connect/saml/appgate"},next:{title:"Face ID",permalink:"/fr/docs/how-to-connect/face-id"}},l={},s=[{value:"Casdoor comme IdP SAML dans Tencent Cloud",id:"casdoor-comme-idp-saml-dans-tencent-cloud",level:2},{value:"Copier les m\xe9tadonn\xe9es Saml",id:"copier-les-m\xe9tadonn\xe9es-saml",level:3},{value:"Ajout d&#39;IdP SAML dans Tencent Cloud",id:"ajout-didp-saml-dans-tencent-cloud",level:3},{value:"Configuration de l&#39;application SAML dans Casdoor",id:"configuration-de-lapplication-saml-dans-casdoor",level:3},{value:"Connexion en utilisant Casdoor SAML",id:"connexion-en-utilisant-casdoor-saml",level:3}],d={toc:s};function u(e){let{components:t,...r}=e;return(0,a.kt)("wrapper",(0,o.Z)({},d,r,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"casdoor-comme-idp-saml-dans-tencent-cloud"},"Casdoor comme IdP SAML dans Tencent Cloud"),(0,a.kt)("p",null,"Ce guide vous montrera comment configurer Casdoor et Tencent Cloud pour ajouter Casdoor comme IdP SAML dans Tencent Cloud."),(0,a.kt)("h3",{id:"copier-les-m\xe9tadonn\xe9es-saml"},"Copier les m\xe9tadonn\xe9es Saml"),(0,a.kt)("p",null,"Dans Casdoor, ajoutez un certificat de type X.509 avec l'algorithme cryptographique RSA."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Ajouter cert",src:n(83897).Z,width:"1694",height:"761"})),(0,a.kt)("p",null,"Ensuite, copiez les SamlMetadata dans Casdoor."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Copier les m\xe9tadonn\xe9es Saml",src:n(92081).Z,width:"1870",height:"554"})),(0,a.kt)("h3",{id:"ajout-didp-saml-dans-tencent-cloud"},"Ajout d'IdP SAML dans Tencent Cloud"),(0,a.kt)("p",null,"Connectez-vous \xe0 Tencent Cloud et entrez dans l'interface de gestion des acc\xe8s."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Connexion Gestion des Acc\xe8s",src:n(76072).Z,width:"1902",height:"831"})),(0,a.kt)("p",null,"Cr\xe9ez un nouveau ",(0,a.kt)("strong",{parentName:"p"},"Fournisseurs d'Identit\xe9")," et t\xe9l\xe9chargez les ",(0,a.kt)("strong",{parentName:"p"},"m\xe9tadonn\xe9es saml")," pr\xe9c\xe9demment copi\xe9es sur Tencent Cloud."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Saml idp create",src:n(89494).Z,width:"1898",height:"794"})),(0,a.kt)("p",null,"Ensuite, cr\xe9ez un nouveau ",(0,a.kt)("strong",{parentName:"p"},"R\xd4LE")," et s\xe9lectionnez le ",(0,a.kt)("strong",{parentName:"p"},"Fournisseurs d'Identit\xe9")," pr\xe9c\xe9dent comme fournisseur idp."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Saml role create",src:n(49532).Z,width:"1915",height:"859"})),(0,a.kt)("h3",{id:"configuration-de-lapplication-saml-dans-casdoor"},"Configuration de l'application SAML dans Casdoor"),(0,a.kt)("p",null,"Sur la page de modification de l'application, s\xe9lectionnez le certificat que vous venez de cr\xe9er. Ajoutez le nom de domaine de l'application Tencent Cloud que vous utiliserez dans les ",(0,a.kt)("strong",{parentName:"p"},"URL de redirection"),"."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"S\xe9lectionnez cert et ajoutez des URL de redirection",src:n(23358).Z,width:"1854",height:"481"})),(0,a.kt)("p",null,"Sur la page de modification de l'application, entrez l'",(0,a.kt)("strong",{parentName:"p"},"URL ACS")," et configurez l'",(0,a.kt)("strong",{parentName:"p"},"Attribut Saml"),"."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Ajoutez l&#39;url ACS et configurez l&#39;attribut saml",src:n(28842).Z,width:"1899",height:"529"})),(0,a.kt)("p",null,"Les informations de configuration pour l'Attribut Saml sont les suivantes :"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:"left"},"Nom"),(0,a.kt)("th",{parentName:"tr",align:"left"},"Format du nom"),(0,a.kt)("th",{parentName:"tr",align:"left"},"Valeur"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"left"},(0,a.kt)("inlineCode",{parentName:"td"},"https://cloud.tencent.com/SAML/Attributes/Role")),(0,a.kt)("td",{parentName:"tr",align:"left"},"Non sp\xe9cifi\xe9"),(0,a.kt)("td",{parentName:"tr",align:"left"},"qcs::cam::uin/{AccountID}:roleName/{RoleName1};qcs::cam::uin/{AccountID}:roleName/{RoleName2},qcs::cam::uin/{AccountID}:saml-provider/{ProviderName}")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"left"},(0,a.kt)("inlineCode",{parentName:"td"},"https://cloud.tencent.com/SAML/Attributes/RoleSessionName")),(0,a.kt)("td",{parentName:"tr",align:"left"},"Non sp\xe9cifi\xe9"),(0,a.kt)("td",{parentName:"tr",align:"left"},"casdoor")))),(0,a.kt)("admonition",{type:"info"},(0,a.kt)("ul",{parentName:"admonition"},(0,a.kt)("li",{parentName:"ul"},"Dans l'attribut source du r\xf4le, remplacez {AccountID}, {RoleName} et {ProviderName} par le contenu suivant :"),(0,a.kt)("li",{parentName:"ul"},"Remplacez {AccountID} par votre ID de compte Tencent Cloud, qui peut \xeatre consult\xe9 dans le ",(0,a.kt)("a",{parentName:"li",href:"https://console.cloud.tencent.com/developer"},"Informations sur le compte - Console"),"."),(0,a.kt)("li",{parentName:"ul"},"Remplacez {RoleName} par le nom du r\xf4le que vous avez cr\xe9\xe9 dans Tencent Cloud, qui peut \xeatre consult\xe9 dans le ",(0,a.kt)("a",{parentName:"li",href:"https://console.cloud.tencent.com/cam/role"},"R\xf4les - Console"),"."),(0,a.kt)("li",{parentName:"ul"},"Remplacez {ProviderName} par le nom du fournisseur d'identit\xe9 SAML que vous avez cr\xe9\xe9 dans Tencent Cloud, qui peut \xeatre consult\xe9 dans le ",(0,a.kt)("a",{parentName:"li",href:"https://console.cloud.tencent.com/cam/idp"},"Fournisseurs d'Identit\xe9 - Console"),".")),(0,a.kt)("p",{parentName:"admonition"},"Vous pouvez visiter la documentation des Fournisseurs d'Identit\xe9 SAML de Tencent Cloud ",(0,a.kt)("a",{parentName:"p",href:"https://cloud.tencent.com/document/product/598/38058"},"documentation")," pour obtenir des informations plus d\xe9taill\xe9es.")),(0,a.kt)("h3",{id:"connexion-en-utilisant-casdoor-saml"},"Connexion en utilisant Casdoor SAML"),(0,a.kt)("p",null,"Les \xe9tapes g\xe9n\xe9rales de connexion pour SAML sont les suivantes : Utilisateur -> Tencent Cloud (non connect\xe9) -> Redirection vers Casdoor pour la connexion -> Tencent Cloud (connect\xe9). Maintenant, utilisez du code externe pour simuler les deux premi\xe8res \xe9tapes et g\xe9n\xe9rer une URL qui redirige vers Casdoor. Code d'exemple :"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},'func main() {\n    res, err := http.Get("your casdoor application saml metadata url")\n    if err != nil {\n        panic(err)\n    }\n\n    rawMetadata, err := ioutil.ReadAll(res.Body)\n    if err != nil {\n        panic(err)\n    }\n\n    metadata := &types.EntityDescriptor{}\n    err = xml.Unmarshal(rawMetadata, metadata)\n    if err != nil {\n        panic(err)\n    }\n\n    certStore := dsig.MemoryX509CertificateStore{\n        Roots: []*x509.Certificate{},\n    }\n\n    for _, kd := range metadata.IDPSSODescriptor.KeyDescriptors {\n        for idx, xcert := range kd.KeyInfo.X509Data.X509Certificates {\n            if xcert.Data == "" {\n                panic(fmt.Errorf("metadata certificate(%d) must not be empty", idx))\n            }\n            certData, err := base64.StdEncoding.DecodeString(xcert.Data)\n            if err != nil {\n                panic(err)\n            }\n\n            idpCert, err := x509.ParseCertificate(certData)\n            if err != nil {\n                panic(err)\n            }\n\n            certStore.Roots = append(certStore.Roots, idpCert)\n        }\n    }\n\n    randomKeyStore := dsig.RandomKeyStoreForTest()\n\n    sp := &saml2.SAMLServiceProvider{\n        IdentityProviderSSOURL:      metadata.IDPSSODescriptor.SingleSignOnServices[0].Location,\n        IdentityProviderIssuer:      metadata.EntityID,\n        ServiceProviderIssuer:       "https://cloud.tencent.com",\n        AssertionConsumerServiceURL: "https://cloud.tencent.com/login/saml",\n        SignAuthnRequests:           true,\n        AudienceURI:                 "https://cloud.tencent.com",\n        IDPCertificateStore:         &certStore,\n        SPKeyStore:                  randomKeyStore,\n    }\n\n    println("Visit this URL To Authenticate:")\n    authURL, err := sp.BuildAuthURL("")\n    if err != nil {\n        panic(err)\n    }\n\n    println(authURL)\n}\n')),(0,a.kt)("p",null,"Une fois que nous ex\xe9cutons le code et obtenons l'",(0,a.kt)("strong",{parentName:"p"},"URL d'authentification"),", cliquer sur l'URL nous permettra de tester la connexion. nous fournissons une d\xe9mo de ce processus."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"R\xe9sultat final",src:n(60773).Z,width:"714",height:"376"})))}u.isMDXComponent=!0},76072:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/saml_tencent-cloud_access_management-becdf44c901f8a05ed373c5a3f831d70.png"},28842:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/saml_tencent-cloud_acs-dee4b189520cfcddeadb3d31fe35e1e1.png"},23358:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/saml_tencent-cloud_app-798995784063235b950b4a410fe4b59c.png"},83897:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/saml_tencent-cloud_cert-acc61a90add8be443c7feff4b5cd6df2.png"},49532:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/saml_tencent-cloud_create_role-1feda08ae98b7add35efcc72e2ae09ae.png"},89494:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/saml_tencent-cloud_idp_create-9aae768d6ca5cf3ceba0505d97151411.png"},60773:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/saml_tencent-cloud_login_test-fdd9d104d5df76a161a29208136134d4.gif"},92081:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/saml_tencent-cloud_metadata-391b8decc7d48c2850d565ea0d1f24e7.png"}}]);