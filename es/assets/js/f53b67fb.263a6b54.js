"use strict";(self.webpackChunkcasdoor_website=self.webpackChunkcasdoor_website||[]).push([[2835],{3905:(e,a,o)=>{o.d(a,{Zo:()=>d,kt:()=>m});var t=o(67294);function r(e,a,o){return a in e?Object.defineProperty(e,a,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[a]=o,e}function n(e,a){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);a&&(t=t.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),o.push.apply(o,t)}return o}function s(e){for(var a=1;a<arguments.length;a++){var o=null!=arguments[a]?arguments[a]:{};a%2?n(Object(o),!0).forEach((function(a){r(e,a,o[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):n(Object(o)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(o,a))}))}return e}function i(e,a){if(null==e)return{};var o,t,r=function(e,a){if(null==e)return{};var o,t,r={},n=Object.keys(e);for(t=0;t<n.length;t++)o=n[t],a.indexOf(o)>=0||(r[o]=e[o]);return r}(e,a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(t=0;t<n.length;t++)o=n[t],a.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(r[o]=e[o])}return r}var c=t.createContext({}),l=function(e){var a=t.useContext(c),o=a;return e&&(o="function"==typeof e?e(a):s(s({},a),e)),o},d=function(e){var a=l(e.components);return t.createElement(c.Provider,{value:a},e.children)},p={inlineCode:"code",wrapper:function(e){var a=e.children;return t.createElement(t.Fragment,{},a)}},u=t.forwardRef((function(e,a){var o=e.components,r=e.mdxType,n=e.originalType,c=e.parentName,d=i(e,["components","mdxType","originalType","parentName"]),u=l(o),m=r,k=u["".concat(c,".").concat(m)]||u[m]||p[m]||n;return o?t.createElement(k,s(s({ref:a},d),{},{components:o})):t.createElement(k,s({ref:a},d))}));function m(e,a){var o=arguments,r=a&&a.mdxType;if("string"==typeof e||r){var n=o.length,s=new Array(n);s[0]=u;var i={};for(var c in a)hasOwnProperty.call(a,c)&&(i[c]=a[c]);i.originalType=e,i.mdxType="string"==typeof e?e:r,s[1]=i;for(var l=2;l<n;l++)s[l]=o[l];return t.createElement.apply(null,s)}return t.createElement.apply(null,o)}u.displayName="MDXCreateElement"},47069:(e,a,o)=>{o.r(a),o.d(a,{assets:()=>c,contentTitle:()=>s,default:()=>p,frontMatter:()=>n,metadata:()=>i,toc:()=>l});var t=o(87462),r=(o(67294),o(3905));const n={title:"API P\xfablica de Casdoor",description:"API P\xfablica de Casdoor",keywords:["API P\xfablica de Casdoor"],authors:["hsluoyz"]},s=void 0,i={unversionedId:"basic/public-api",id:"basic/public-api",title:"API P\xfablica de Casdoor",description:"API P\xfablica de Casdoor",source:"@site/i18n/es/docusaurus-plugin-content-docs/current/basic/public-api.md",sourceDirName:"basic",slug:"/basic/public-api",permalink:"/es/docs/basic/public-api",draft:!1,editUrl:"https://github.com/casdoor/casdoor-website/edit/master/docs/basic/public-api.md",tags:[],version:"current",frontMatter:{title:"API P\xfablica de Casdoor",description:"API P\xfablica de Casdoor",keywords:["API P\xfablica de Casdoor"],authors:["hsluoyz"]},sidebar:"tutorialSidebar",previous:{title:"(Opcional) Prueba con K8s Helm",permalink:"/es/docs/basic/try-with-helm"},next:{title:"Tutoriales",permalink:"/es/docs/basic/tutorials"}},c={},l=[{value:"C\xf3mo autenticarse con <code>Casdoor Public API</code>",id:"c\xf3mo-autenticarse-con-casdoor-public-api",level:2},{value:"1. Por <code>Access token</code>",id:"1-por-access-token",level:3},{value:"\xbfC\xf3mo obtener el token de acceso?",id:"c\xf3mo-obtener-el-token-de-acceso",level:4},{value:"\xbfC\xf3mo autenticarse?",id:"c\xf3mo-autenticarse",level:4},{value:"2. Por <code>Client ID</code> y <code>Client secret</code>",id:"2-por-client-id-y-client-secret",level:3},{value:"\xbfC\xf3mo obtener el ID de cliente y el secreto?",id:"c\xf3mo-obtener-el-id-de-cliente-y-el-secreto",level:4},{value:"\xbfC\xf3mo autenticarse?",id:"c\xf3mo-autenticarse-1",level:4},{value:"3. Por <code>Access key</code> y <code>Access secret</code>",id:"3-por-access-key-y-access-secret",level:3},{value:"\xbfC\xf3mo autenticarse?",id:"c\xf3mo-autenticarse-2",level:4},{value:"4. Por <code>username</code> y <code>password</code>",id:"4-por-username-y-password",level:3},{value:"\xbfC\xf3mo autenticarse?",id:"c\xf3mo-autenticarse-3",level:4}],d={toc:l};function p(e){let{components:a,...n}=e;return(0,r.kt)("wrapper",(0,t.Z)({},d,n,{components:a,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"La interfaz de usuario web del frontend de Casdoor es una ",(0,r.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Glossary/SPA"},"SPA (Aplicaci\xf3n de Una Sola P\xe1gina)")," desarrollada en React. El frontend de React consume la API RESTful de Casdoor expuesta por el c\xf3digo del backend en Go. Esta API RESTful se conoce como ",(0,r.kt)("inlineCode",{parentName:"p"},"Casdoor Public API"),". En otras palabras, con llamadas HTTP, puedes hacer todo tal como lo hace la propia interfaz web de Casdoor. No hay otras limitaciones. La API puede ser utilizada por los siguientes:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Frontend de Casdoor"),(0,r.kt)("li",{parentName:"ul"},"SDKs de cliente de Casdoor (por ejemplo, casdoor-go-sdk)"),(0,r.kt)("li",{parentName:"ul"},"Cualquier otro c\xf3digo personalizado del lado de la aplicaci\xf3n")),(0,r.kt)("p",null,"La referencia completa para la ",(0,r.kt)("inlineCode",{parentName:"p"},"Casdoor Public API")," se puede encontrar en Swagger: ",(0,r.kt)("a",{parentName:"p",href:"https://door.casdoor.com/swagger"},(0,r.kt)("strong",{parentName:"a"},"https://door.casdoor.com/swagger")),". Estos documentos de Swagger se generan autom\xe1ticamente utilizando la herramienta Bee de Beego. Si quieres generar los documentos de Swagger por ti mismo, consulta: ",(0,r.kt)("a",{parentName:"p",href:"/docs/developer-guide/swagger/#how-to-generate-the-swagger-file"},"C\xf3mo generar el archivo swagger")),(0,r.kt)("h2",{id:"c\xf3mo-autenticarse-con-casdoor-public-api"},"C\xf3mo autenticarse con ",(0,r.kt)("inlineCode",{parentName:"h2"},"Casdoor Public API")),(0,r.kt)("h3",{id:"1-por-access-token"},"1. Por ",(0,r.kt)("inlineCode",{parentName:"h3"},"Access token")),(0,r.kt)("p",null,"Podemos usar el token de acceso otorgado a un usuario autenticado para llamar a ",(0,r.kt)("inlineCode",{parentName:"p"},"Casdoor Public API")," como el propio usuario."),(0,r.kt)("h4",{id:"c\xf3mo-obtener-el-token-de-acceso"},"\xbfC\xf3mo obtener el token de acceso?"),(0,r.kt)("p",null,"La aplicaci\xf3n puede obtener el token de acceso para el usuario de Casdoor al final del proceso de inicio de sesi\xf3n de OAuth (tambi\xe9n conocido como obtener el token por c\xf3digo y estado). Los permisos para las llamadas a la API ser\xe1n los mismos que los del usuario."),(0,r.kt)("p",null,"Los siguientes ejemplos muestran c\xf3mo llamar a la funci\xf3n ",(0,r.kt)("inlineCode",{parentName:"p"},"GetOAuthToken()")," en Go a trav\xe9s de casdoor-go-sdk."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-go"},'func (c *ApiController) Signin() {\n    code := c.Input().Get("code")\n    state := c.Input().Get("state")\n\n    token, err := casdoorsdk.GetOAuthToken(code, state)\n    if err != nil {\n        c.ResponseError(err.Error())\n        return\n    }\n\n    claims, err := casdoorsdk.ParseJwtToken(token.AccessToken)\n    if err != nil {\n        c.ResponseError(err.Error())\n        return\n    }\n\n    if !claims.IsAdmin {\n        claims.Type = "chat-user"\n    }\n\n    err = c.addInitialChat(&claims.User)\n    if err != nil {\n        c.ResponseError(err.Error())\n        return\n    }\n\n    claims.AccessToken = token.AccessToken\n    c.SetSessionClaims(claims)\n\n    c.ResponseOk(claims)\n}\n')),(0,r.kt)("p",null,"Todos los tokens de acceso otorgados tambi\xe9n se pueden acceder a trav\xe9s de la interfaz de usuario web por un usuario administrador en la p\xe1gina de Tokens. Por ejemplo, visita: ",(0,r.kt)("a",{parentName:"p",href:"https://door.casdoor.com/tokens"},"https://door.casdoor.com/tokens")," para el sitio de demostraci\xf3n."),(0,r.kt)("h4",{id:"c\xf3mo-autenticarse"},"\xbfC\xf3mo autenticarse?"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Par\xe1metro HTTP ",(0,r.kt)("inlineCode",{parentName:"p"},"GET"),", el formato de la URL es:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"/page?access_token=<The access token>\n")),(0,r.kt)("p",{parentName:"li"},"Ejemplo del sitio de demostraci\xf3n: ",(0,r.kt)("inlineCode",{parentName:"p"},"https://door.casdoor.com/api/get-global-providers?access_token=eyJhbGciOiJSUzI1NiIs"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Token Bearer HTTP, el formato de la cabecera HTTP es:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"Authorization: Bearer <The access token>\n")))),(0,r.kt)("h3",{id:"2-por-client-id-y-client-secret"},"2. Por ",(0,r.kt)("inlineCode",{parentName:"h3"},"Client ID")," y ",(0,r.kt)("inlineCode",{parentName:"h3"},"Client secret")),(0,r.kt)("h4",{id:"c\xf3mo-obtener-el-id-de-cliente-y-el-secreto"},"\xbfC\xf3mo obtener el ID de cliente y el secreto?"),(0,r.kt)("p",null,"La p\xe1gina de edici\xf3n de la aplicaci\xf3n (por ejemplo, ",(0,r.kt)("a",{parentName:"p",href:"https://door.casdoor.com/applications/casbin/app-vue-python-example"},"https://door.casdoor.com/applications/casbin/app-vue-python-example"),') mostrar\xe1 el ID de cliente y el secreto para una aplicaci\xf3n. Esta autenticaci\xf3n es \xfatil cuando quieres llamar a la API como una "m\xe1quina", "aplicaci\xf3n" o un "servicio" en lugar de un usuario. Los permisos para las llamadas a la API ser\xe1n los mismos que los de la aplicaci\xf3n (tambi\xe9n conocido como el administrador de la organizaci\xf3n).'),(0,r.kt)("p",null,"Los siguientes ejemplos muestran c\xf3mo llamar a la funci\xf3n ",(0,r.kt)("inlineCode",{parentName:"p"},"GetOAuthToken()")," en Go a trav\xe9s de casdoor-go-sdk."),(0,r.kt)("h4",{id:"c\xf3mo-autenticarse-1"},"\xbfC\xf3mo autenticarse?"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Par\xe1metro HTTP ",(0,r.kt)("inlineCode",{parentName:"p"},"GET"),", el formato de la URL es:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"/page?clientId=<The client ID>&clientSecret=<the client secret>\n")),(0,r.kt)("p",{parentName:"li"},"Ejemplo del sitio de demostraci\xf3n: ",(0,r.kt)("inlineCode",{parentName:"p"},"https://door.casdoor.com/api/get-global-providers?clientId=294b09fbc17f95daf2fe&clientSecret=dd8982f7046ccba1bbd7851d5c1ece4e52bf039d"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Basic_access_authentication"},"Autenticaci\xf3n B\xe1sica HTTP"),", el formato de la cabecera HTTP es:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'Authorization: Basic <The Base64 encoding of client ID and client secret joined by a single colon ":">\n')))),(0,r.kt)("p",null,"Si no est\xe1s familiarizado con la codificaci\xf3n Base64, puedes usar una biblioteca para hacerlo porque ",(0,r.kt)("inlineCode",{parentName:"p"},"HTTP Basic Authentication")," es un est\xe1ndar popular soportado por muchos lugares."),(0,r.kt)("h3",{id:"3-por-access-key-y-access-secret"},"3. Por ",(0,r.kt)("inlineCode",{parentName:"h3"},"Access key")," y ",(0,r.kt)("inlineCode",{parentName:"h3"},"Access secret")),(0,r.kt)("p",null,"Podemos usar la clave de acceso y el secreto de acceso de un usuario de Casdoor para llamar a ",(0,r.kt)("inlineCode",{parentName:"p"},"Casdoor Public API")," como el propio usuario. La clave de acceso y el secreto de acceso se pueden configurar en la p\xe1gina de configuraci\xf3n del usuario por un administrador o el propio usuario. La API ",(0,r.kt)("inlineCode",{parentName:"p"},"update-user")," tambi\xe9n se puede llamar para actualizar estos campos. Los permisos para las llamadas a la API ser\xe1n los mismos que los del usuario."),(0,r.kt)("h4",{id:"c\xf3mo-autenticarse-2"},"\xbfC\xf3mo autenticarse?"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Create a pair of accessKey and accessSecret in account setting page.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Par\xe1metro HTTP ",(0,r.kt)("inlineCode",{parentName:"p"},"GET"),", el formato de la URL es:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"/page?accessKey=<The user's access key>&accessSecret=<the user's access secret>\"\n")))),(0,r.kt)("p",null,"Ejemplo del sitio de demostraci\xf3n: ",(0,r.kt)("inlineCode",{parentName:"p"},"https://door.casdoor.com/api/get-global-providers?accessKey=b86db9dc-6bd7-4997-935c-af480dd2c796/admin&accessSecret=79911517-fc36-4093-b115-65a9741f6b14")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"User Api Key",src:o(33379).Z,width:"538",height:"231"})),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"curl --location 'http://door.casdoor.com/api/user?accessKey=b86db9dc-6bd7-4997-935c-af480dd2c796&accessSecret=79911517-fc36-4093-b115-65a9741f6b14'\n")),(0,r.kt)("h3",{id:"4-por-username-y-password"},"4. Por ",(0,r.kt)("inlineCode",{parentName:"h3"},"username")," y ",(0,r.kt)("inlineCode",{parentName:"h3"},"password")),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"Este m\xe9todo de autenticaci\xf3n no es seguro y se mantiene aqu\xed solo por compatibilidad o fines de demostraci\xf3n. Recomendamos usar los tres m\xe9todos de autenticaci\xf3n anteriores en lugar de este."),(0,r.kt)("h4",{parentName:"admonition",id:"qu\xe9-suceder\xe1"},"\xbfQu\xe9 suceder\xe1?"),(0,r.kt)("p",{parentName:"admonition"},"Las credenciales del usuario se expondr\xe1n como par\xe1metros ",(0,r.kt)("inlineCode",{parentName:"p"},"GET")," en la URL de la solicitud. Adem\xe1s, las credenciales del usuario se podr\xe1n interceptar en texto plano por la red si est\xe1s usando HTTP en lugar de HTTPS.")),(0,r.kt)("p",null,"Podemos usar el nombre de usuario y la contrase\xf1a de un usuario de Casdoor para llamar a ",(0,r.kt)("inlineCode",{parentName:"p"},"Casdoor Public API")," como el propio usuario. El nombre de usuario tiene el formato de ",(0,r.kt)("inlineCode",{parentName:"p"},"<El nombre de la organizaci\xf3n del usuario>/<El nombre del usuario>"),". Los permisos para las llamadas a la API ser\xe1n los mismos que los del usuario."),(0,r.kt)("h4",{id:"c\xf3mo-autenticarse-3"},"\xbfC\xf3mo autenticarse?"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Par\xe1metro HTTP ",(0,r.kt)("inlineCode",{parentName:"p"},"GET"),", el formato de la URL es:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"/page?username=<The user's organization name>/<The user name>&password=<the user's password>\"\n")))),(0,r.kt)("p",null,"Ejemplo del sitio de demostraci\xf3n: ",(0,r.kt)("inlineCode",{parentName:"p"},"https://door.casdoor.com/api/get-global-providers?username=built-in/admin&password=123")))}p.isMDXComponent=!0},33379:(e,a,o)=>{o.d(a,{Z:()=>t});const t=o.p+"assets/images/user_api_key-dd4f820d64ab1511d1d948bfd1dec81a.png"}}]);