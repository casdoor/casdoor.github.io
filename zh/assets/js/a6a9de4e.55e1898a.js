"use strict";(self.webpackChunkcasdoor_website=self.webpackChunkcasdoor_website||[]).push([[1202],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return m}});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var p=r.createContext({}),s=function(e){var t=r.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=s(e.components);return r.createElement(p.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},u=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,p=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),u=s(n),m=a,k=u["".concat(p,".").concat(m)]||u[m]||d[m]||o;return n?r.createElement(k,i(i({ref:t},c),{},{components:n})):r.createElement(k,i({ref:t},c))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=u;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l.mdxType="string"==typeof e?e:a,i[1]=l;for(var s=2;s<o;s++)i[s]=n[s];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}u.displayName="MDXCreateElement"},85079:function(e,t,n){n.r(t),n.d(t,{assets:function(){return c},contentTitle:function(){return p},default:function(){return m},frontMatter:function(){return l},metadata:function(){return s},toc:function(){return d}});var r=n(83117),a=n(80102),o=(n(67294),n(3905)),i=["components"],l={title:"Spring Cloud",description:"\u5728Spring\u4e91\u4e2d\u4f7f\u7528 Casdoor",keywords:["Spring Cloud"]},p=void 0,s={unversionedId:"integration/spring-cloud",id:"integration/spring-cloud",title:"Spring Cloud",description:"\u5728Spring\u4e91\u4e2d\u4f7f\u7528 Casdoor",source:"@site/i18n/zh/docusaurus-plugin-content-docs/current/integration/spring-cloud.md",sourceDirName:"integration",slug:"/integration/spring-cloud",permalink:"/zh/docs/integration/spring-cloud",draft:!1,editUrl:"https://github.com/casdoor/casdoor-website/tree/master/docs/integration/spring-cloud.md",tags:[],version:"current",frontMatter:{title:"Spring Cloud",description:"\u5728Spring\u4e91\u4e2d\u4f7f\u7528 Casdoor",keywords:["Spring Cloud"]},sidebar:"tutorialSidebar",previous:{title:"Spring Boot",permalink:"/zh/docs/integration/spring-boot"},next:{title:"Spring Cloud Gateway",permalink:"/zh/docs/integration/spring-cloud-gateway"}},c={},d=[{value:"\u6b65\u9aa41. \u90e8\u7f72Casdoor",id:"\u6b65\u9aa41-\u90e8\u7f72casdoor",level:2},{value:"\u6b65\u9aa42. \u5bfc\u5165 casdoor-spring-boot-starter",id:"\u6b65\u9aa42-\u5bfc\u5165-casdoor-spring-boot-starter",level:2},{value:"\u6b65\u9aa43. \u670d\u52a1\u53d1\u73b0",id:"\u6b65\u9aa43-\u670d\u52a1\u53d1\u73b0",level:2},{value:"\u4ece\u53d1\u5e03\u4e0b\u8f7d&amp;\u7248\u672c",id:"\u4ece\u53d1\u5e03\u4e0b\u8f7d\u7248\u672c",level:3},{value:"\u542f\u52a8\u670d\u52a1\u5668",id:"\u542f\u52a8\u670d\u52a1\u5668",level:3},{value:"\u5982\u4f55\u4f7f\u7528",id:"\u5982\u4f55\u4f7f\u7528",level:3},{value:"\u6b65\u9aa44. \u914d\u7f6e\u4e2d\u5fc3",id:"\u6b65\u9aa44-\u914d\u7f6e\u4e2d\u5fc3",level:2},{value:"\u4ecb\u7ecd",id:"\u4ecb\u7ecd",level:3},{value:"\u5982\u4f55\u4f7f\u7528",id:"\u5982\u4f55\u4f7f\u7528-1",level:3},{value:"\u6b65\u9aa45. \u91cd\u5b9a\u5411\u5230\u767b\u5f55\u9875\u9762",id:"\u6b65\u9aa45-\u91cd\u5b9a\u5411\u5230\u767b\u5f55\u9875\u9762",level:2},{value:"\u6b65\u9aa46. \u83b7\u53d6 token \u5e76\u89e3\u6790",id:"\u6b65\u9aa46-\u83b7\u53d6-token-\u5e76\u89e3\u6790",level:2},{value:"\u670d\u52a1",id:"\u670d\u52a1",level:2},{value:"\u66f4\u591a\u5185\u5bb9",id:"\u66f4\u591a\u5185\u5bb9",level:2}],u={toc:d};function m(e){var t=e.components,l=(0,a.Z)(e,i);return(0,o.kt)("wrapper",(0,r.Z)({},u,l,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://github.com/casdoor/casdoor-spring-boot-example"},"casdoor-spring-boot-example")," \u662f\u5173\u4e8e\u5982\u4f55\u5728 SpringBoot \u9879\u76ee\u4e2d\u4f7f\u7528 ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/casdoor/casdoor-spring-boot-starter"},"casdoor-spring-boot-starter")," \u7684\u793a\u4f8b\u3002 Spring Cloud \u4e5f\u662f\u5982\u6b64\u3002  \u6211\u4eec\u5c06\u5411\u60a8\u5c55\u793a\u4ee5\u4e0b\u6b65\u9aa4\u3002"),(0,o.kt)("h2",{id:"\u6b65\u9aa41-\u90e8\u7f72casdoor"},"\u6b65\u9aa41. \u90e8\u7f72Casdoor"),(0,o.kt)("p",null,"\u7b2c\u4e00\uff0c\u5e94\u90e8\u7f72Casdoor\u3002"),(0,o.kt)("p",null,"\u60a8\u53ef\u4ee5\u53c2\u8003 ",(0,o.kt)("a",{parentName:"p",href:"/docs/basic/server-installation"},"\u670d\u52a1\u5b89\u88c5")," \u7684 Casdoor \u5b98\u65b9\u6587\u6863\u3002 \u8bf7\u5728 ",(0,o.kt)("strong",{parentName:"p"},"\u751f\u4ea7\u6a21\u5f0f")," \u4e2d\u90e8\u7f72\u60a8\u7684 castor \u5b9e\u4f8b\u3002"),(0,o.kt)("p",null,"\u5728\u6210\u529f\u90e8\u7f72\u540e\uff0c\u60a8\u9700\u8981\u786e\u4fdd\uff1a"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"\u6253\u5f00\u60a8\u6700\u559c\u6b22\u7684\u6d4f\u89c8\u5668\u5e76\u8bbf\u95ee ",(0,o.kt)("strong",{parentName:"li"},"http://localhost:8000"),"\uff0c\u60a8\u5c06\u770b\u5230Casdoor\u7684\u767b\u5f55\u9875\u9762\u3002"),(0,o.kt)("li",{parentName:"ul"},"\u8f93\u5165 ",(0,o.kt)("inlineCode",{parentName:"li"},"admin")," \u548c ",(0,o.kt)("inlineCode",{parentName:"li"},"123")," \u6d4b\u8bd5\u767b\u5f55\u529f\u80fd\u6b63\u5e38\u5de5\u4f5c\u3002")),(0,o.kt)("p",null,"\u7136\u540e\u60a8\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u6b65\u9aa4\u5728\u81ea\u5df1\u7684\u5e94\u7528\u7a0b\u5e8f\u4e2d\u5feb\u901f\u5b9e\u73b0\u57fa\u4e8e Casdoor \u7684\u767b\u5f55\u9875\u9762\u3002"),(0,o.kt)("h2",{id:"\u6b65\u9aa42-\u5bfc\u5165-casdoor-spring-boot-starter"},"\u6b65\u9aa42. \u5bfc\u5165 casdoor-spring-boot-starter"),(0,o.kt)("p",null,"\u60a8\u53ef\u4ee5\u4f7f\u7528 maven \u6216 gradle \u5bfc\u5165 casdoor-spring-boot-starter\u3002"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"\x3c!-- https://mvnrepository.com/artifact/org.casbin/casdoor-spring-boot-starter --\x3e\n<dependency>\n    <groupId>org.casbin</groupId>\n    <artifactId>casdoor-spring-boot-starter</artifactId>\n    <version>1.x.y</version>\n</dependency>\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"// https://mvnrepository.com/artifact/org.casbin/casdoor-spring-boot-starter\nimplementation group: 'org.casbin', name: 'casdoor-spring-boot-starter', version: '1.x.y'\n")),(0,o.kt)("h2",{id:"3"},"\u6b65\u9aa43. \u521d\u59cb\u5316\u914d\u7f6e"),"\u521d\u59cb\u5316\u9700\u8981 6 \u4e2a\u53c2\u6570\uff0c\u5b83\u4eec\u90fd\u662f\u5b57\u7b26\u4e32\u7c7b\u578b\uff1a",(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"\u540d\u79f0(\u6309\u987a\u5e8f\u6392\u5217)"),(0,o.kt)("th",{parentName:"tr",align:null},"\u662f\u5426\u5fc5\u987b"),(0,o.kt)("th",{parentName:"tr",align:null},"\u63cf\u8ff0"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"endpoint"),(0,o.kt)("td",{parentName:"tr",align:null},"\u662f"),(0,o.kt)("td",{parentName:"tr",align:null},"Casdoor \u670d\u52a1URL, \u4f8b\u5982 ",(0,o.kt)("inlineCode",{parentName:"td"},"http://localhost:8000"))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"clientId"),(0,o.kt)("td",{parentName:"tr",align:null},"\u662f"),(0,o.kt)("td",{parentName:"tr",align:null},"\u5ba2\u6237\u7aefID")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"clientSecret"),(0,o.kt)("td",{parentName:"tr",align:null},"\u662f"),(0,o.kt)("td",{parentName:"tr",align:null},"\u5ba2\u6237\u7aef\u79d8\u94a5")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"jwtPublicKey"),(0,o.kt)("td",{parentName:"tr",align:null},"\u662f"),(0,o.kt)("td",{parentName:"tr",align:null},"Casdoor \u5e94\u7528\u7a0b\u5e8f\u8bc1\u4e66\u7684\u516c\u94a5")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"organizationName"),(0,o.kt)("td",{parentName:"tr",align:null},"\u662f"),(0,o.kt)("td",{parentName:"tr",align:null},"\u5e94\u7528\u7a0b\u5e8f\u7ec4\u7ec7")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"applicationName"),(0,o.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,o.kt)("td",{parentName:"tr",align:null},"\u5e94\u7528\u7a0b\u5e8f\u540d\u79f0")))),(0,o.kt)("p",null,"\u60a8\u53ef\u4ee5\u4f7f\u7528 Java properties \u6216 YAML \u6587\u4ef6\u6765\u521d\u59cb\u5316\uff0c\u5982\u4e0b\u6240\u793a\u3002"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-properties"},"casdoor.endpoint = http://localhost:8000\ncasdoor.clientId = <client-id>\ncasdoor.clientSecret = <client-secret>\ncasdoor.jwtSecret = <jwt-public-key>\ncasdoor.organizationName = built-in\ncasdoor.applicationName = app-built-in\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yaml"},"casdoor:\n  endpoint: http://localhost:8000\n  client-id: <client-id>\n  client-secret: <client-secret>\n  jwt-public-key: <jwt-public-key>\n  organization-name: built-in\n  application-name: app-built-in\n")),(0,o.kt)("admonition",{type:"caution"},(0,o.kt)("p",{parentName:"admonition"},"\u60a8\u5e94\u8be5\u7528\u60a8\u81ea\u5df1\u7684 Casdoor \u5b9e\u4f8b\u66ff\u6362\u914d\u7f6e\uff0c\u7279\u522b\u662f ",(0,o.kt)("inlineCode",{parentName:"p"},"clientId"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"clientSecret")," \u548c ",(0,o.kt)("inlineCode",{parentName:"p"},"jwtPublicKey"),"\u3002")),(0,o.kt)("h2",{id:"\u6b65\u9aa43-\u670d\u52a1\u53d1\u73b0"},"\u6b65\u9aa43. \u670d\u52a1\u53d1\u73b0"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"\u4ec0\u4e48\u662f\u6ce8\u518c\u8868")),(0,o.kt)("p",null,"\u6ce8\u518c\u8868\u5728\u5fae\u578b\u670d\u52a1\u9879\u76ee\u4e2d\u53d1\u6325\u7740\u975e\u5e38\u91cd\u8981\u7684\u4f5c\u7528\u3002 \u5b83\u4eec\u662f\u5fae\u578b\u670d\u52a1\u7ed3\u6784\u4e2d\u7684\u94fe\u63a5\uff0c\u7c7b\u4f3c\u4e8e\u8bb0\u5f55\u670d\u52a1\u548c\u670d\u52a1\u5730\u5740\u56fe\u7684\u5730\u5740\u7c3f\u3002 \u5728\u5206\u5e03\u5f0f\u7ed3\u6784\u4e2d\uff0c\u670d\u52a1\u5728\u8fd9\u91cc\u6ce8\u518c\u3002 \u5e76\u4e14\u5f53\u67d0\u4e2a\u670d\u52a1\u9700\u8981\u8c03\u7528\u53e6\u4e00\u4e2a\u670d\u52a1\u65f6\uff0c\u5b83\u4f1a\u627e\u5230\u670d\u52a1\u7684\u5730\u5740\u5e76\u8c03\u7528\u3002"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"\u4e3a\u4ec0\u4e48\u4f7f\u7528\u6ce8\u518c\u8868")),(0,o.kt)("p",null,"\u6ce8\u518c\u8868\u8d1f\u8d23\u5904\u7406\u670d\u52a1\u53d1\u73b0\u7684\u95ee\u9898\u3002 \u5728\u6ca1\u6709\u6ce8\u518c\u8868\u7684\u60c5\u51b5\u4e0b\uff0c\u670d\u52a1\u4e4b\u95f4\u8c03\u7528\u9700\u8981\u77e5\u9053\u6240\u79f0\u65b9\u7684\u5730\u5740\u6216\u4ee3\u7406\u5730\u5740\u3002 \u5f53\u670d\u52a1\u66f4\u6539\u5176\u90e8\u7f72\u5730\u5740\u65f6\uff0c\u5b83\u5fc5\u987b\u66f4\u6539\u8c03\u7528\u4e2d\u6307\u5b9a\u7684\u5730\u5740\u6216\u6539\u53d8\u4ee3\u7406\u914d\u7f6e\u3002 \u5728\u6ce8\u518c\u8868\u4e2d\uff0c\u6bcf\u4e2a\u670d\u52a1\u53ea\u9700\u8981\u5728\u547c\u53eb\u4ed6\u4eba\u65f6\u77e5\u9053\u670d\u52a1\u540d\uff0c\u5e76\u4e14\u5730\u5740\u5c06\u901a\u8fc7\u6ce8\u518c\u8868\u540c\u6b65\u3002"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Nacos\u670d\u52a1\u53d1\u73b0"),(0,o.kt)("p",{parentName:"li"},"Nacos\u662f\u4e00\u4e2a\u6613\u4e8e\u4f7f\u7528\u7684\u52a8\u6001\u670d\u52a1\u53d1\u73b0\u3001\u914d\u7f6e\u548c\u670d\u52a1\u7ba1\u7406\u5e73\u53f0\uff0c\u7528\u4e8e\u6784\u5efa\u4e91\u7aef\u672c\u5730\u5e94\u7528\u7a0b\u5e8f\u3002"))),(0,o.kt)("h3",{id:"\u4ece\u53d1\u5e03\u4e0b\u8f7d\u7248\u672c"},"\u4ece\u53d1\u5e03\u4e0b\u8f7d&\u7248\u672c"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"\u4e0b\u8f7d")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"1) \u4eceGithub\u4e0b\u8f7d\u6e90\u4ee3\u7801")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"git clone https://github.com/alibaba/nacos.git\ncd nacos/\nmvn -Prelease-nacos -Dmaven.test.skip=true clean install -U \nls -al distribution/target/\n\n// change the $version to your actual path\ncd distribution/target/nacos-server-$version/nacos/bin\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"2) \u4e0b\u8f7d\u8fd0\u884c\u7684\u5305")),(0,o.kt)("p",null,"\u4e0b\u8f7d nacos-server-$version.zip form ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/alibaba/nacos/releases"},"https://github.com/alibaba/nacos/releases"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"unzip nacos-server-$version.zip or tar -xvf nacos-server-$version.tar.gz\n  cd nacos/bin\n")),(0,o.kt)("h3",{id:"\u542f\u52a8\u670d\u52a1\u5668"},"\u542f\u52a8\u670d\u52a1\u5668"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Linux/Unix/Mac"),(0,o.kt)("p",{parentName:"li"},"\u8fd0\u884c\u4e0b\u9762\u7684\u547d\u4ee4\u4ee5\u542f\u52a8(\u72ec\u7acb\u8868\u793a\u975e\u96c6\u7fa4\u6a21\u5f0f)\uff1a"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"sh startup.sh -m standalone\n")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Windows")),(0,o.kt)("p",null,"\u8f6c\u5230nacos/bin \u76ee\u5f55\uff0c\u8fd0\u884c\u4e0b\u9762\u7684\u547d\u4ee4\u6765\u542f\u52a8(\u72ec\u7acb\u8868\u793a\u975e\u96c6\u7fa4\u6a21\u5f0f)\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"startup.cmd -m standalone\n")),(0,o.kt)("p",null,"Nacosprovide \u4e00\u4e2a\u89c6\u89c9\u64cd\u4f5c\u5e73\u53f0\uff0c\u542f\u52a8\u670d\u52a1\u5668\uff0c\u6253\u5f00\u60a8\u6700\u559c\u6b22\u7684\u6d4f\u89c8\u5668\u5e76\u8bbf\u95ee http://localhost:8848/nacos \uff0c\u9ed8\u8ba4\u7528\u6237\u540d\u548c\u5bc6\u7801\u662f ",(0,o.kt)("inlineCode",{parentName:"p"},"nacos"),"\u3002"),(0,o.kt)("h3",{id:"\u5982\u4f55\u4f7f\u7528"},"\u5982\u4f55\u4f7f\u7528"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"\u6dfb\u52a0\u4f9d\u8d56\u5173\u7cfb")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"<dependency>\n    <groupId>com.alibaba.cloud</groupId>\n    <artifactId>spring-cloud-starter-alibaba-nacos-discovery</artifactId>\n</dependency>\n")),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},"\u6dfb\u52a0 Nacos \u914d\u7f6e")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"spring:\n  application:\n    name: casdoor-service\n  cloud:\n    nacos:\n      discovery:\n        server-addr: 127.0.0.1:8848\n")),(0,o.kt)("ol",{start:3},(0,o.kt)("li",{parentName:"ol"},"\u901a\u8fc7\u6dfb\u52a0 @EnableDiscoveryClient ",(0,o.kt)("img",{alt:"springcloud.png",src:n(82955).Z,width:"1072",height:"345"})," \u542f\u52a8\u670d\u52a1\u5668\u6765\u542f\u7528\u670d\u52a1\u53d1\u73b0\u3002\u67e5\u770bNacos \u63a7\u5236\u53f0\u7684\u670d\u52a1\u5217\u8868 ",(0,o.kt)("img",{alt:"springcloud_1.png",src:n(973).Z,width:"1859",height:"914"}))),(0,o.kt)("h2",{id:"\u6b65\u9aa44-\u914d\u7f6e\u4e2d\u5fc3"},"\u6b65\u9aa44. \u914d\u7f6e\u4e2d\u5fc3"),(0,o.kt)("p",null,"\u60a8\u4e5f\u53ef\u4ee5\u4f7f\u7528 nacos \u914d\u7f6e\uff0c\u5728\u914d\u7f6e\u4e2d\u5fc3\u653e\u7f6e\u8fd9\u4e9b casdoor \u914d\u7f6e"),(0,o.kt)("h3",{id:"\u4ecb\u7ecd"},"\u4ecb\u7ecd"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u4ec0\u4e48\u662f\u914d\u7f6e\u4e2d\u5fc3\uff1f"),(0,o.kt)("p",{parentName:"li"},"\u5728\u5fae\u578b\u670d\u52a1\u7ed3\u6784\u4e2d\uff0c\u5f53\u7cfb\u7edf\u4ece\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f\u5206\u6210\u4e00\u4e2a\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e0a\u7684\u670d\u52a1\u8282\u70b9\u65f6\uff0c \u914d\u7f6e\u6587\u4ef6\u5fc5\u987b\u8fc1\u79fb(\u62c6\u5206)\uff0c\u4ee5\u4fbf\u5206\u6563\u914d\u7f6e\uff0c\u6743\u529b\u4e0b\u653e\u5219\u662f\u591a\u4f59\u7684\u3002 \u4e00\u822c\u6765\u8bf4\uff0c\u4e00\u4e2a\u914d\u7f6e\u4e2d\u5fc3\u662f\u4e00\u4e2a\u57fa\u672c\u7684\u670d\u52a1\u7ec4\u6210\u90e8\u5206\uff0c\u8d1f\u8d23\u96c6\u4e2d\u7ba1\u7406\u5404\u79cd\u5e94\u7528\u7a0b\u5e8f\u7684\u914d\u7f6e\u3002")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u4e3a\u4ec0\u4e48\u8981\u4f7f\u7528\u914d\u7f6e\u4e2d\u5fc3\uff1f"),(0,o.kt)("p",{parentName:"li"},"\u914d\u7f6e\u4e2d\u5fc3\u5c06\u914d\u7f6e\u4e0e\u5e94\u7528\u7a0b\u5e8f\u5206\u5f00\uff0c\u5e76\u4ee5\u7edf\u4e00\u7684\u65b9\u5f0f\u7ba1\u7406\u914d\u7f6e\u3002 \u5e94\u7528\u7a0b\u5e8f\u4e0d\u9700\u8981\u7ba1\u7406\u914d\u7f6e\u672c\u8eab\u3002")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Nacos \u914d\u7f6e\u4e2d\u5fc3"),(0,o.kt)("p",{parentName:"li"},"Nacos\u662f\u522b\u5885\u7684\u5f00\u653e\u6e90\u7801\u5e73\u53f0\uff0c\u7528\u4e8e\u52a8\u6001\u670d\u52a1\u53d1\u73b0\u3001\u914d\u7f6e\u7ba1\u7406\u548c\u670d\u52a1\u7ba1\u7406\uff0c\u8fd9\u79cd\u5e73\u53f0\u66f4\u5bb9\u6613\u6784\u5efa\u4e91\u7aef\u539f\u751f\u5e94\u7528\u3002"))),(0,o.kt)("h3",{id:"\u5982\u4f55\u4f7f\u7528-1"},"\u5982\u4f55\u4f7f\u7528"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"\u6dfb\u52a0\u4f9d\u8d56\u5173\u7cfb")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"<dependency>\n    <groupId>com.alibaba.cloud</groupId>\n    <artifactId>spring-cloud-starter-alibaba-nacos-config</artifactId>\n</dependency>\n")),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},"\u5728 ",(0,o.kt)("inlineCode",{parentName:"li"},"bootstrap.yml \u4e2d\u6dfb\u52a0 Nacos \u914d\u7f6e"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-spring:"},"  application:\n    name: casdoor-service\n  profiles:\n    active: dev\n  cloud:\n    nacos:\n      config:\n        server-addr: 127.0.0.1:8848\n        file-extension: yaml\n")),(0,o.kt)("p",null,"\u914d\u7f6e\u6587\u4ef6\u52a0\u8f7d\u4f18\u5148\u7ea7(\u4ece\u6700\u9ad8\u5230\u4f4e) ",(0,o.kt)("inlineCode",{parentName:"p"},"bootstrap.properties ->bootstrap.yml -> application.properties -> application.yml"),"\n3. \u901a\u8fc7\u6dfb\u52a0 @EnableDiscoveryClient ",(0,o.kt)("img",{alt:"springcloud.png",src:n(82955).Z,width:"1072",height:"345"})," \u5c06\u914d\u7f6e\u6dfb\u52a0\u5230\u914d\u7f6e\u4e2d\u5fc3 (Data Id) \u6765\u542f\u7528\u670d\u52a1\u53d1\u73b0 ",(0,o.kt)("img",{alt:"springcloud_2.png",src:n(70573).Z,width:"1863",height:"905"})," ",(0,o.kt)("img",{alt:"springcloud_3.png",src:n(96963).Z,width:"1850",height:"903"})),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"  \u5728 Nacos Spring Cloud\uff0c `dataId` \u7684\u683c\u5f0f\u5982\u4e0b\uff1a `${prefix}-${spring.profiles.active}\u3002${file-extension}`\n")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"prefix")," \u9ed8\u8ba4\u662f ",(0,o.kt)("inlineCode",{parentName:"li"},"spring.application.name")," \u7684\u503c\u3002 \u60a8\u4e5f\u53ef\u4ee5\u5728 ",(0,o.kt)("inlineCode",{parentName:"li"},"spring.cloud.nacos.config.prefix")," \u4e2d\u914d\u7f6e\u6b64\u503c\u3002"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"spring.profiles.activity")," \u662f\u5f53\u524d\u73af\u5883\u7684\u914d\u7f6e\u6587\u4ef6\u3002"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"file-exetension")," \u662f\u914d\u7f6e\u5185\u5bb9\u7684\u6570\u636e\u683c\u5f0f\uff0c\u53ef\u4ee5\u5728 ",(0,o.kt)("inlineCode",{parentName:"li"},"spring.cloud.nacos.config.file-extension")," \u4e2d\u8fdb\u884c\u914d\u7f6e\u3002")),(0,o.kt)("p",null,"\u6211\u4eec\u53ef\u4ee5\u5c06\u6211\u4eec\u7684 ",(0,o.kt)("inlineCode",{parentName:"p"},"dataId")," \u5339\u914d\u4e3a  ",(0,o.kt)("inlineCode",{parentName:"p"},"casdo-service-dev.properties"),",\u914d\u7f6e\u683c\u5f0f\u662f ",(0,o.kt)("inlineCode",{parentName:"p"},"properties"),","),(0,o.kt)("p",null,"\u914d\u7f6e\u5185\u5bb9\u662f ",(0,o.kt)("a",{parentName:"p",href:"#3"},"\u7b2c3\u6b65"),"\u7684\u914d\u7f6e\uff0c \u8fd9\u6837 ",(0,o.kt)("a",{parentName:"p",href:"#3"},"\u6b65\u9aa4 3")," \u7684\u914d\u7f6e\u6587\u4ef6\u53ef\u4ee5\u653e\u7f6e\u5230 nacos \u914d\u7f6e\u4e2d\u5fc3\u3002"),(0,o.kt)("h2",{id:"\u6b65\u9aa45-\u91cd\u5b9a\u5411\u5230\u767b\u5f55\u9875\u9762"},"\u6b65\u9aa45. \u91cd\u5b9a\u5411\u5230\u767b\u5f55\u9875\u9762"),(0,o.kt)("p",null,"\u5f53\u60a8\u9700\u8981\u8bbf\u95ee\u60a8\u7684\u5e94\u7528\u7a0b\u5e8f\u7684\u8eab\u4efd\u9a8c\u8bc1\u65f6\uff0c\u60a8\u53ef\u4ee5\u53d1\u9001\u76ee\u6807 url \u5e76\u91cd\u5b9a\u5411\u5230 Casdoor \u63d0\u4f9b\u7684\u767b\u5f55\u9875\u9762\u3002"),(0,o.kt)("p",null,"\u8bf7\u786e\u4fdd\u60a8\u5df2\u63d0\u524d\u5728\u5e94\u7528\u914d\u7f6e\u4e2d\u6dfb\u52a0\u56de\u8c03 url(\u4f8b\u5982 ",(0,o.kt)("strong",{parentName:"p"},"http://localhost:8080/login"),")\u3002"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},'@Resource\nprivate CasdoorAuthService casdoorAuthService;\n\n@RequestMapping("toLogin")\npublic String toLogin() {\n    return "redirect:" + casdoorAuthService.getSigninUrl("http://localhost:8080/login");\n}\n')),(0,o.kt)("h2",{id:"\u6b65\u9aa46-\u83b7\u53d6-token-\u5e76\u89e3\u6790"},"\u6b65\u9aa46. \u83b7\u53d6 token \u5e76\u89e3\u6790"),(0,o.kt)("p",null,"\u5728 Casdoor \u9a8c\u8bc1\u901a\u8fc7\u540e\uff0c\u5b83\u5c06\u88ab\u91cd\u5b9a\u5411\u5230\u60a8\u7684\u5e94\u7528\u7a0b\u5e8f\uff0c\u5e76\u5e26\u6709 code \u548c\u72b6\u6001\u3002"),(0,o.kt)("p",null,"\u60a8\u53ef\u4ee5\u83b7\u53d6 code \u5e76\u8c03\u7528 ",(0,o.kt)("inlineCode",{parentName:"p"},"getOAuthToken")," \u65b9\u6cd5\uff0c\u7136\u540e\u89e3\u6790\u51fa jwt \u4ee4\u724c\u3002"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"CasdoorUser")," \u5305\u542b\u4e86 Casdoor \u63d0\u4f9b\u7684\u7528\u6237\u57fa\u672c\u4fe1\u606f\uff0c\u60a8\u53ef\u4ee5\u5c06\u5176\u4f5c\u4e3a\u5173\u952e\u5b57\u5728\u60a8\u7684\u5e94\u7528\u7a0b\u5e8f\u4e2d\u8bbe\u7f6e\u4f1a\u8bdd\u3002"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},'@RequestMapping("login")\npublic String login(String code, String state, HttpServletRequest request) {\n    String token = "";\n    CasdoorUser user = null;\n    try {\n        token = casdoorAuthService.getOAuthToken(code, state);\n        user = casdoorAuthService.parseJwtToken(token);\n    } catch (CasdoorAuthException e) {\n        e.printStackTrace();\n    }\n    HttpSession session = request.getSession();\n    session.setAttribute("casdoorUser", user);\n    return "redirect:/";\n}\n')),(0,o.kt)("h2",{id:"\u670d\u52a1"},"\u670d\u52a1"),(0,o.kt)("p",null,"\u8fd9\u4e24\u79cd\u60c5\u51b5\u7684\u793a\u4f8b\u5982\u4e0b\u6240\u793a:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"CasdoorAuthService",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},'String token = casdoorAuthService.getOAuthToken(code, "app-built-in");')),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"CasdoorUser casdoorUser = casdoorAuthService.parseJwtToken(token);")))),(0,o.kt)("li",{parentName:"ul"},"CasdoorUserService",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},'CasdoorUser casdoorUser = casdoorUserService.getUser("admin");')),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},'CasdoorUser casdoorUser = casdoorUserService.getUserByEmail("admin@example.com");')),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"CasdoorUser[] casdoorUsers = casdoorUserService.getUsers();")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},'CasdoorUser[] casdoorUsers = casdoorUserService.getSortedUsers("created_time", 5);')),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},'int count = casdoorUserService.getUserCount("0");')),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"CasdoorResponse response = casdoorUserService.addUser(user);")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"CasdoorResponse response = casdoorUserService.updateUser(user);")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"CasdoorResponse response = casdoorUserService.deleteUser(user);")))),(0,o.kt)("li",{parentName:"ul"},"CasdoorEmailService",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"CasdoorResponse response = casdoorEmailService.sendEmail(title, content, sender, receiver);")))),(0,o.kt)("li",{parentName:"ul"},"CasdoorSmsService",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"CasdoorResponse response = casdoorSmsService.sendSms(randomCode(), receiver);")))),(0,o.kt)("li",{parentName:"ul"},"CasdoorResourceService",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"CasdoorResponse response = casdoorResourceService.uploadResource(user, tag, parent, fullFilePath, file);")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"CasdoorResponse response = casdoorResourceService.deleteResource(file.getName());"))))),(0,o.kt)("h2",{id:"\u66f4\u591a\u5185\u5bb9"},"\u66f4\u591a\u5185\u5bb9"),(0,o.kt)("p",null,"\u60a8\u53ef\u4ee5\u63a2\u7d22\u4ee5\u4e0b\u9879\u76ee/\u6587\u4ef6\u6765\u4e86\u89e3\u66f4\u591a\u5173\u4e8eJava \u4e0eCasdoor\u4e00\u4f53\u5316\u7684\u4fe1\u606f\u3002"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/casdoor/casdoor-java-sdk"},"casdoor-java-sdk")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/casdoor/casdoor-spring-boot-starter"},"casdoor-spring-boot-starter")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/casdoor/casdoor-spring-boot-example"},"casdoor-spring-boot-example")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://casdoor.org/docs/integration/spring-security"},"casdoor-spring-boot-security-example")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/casdoor/casdoor-spring-boot-shiro-example"},"casdoor-spring-boot-shiro-example"))))}m.isMDXComponent=!0},82955:function(e,t,n){t.Z=n.p+"assets/images/springcloud-f6f38bfad8b15a89d673b597f7d62b9b.png"},973:function(e,t,n){t.Z=n.p+"assets/images/springcloud_1-9d372050e7020303c2f5ff0281b486af.png"},70573:function(e,t,n){t.Z=n.p+"assets/images/springcloud_2-386c5b6553563423efcc1e2f6c4f27b8.png"},96963:function(e,t,n){t.Z=n.p+"assets/images/springcloud_3-f6a518fb05ce396acc87593d32ae9fe4.png"}}]);