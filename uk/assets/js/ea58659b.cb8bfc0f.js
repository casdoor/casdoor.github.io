"use strict";(self.webpackChunkcasdoor_website=self.webpackChunkcasdoor_website||[]).push([[6252],{3905:(e,t,a)=>{a.d(t,{Zo:()=>u,kt:()=>c});var i=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function n(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?n(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,i,r=function(e,t){if(null==e)return{};var a,i,r={},n=Object.keys(e);for(i=0;i<n.length;i++)a=n[i],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(i=0;i<n.length;i++)a=n[i],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var p=i.createContext({}),s=function(e){var t=i.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},u=function(e){var t=s(e.components);return i.createElement(p.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},d=i.forwardRef((function(e,t){var a=e.components,r=e.mdxType,n=e.originalType,p=e.parentName,u=o(e,["components","mdxType","originalType","parentName"]),d=s(a),c=r,k=d["".concat(p,".").concat(c)]||d[c]||m[c]||n;return a?i.createElement(k,l(l({ref:t},u),{},{components:a})):i.createElement(k,l({ref:t},u))}));function c(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var n=a.length,l=new Array(n);l[0]=d;var o={};for(var p in t)hasOwnProperty.call(t,p)&&(o[p]=t[p]);o.originalType=e,o.mdxType="string"==typeof e?e:r,l[1]=o;for(var s=2;s<n;s++)l[s]=a[s];return i.createElement.apply(null,l)}return i.createElement.apply(null,a)}d.displayName="MDXCreateElement"},27076:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>p,contentTitle:()=>l,default:()=>m,frontMatter:()=>n,metadata:()=>o,toc:()=>s});var i=a(87462),r=(a(67294),a(3905));const n={title:"User Mapping",description:"Map OAuth provider claims to Casdoor user fields",keywords:["OAuth","user mapping","claims","IDP","identity provider"],authors:["nomeguy"]},l=void 0,o={unversionedId:"provider/oauth/user-mapping",id:"provider/oauth/user-mapping",title:"User Mapping",description:"Map OAuth provider claims to Casdoor user fields",source:"@site/i18n/uk/docusaurus-plugin-content-docs/current/provider/oauth/user-mapping.md",sourceDirName:"provider/oauth",slug:"/provider/oauth/user-mapping",permalink:"/uk/docs/provider/oauth/user-mapping",draft:!1,editUrl:"https://github.com/casdoor/casdoor-website/edit/master/docs/provider/oauth/user-mapping.md",tags:[],version:"current",frontMatter:{title:"User Mapping",description:"Map OAuth provider claims to Casdoor user fields",keywords:["OAuth","user mapping","claims","IDP","identity provider"],authors:["nomeguy"]},sidebar:"tutorialSidebar",previous:{title:"\u041e\u0433\u043b\u044f\u0434",permalink:"/uk/docs/provider/oauth/overview"},next:{title:"Google",permalink:"/uk/docs/provider/oauth/google"}},p={},s=[{value:"Supported Fields",id:"supported-fields",level:2},{value:"Configuration",id:"configuration",level:2},{value:"Provider-Specific Examples",id:"provider-specific-examples",level:2},{value:"Okta",id:"okta",level:3},{value:"Azure AD B2C",id:"azure-ad-b2c",level:3},{value:"Generic OAuth Providers",id:"generic-oauth-providers",level:3},{value:"Behavior",id:"behavior",level:2},{value:"Common Scenarios",id:"common-scenarios",level:2},{value:"Enterprise SSO",id:"enterprise-sso",level:3},{value:"Social Login Enhancement",id:"social-login-enhancement",level:3},{value:"Multi-Provider Setup",id:"multi-provider-setup",level:3},{value:"Technical Details",id:"technical-details",level:2}],u={toc:s};function m(e){let{components:t,...a}=e;return(0,r.kt)("wrapper",(0,i.Z)({},u,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"When users sign in through OAuth providers, Casdoor automatically captures their basic profile information like username, email, and avatar. However, identity providers often return additional claims in their OAuth responses that contain valuable user data. The User Mapping feature allows you to map these extra claims to specific user profile fields in Casdoor."),(0,r.kt)("h2",{id:"supported-fields"},"Supported Fields"),(0,r.kt)("p",null,"You can map OAuth provider claims to the following user fields:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"phone")," - Phone number"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"countryCode")," - Country calling code"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"firstName")," - First name"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"lastName")," - Last name"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"region")," - Geographic region"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"location")," - Full location or address"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"affiliation")," - Organization or company affiliation"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"title")," - Job title or position"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"homepage")," - Personal website URL"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"bio")," - Biography or description"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"tag")," - Custom tag or category"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"language")," - Preferred language"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"gender")," - Gender identity"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"birthday")," - Date of birth"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"education")," - Educational background"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"idCard")," - ID card number"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"idCardType")," - Type of ID card")),(0,r.kt)("p",null,"Standard fields (id, username, displayName, email, avatarUrl) are handled automatically and don't need mapping configuration."),(0,r.kt)("h2",{id:"configuration"},"Configuration"),(0,r.kt)("p",null,"To configure user mapping for an OAuth provider:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Navigate to ",(0,r.kt)("strong",{parentName:"li"},"Providers")," in the top menu"),(0,r.kt)("li",{parentName:"ol"},"Select or create an OAuth provider (e.g., Okta, Azure AD B2C, Google)"),(0,r.kt)("li",{parentName:"ol"},"Scroll to the ",(0,r.kt)("strong",{parentName:"li"},"User mapping")," section"),(0,r.kt)("li",{parentName:"ol"},"Add mappings by specifying:",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"User field"),": The Casdoor user field you want to populate"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Claim name"),": The exact claim name from your OAuth provider's response")))),(0,r.kt)("p",null,"For example, if your identity provider returns a claim named ",(0,r.kt)("inlineCode",{parentName:"p"},"given_name")," and you want to map it to the user's first name in Casdoor:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"User field: ",(0,r.kt)("inlineCode",{parentName:"li"},"firstName")),(0,r.kt)("li",{parentName:"ul"},"Claim name: ",(0,r.kt)("inlineCode",{parentName:"li"},"given_name"))),(0,r.kt)("h2",{id:"provider-specific-examples"},"Provider-Specific Examples"),(0,r.kt)("h3",{id:"okta"},"Okta"),(0,r.kt)("p",null,"Okta returns claims like ",(0,r.kt)("inlineCode",{parentName:"p"},"given_name"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"family_name"),", and ",(0,r.kt)("inlineCode",{parentName:"p"},"locale"),". You might configure:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"firstName")," \u2192 ",(0,r.kt)("inlineCode",{parentName:"li"},"given_name")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"lastName")," \u2192 ",(0,r.kt)("inlineCode",{parentName:"li"},"family_name")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"language")," \u2192 ",(0,r.kt)("inlineCode",{parentName:"li"},"locale"))),(0,r.kt)("h3",{id:"azure-ad-b2c"},"Azure AD B2C"),(0,r.kt)("p",null,"Azure AD B2C can return custom claims configured in your user flows. For instance:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"phone")," \u2192 ",(0,r.kt)("inlineCode",{parentName:"li"},"extension_PhoneNumber")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"title")," \u2192 ",(0,r.kt)("inlineCode",{parentName:"li"},"jobTitle")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"location")," \u2192 ",(0,r.kt)("inlineCode",{parentName:"li"},"city"))),(0,r.kt)("h3",{id:"generic-oauth-providers"},"Generic OAuth Providers"),(0,r.kt)("p",null,"Most OAuth providers following standard protocols return claims in their userinfo endpoint. Check your provider's documentation to find available claim names."),(0,r.kt)("h2",{id:"behavior"},"Behavior"),(0,r.kt)("p",null,"The mapping works with these characteristics:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Non-destructive"),": Existing user field values are preserved. Mapping only updates empty fields."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Automatic sync"),": When users sign in via OAuth, the mapping is applied automatically."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Flexible"),": Each provider can have its own unique mapping configuration."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Extra claims"),": All claims from the provider are stored in the user's extra data, even if not explicitly mapped.")),(0,r.kt)("h2",{id:"common-scenarios"},"Common Scenarios"),(0,r.kt)("h3",{id:"enterprise-sso"},"Enterprise SSO"),(0,r.kt)("p",null,"When integrating with enterprise identity providers like Okta or Azure AD, you often want to sync organizational data:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"title \u2192 jobTitle\naffiliation \u2192 companyName\nregion \u2192 officeLocation\n")),(0,r.kt)("h3",{id:"social-login-enhancement"},"Social Login Enhancement"),(0,r.kt)("p",null,"Social providers like Google or Facebook provide basic profile data, but you can capture additional details:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"location \u2192 location\nhomepage \u2192 website\nbio \u2192 about_me\n")),(0,r.kt)("h3",{id:"multi-provider-setup"},"Multi-Provider Setup"),(0,r.kt)("p",null,"Different providers may use different claim names for the same data. Configure each provider independently:"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Google OAuth"),":"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"firstName")," \u2192 ",(0,r.kt)("inlineCode",{parentName:"li"},"given_name")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"lastName")," \u2192 ",(0,r.kt)("inlineCode",{parentName:"li"},"family_name"))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"GitHub OAuth"),":"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"location")," \u2192 ",(0,r.kt)("inlineCode",{parentName:"li"},"location")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"homepage")," \u2192 ",(0,r.kt)("inlineCode",{parentName:"li"},"blog")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"bio")," \u2192 ",(0,r.kt)("inlineCode",{parentName:"li"},"bio"))),(0,r.kt)("h2",{id:"technical-details"},"Technical Details"),(0,r.kt)("p",null,"When a user authenticates through OAuth:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Casdoor receives the OAuth token and fetches user info from the provider"),(0,r.kt)("li",{parentName:"ol"},"The provider response includes standard fields plus extra claims"),(0,r.kt)("li",{parentName:"ol"},"Standard fields (username, email, etc.) are processed first"),(0,r.kt)("li",{parentName:"ol"},"User mapping rules are applied to populate additional fields from extra claims"),(0,r.kt)("li",{parentName:"ol"},"All raw claims are stored in the user's OAuth extra data for reference")),(0,r.kt)("p",null,"This ensures that user profiles in Casdoor stay synchronized with your identity provider while maintaining flexibility in how data is structured."))}m.isMDXComponent=!0}}]);