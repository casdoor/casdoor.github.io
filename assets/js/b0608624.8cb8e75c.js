"use strict";(self.webpackChunkcasdoor_website=self.webpackChunkcasdoor_website||[]).push([[1156],{81622:(t,e,a)=>{a.r(e),a.d(e,{assets:()=>l,contentTitle:()=>s,default:()=>c,frontMatter:()=>r,metadata:()=>i,toc:()=>d});var n=a(87462),o=(a(67294),a(3905));a(61839);const r={title:"Casdoor SDK",description:"Using Casdoor SDK instead of standard OIDC protocol",keywords:["SDK","Frontend","Backend"]},s=void 0,i={unversionedId:"how-to-connect/sdk",id:"how-to-connect/sdk",title:"Casdoor SDK",description:"Using Casdoor SDK instead of standard OIDC protocol",source:"@site/docs/how-to-connect/sdk.md",sourceDirName:"how-to-connect",slug:"/how-to-connect/sdk",permalink:"/docs/how-to-connect/sdk",draft:!1,editUrl:"https://github.com/casdoor/casdoor-website/edit/master/docs/how-to-connect/sdk.md",tags:[],version:"current",lastUpdatedBy:"yoyo314",lastUpdatedAt:1665238617,formattedLastUpdatedAt:"Oct 8, 2022",frontMatter:{title:"Casdoor SDK",description:"Using Casdoor SDK instead of standard OIDC protocol",keywords:["SDK","Frontend","Backend"]},sidebar:"tutorialSidebar",previous:{title:"Standard OIDC Client",permalink:"/docs/how-to-connect/oidc-client"},next:{title:"How to Enable Single Sign-On",permalink:"/docs/how-to-connect/single-sign-on"}},l={},d=[{value:"Introduction",id:"introduction",level:2},{value:"How to use Casdoor SDK?",id:"how-to-use-casdoor-sdk",level:2},{value:"1. Backend SDK configuration",id:"1-backend-sdk-configuration",level:3},{value:"2. Frontend configuration",id:"2-frontend-configuration",level:3},{value:"3. Get login URLs",id:"3-get-login-urls",level:3},{value:"4. Get and verify access token",id:"4-get-and-verify-access-token",level:3},{value:"4. Identify user with access token",id:"4-identify-user-with-access-token",level:3},{value:"Session",id:"session",level:4},{value:"JWT",id:"jwt",level:4},{value:"5. <strong>(Optional)</strong> Interact with the User table",id:"5-optional-interact-with-the-user-table",level:3}],p={toc:d};function c(t){let{components:e,...r}=t;return(0,o.kt)("wrapper",(0,n.Z)({},p,r,{components:e,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"introduction"},"Introduction"),(0,o.kt)("p",null,"Compared to the standard OIDC protocol, Casdoor provides more functionalities in its SDK, like user management, resource uploading, etc. Connecting to Casdoor via Casdoor SDK costs more time than using a standard OIDC client library but will provide the best flexibility and the most powerful API."),(0,o.kt)("p",null,"Casdoor SDKs can be divided into two categories:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"Frontend SDK"),": Like Javascript SDK, Vue SDK for websites, Android or iOS SDKs for Apps, etc. Casdoor supports providing authentication for both websites and mobile Apps."),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"Backend SDK"),": SDKs for backend languages like Go, Java, Node.js, Python, PHP, etc.")),(0,o.kt)("admonition",{type:"tip"},(0,o.kt)("p",{parentName:"admonition"},"If your website is developed in a frontend and backend separated manner, then you can use the Javascript\nSDK: ",(0,o.kt)("inlineCode",{parentName:"p"},"casdoor-js-sdk")," or React SDK: ",(0,o.kt)("inlineCode",{parentName:"p"},"casdoor-react-sdk")," or Vue SDK: ",(0,o.kt)("inlineCode",{parentName:"p"},"casdoor-vue-sdk")," to integrate Casdoor in frontend. If your web application is a traditional website developed by JSP or PHP, you can just use the backend SDKs only. See an example: ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/casdoor/casdoor-python-vue-sdk-example"},"casdoor-python-vue-sdk-example"))),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Frontend SDK"),(0,o.kt)("th",{parentName:"tr",align:null},"Description"),(0,o.kt)("th",{parentName:"tr",align:null},"SDK code"),(0,o.kt)("th",{parentName:"tr",align:null},"Example code"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"Javascript SDK"),(0,o.kt)("td",{parentName:"tr",align:null},"For websites"),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"https://github.com/casdoor/casdoor-js-sdk"},"casdoor-js-sdk")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"https://github.com/casbin/casnode"},"Casnode"),", ",(0,o.kt)("a",{parentName:"td",href:"https://github.com/casbin/casbin-oa"},"Casbin-OA"),", ",(0,o.kt)("a",{parentName:"td",href:"https://github.com/casbin/confita"},"Confita"))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"Android SDK"),(0,o.kt)("td",{parentName:"tr",align:null},"For Android apps"),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"https://github.com/casdoor/casdoor-android-sdk"},"casdoor-android-sdk")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"https://github.com/casdoor/casdoor-android-example"},"casdoor-android-example"))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"iOS SDK"),(0,o.kt)("td",{parentName:"tr",align:null},"For iOS apps"),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"https://github.com/casdoor/casdoor-ios-sdk"},"casdoor-ios-sdk")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"https://github.com/casdoor/casdoor-ios-example"},"casdoor-ios-example"))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"Electron SDK"),(0,o.kt)("td",{parentName:"tr",align:null},"For Electron apps"),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"https://github.com/casdoor/casdoor-js-sdk"},"casdoor-js-sdk")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"https://github.com/casdoor/casdoor-electron-example"},"casdoor-electron-example"))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},".NET Desktop SDK"),(0,o.kt)("td",{parentName:"tr",align:null},"For .NET desktop apps"),(0,o.kt)("td",{parentName:"tr",align:null}),(0,o.kt)("td",{parentName:"tr",align:null},"WPF: ",(0,o.kt)("a",{parentName:"td",href:"https://github.com/casdoor/casdoor-dotnet-desktop-example"},"casdoor-dotnet-desktop-example"),", WinForms: ",(0,o.kt)("a",{parentName:"td",href:"https://github.com/casdoor/casdoor-dotnet-winform-example"},"casdoor-dotnet-winform-example"))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"React SDK"),(0,o.kt)("td",{parentName:"tr",align:null},"For React websites"),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"https://github.com/casdoor/casdoor-react-sdk"},"casdoor-react-sdk")),(0,o.kt)("td",{parentName:"tr",align:null})),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"Vue SDK"),(0,o.kt)("td",{parentName:"tr",align:null},"For Vue websites"),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"https://github.com/casdoor/casdoor-vue-sdk"},"casdoor-vue-sdk")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"https://github.com/casdoor/casdoor-python-vue-sdk-example"},"casdoor-python-vue-sdk-example"))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"Angular SDK"),(0,o.kt)("td",{parentName:"tr",align:null},"For Angular 1.0, 2.0 websites"),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"https://github.com/casdoor/casdoor-angular-sdk"},"casdoor-angular-sdk")),(0,o.kt)("td",{parentName:"tr",align:null})),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"Flutter SDK"),(0,o.kt)("td",{parentName:"tr",align:null},"For Flutter apps"),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"https://github.com/casdoor/casdoor-flutter-sdk"},"casdoor-flutter-sdk")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"https://github.com/casdoor/casdoor-flutter-example"},"casdoor-flutter-example"))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"uni-app SDK"),(0,o.kt)("td",{parentName:"tr",align:null},"For uni-app apps"),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"https://github.com/casdoor/casdoor-uniapp-sdk"},"casdoor-uniapp-sdk")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"https://github.com/casdoor/casdoor-uniapp-example"},"casdoor-uniapp-example"))))),(0,o.kt)("p",null,"Next, use one of the following backend SDKs based on the language of your backend:"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Backend SDK"),(0,o.kt)("th",{parentName:"tr",align:null},"Description"),(0,o.kt)("th",{parentName:"tr",align:null},"Sdk code"),(0,o.kt)("th",{parentName:"tr",align:null},"Example code"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"Go SDK"),(0,o.kt)("td",{parentName:"tr",align:null},"For Go backends"),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"https://github.com/casdoor/casdoor-go-sdk"},"casdoor-go-sdk")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"https://github.com/casbin/casnode"},"Casnode"),", ",(0,o.kt)("a",{parentName:"td",href:"https://github.com/casbin/casbin-oa"},"Casbin-OA"),", ",(0,o.kt)("a",{parentName:"td",href:"https://github.com/casbin/confita"},"Confita"))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"Java SDK"),(0,o.kt)("td",{parentName:"tr",align:null},"For Java backends"),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"https://github.com/casdoor/casdoor-java-sdk"},"casdoor-java-sdk")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"https://github.com/casdoor/casdoor-spring-boot-starter"},"casdoor-spring-boot-starter"),", ",(0,o.kt)("a",{parentName:"td",href:"https://github.com/casdoor/casdoor-spring-boot-example"},"casdoor-spring-boot-example"))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"Node.js SDK"),(0,o.kt)("td",{parentName:"tr",align:null},"For Node.js backends"),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"https://github.com/casdoor/casdoor-nodejs-sdk"},"casdoor-nodejs-sdk")),(0,o.kt)("td",{parentName:"tr",align:null})),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"Python SDK"),(0,o.kt)("td",{parentName:"tr",align:null},"For Python backends"),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"https://github.com/casdoor/casdoor-python-sdk"},"casdoor-python-sdk")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"https://github.com/casdoor/casdoor-python-vue-sdk-example"},"casdoor-python-vue-sdk-example"))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"PHP SDK"),(0,o.kt)("td",{parentName:"tr",align:null},"For PHP backends"),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"https://github.com/casdoor/casdoor-php-sdk"},"casdoor-php-sdk")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"https://github.com/casdoor/wordpress-casdoor-plugin"},"wordpress-casdoor-plugin"))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},".NET SDK"),(0,o.kt)("td",{parentName:"tr",align:null},"For ASP.NET backends"),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"https://github.com/casdoor/casdoor-dotnet-sdk"},"casdoor-dotnet-sdk")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"https://github.com/casdoor/casdoor-dotnet-sdk-example"},"casdoor-dotnet-sdk-example"))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"Rust SDK"),(0,o.kt)("td",{parentName:"tr",align:null},"For Rust backends"),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"https://github.com/casdoor/casdoor-rust-sdk"},"casdoor-rust-sdk")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"https://github.com/casdoor/casdoor-rust-example"},"casdoor-rust-example"))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"Dart SDK"),(0,o.kt)("td",{parentName:"tr",align:null},"For Dart backends"),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"https://github.com/casdoor/casdoor-dart-sdk"},"casdoor-dart-sdk")),(0,o.kt)("td",{parentName:"tr",align:null})),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"Cpp SDK"),(0,o.kt)("td",{parentName:"tr",align:null},"For Cpp backends"),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"https://github.com/casdoor/casdoor-cpp-sdk"},"casdoor-cpp-sdk")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"https://github.com/casdoor/casdoor-cpp-qt-example"},"casdoor-cpp-qt-example"))))),(0,o.kt)("p",null,"For a full list of the official Casdoor SDKs, please see: ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/casdoor?q=sdk&type=all&language=&sort="},"https://github.com/casdoor?q=sdk&type=all&language=&sort=")),(0,o.kt)("h2",{id:"how-to-use-casdoor-sdk"},"How to use Casdoor SDK?"),(0,o.kt)("h3",{id:"1-backend-sdk-configuration"},"1. Backend SDK configuration"),(0,o.kt)("p",null,"When your application starts up, you need to initialize the Casdoor SDK config by calling the ",(0,o.kt)("inlineCode",{parentName:"p"},"InitConfig()")," function with required parameters. Take casdoor-go-sdk as\nexample: ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/casbin/casnode/blob/6d4c55f5c9a3c4bd8c85f2493abad3553b9c7ac0/controllers/account.go#L51-L64"},"https://github.com/casbin/casnode/blob/6d4c55f5c9a3c4bd8c85f2493abad3553b9c7ac0/controllers/account.go#L51-L64")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-go"},'var CasdoorEndpoint = "https://door.casdoor.com"\nvar ClientId = "541738959670d221d59d"\nvar ClientSecret = "66863369a64a5863827cf949bab70ed560ba24bf"\nvar CasdoorOrganization = "casbin"\nvar CasdoorApplication = "app-casnode"\n\n//go:embed token_jwt_key.pem\nvar JwtPublicKey string\n\nfunc init() {\n    auth.InitConfig(CasdoorEndpoint, ClientId, ClientSecret, JwtPublicKey, CasdoorOrganization, CasdoorApplication)\n}\n')),(0,o.kt)("p",null,"All the parameters for ",(0,o.kt)("inlineCode",{parentName:"p"},"InitConfig()")," are explained as follows:"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,o.kt)("th",{parentName:"tr",align:null},"Must"),(0,o.kt)("th",{parentName:"tr",align:null},"Description"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"endpoint"),(0,o.kt)("td",{parentName:"tr",align:null},"Yes"),(0,o.kt)("td",{parentName:"tr",align:null},"Casdoor Server URL, like ",(0,o.kt)("inlineCode",{parentName:"td"},"https://door.casdoor.com")," or ",(0,o.kt)("inlineCode",{parentName:"td"},"http://localhost:8000"))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"clientId"),(0,o.kt)("td",{parentName:"tr",align:null},"Yes"),(0,o.kt)("td",{parentName:"tr",align:null},"Client ID for the Casdoor application")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"clientSecret"),(0,o.kt)("td",{parentName:"tr",align:null},"Yes"),(0,o.kt)("td",{parentName:"tr",align:null},"Client secret for the Casdoor application")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"jwtPublicKey"),(0,o.kt)("td",{parentName:"tr",align:null},"Yes"),(0,o.kt)("td",{parentName:"tr",align:null},"The public key for the Casdoor application's cert")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"organizationName"),(0,o.kt)("td",{parentName:"tr",align:null},"Yes"),(0,o.kt)("td",{parentName:"tr",align:null},"The name for the Casdoor organization")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"applicationName"),(0,o.kt)("td",{parentName:"tr",align:null},"No"),(0,o.kt)("td",{parentName:"tr",align:null},"The name for the Casdoor application")))),(0,o.kt)("admonition",{type:"tip"},(0,o.kt)("p",{parentName:"admonition"},"The ",(0,o.kt)("inlineCode",{parentName:"p"},"jwtPublicKey")," can be managed in the ",(0,o.kt)("inlineCode",{parentName:"p"},"Certs")," page as below."),(0,o.kt)("p",{parentName:"admonition"},(0,o.kt)("img",{alt:"Certs Management",src:a(77309).Z,width:"2532",height:"403"})),(0,o.kt)("p",{parentName:"admonition"},"You can find the public key in the cert edit page, copy it or download it for the sdk."),(0,o.kt)("p",{parentName:"admonition"},(0,o.kt)("img",{alt:"Certs Edit",src:a(3448).Z,width:"2383",height:"1191"})),(0,o.kt)("p",{parentName:"admonition"},"Then you can select the cert in the application edit page."),(0,o.kt)("p",{parentName:"admonition"},(0,o.kt)("img",{alt:"Certs Select",src:a(7661).Z,width:"2512",height:"1170"}))),(0,o.kt)("h3",{id:"2-frontend-configuration"},"2. Frontend configuration"),(0,o.kt)("p",null,"First, install ",(0,o.kt)("inlineCode",{parentName:"p"},"casdoor-js-sdk")," via NPM or Yarn:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},"npm install casdoor-js-sdk\n")),(0,o.kt)("p",null,"Or:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},"yarn add casdoor-js-sdk\n")),(0,o.kt)("p",null,"Then define the following utility functions (better in a global JS file like ",(0,o.kt)("inlineCode",{parentName:"p"},"Setting.js"),"):"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'import Sdk from "casdoor-js-sdk";\n\nexport function initCasdoorSdk(config) {\n  CasdoorSdk = new Sdk(config);\n}\n\nexport function getSignupUrl() {\n  return CasdoorSdk.getSignupUrl();\n}\n\nexport function getSigninUrl() {\n  return CasdoorSdk.getSigninUrl();\n}\n\nexport function getUserProfileUrl(userName, account) {\n  return CasdoorSdk.getUserProfileUrl(userName, account);\n}\n\nexport function getMyProfileUrl(account) {\n  return CasdoorSdk.getMyProfileUrl(account);\n}\n\nexport function getMyResourcesUrl(account) {\n  return CasdoorSdk.getMyProfileUrl(account).replace("/account?", "/resources?");\n}\n\nexport function signin() {\n  return CasdoorSdk.signin(ServerUrl);\n}\n\nexport function showMessage(type, text) {\n  if (type === "") {\n    return;\n  } else if (type === "success") {\n    message.success(text);\n  } else if (type === "error") {\n    message.error(text);\n  }\n}\n\nexport function goToLink(link) {\n  window.location.href = link;\n}\n')),(0,o.kt)("p",null,"In the entrance file of your frontend code (like ",(0,o.kt)("inlineCode",{parentName:"p"},"index.js")," or ",(0,o.kt)("inlineCode",{parentName:"p"},"app.js")," in React), you need to initialize\nthe ",(0,o.kt)("inlineCode",{parentName:"p"},"casdoor-js-sdk")," by calling the ",(0,o.kt)("inlineCode",{parentName:"p"},"InitConfig()")," function with required parameters. The first 4 parameters should use the same value as the Casdoor backend SDK. The last parameter ",(0,o.kt)("inlineCode",{parentName:"p"},"redirectPath")," is relative path for the redirected URL, returned from Casdoor's login page."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'const config = {\n  serverUrl: "https://door.casdoor.com",\n  clientId: "014ae4bd048734ca2dea",\n  organizationName: "casbin",\n  appName: "app-casnode",\n  redirectPath: "/callback",\n};\n\nxxx.initCasdoorSdk(config);\n')),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"(Optional)")," Because we are using React as example, our ",(0,o.kt)("inlineCode",{parentName:"p"},"/callback")," path is hitting the React route. We use the following React component to receive the ",(0,o.kt)("inlineCode",{parentName:"p"},"/callback")," call and send to the backend. You can ignore this step if you are redirecting to backend directly (like in JSP or PHP)."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'import React from "react";\nimport {Button, Result, Spin} from "antd";\nimport {withRouter} from "react-router-dom";\nimport * as Setting from "./Setting";\n\nclass AuthCallback extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      classes: props,\n      msg: null,\n    };\n  }\n\n  componentWillMount() {\n    this.login();\n  }\n\n  login() {\n    Setting.signin().then((res) => {\n      if (res.status === "ok") {\n        Setting.showMessage("success", `Logged in successfully`);\n        Setting.goToLink("/");\n      } else {\n        this.setState({\n          msg: res.msg,\n        });\n      }\n    });\n  }\n\n  render() {\n    return (\n      <div style={{textAlign: "center"}}>\n        {this.state.msg === null ? (\n          <Spin\n            size="large"\n            tip="Signing in..."\n            style={{paddingTop: "10%"}}\n          />\n        ) : (\n          <div style={{display: "inline"}}>\n            <Result\n              status="error"\n              title="Login Error"\n              subTitle={this.state.msg}\n              extra={[\n                <Button type="primary" key="details">\n                  Details\n                </Button>,\n                <Button key="help">Help</Button>,\n              ]}\n            />\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n\nexport default withRouter(AuthCallback);\n')),(0,o.kt)("h3",{id:"3-get-login-urls"},"3. Get login URLs"),(0,o.kt)("p",null,'Next you can show the "Sign up" and "Sign in" buttons or links to your users. The URLs can either be retrieved in the frontend or backend. See more details at: ',(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"/docs/basic/core-concepts#login-urls"},"/docs/basic/core-concepts#login-urls"))),(0,o.kt)("h3",{id:"4-get-and-verify-access-token"},"4. Get and verify access token"),(0,o.kt)("p",null,"Here are the steps:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"The user clicks the login URL and is redirected to Casdoor's login page,\nlike: ",(0,o.kt)("inlineCode",{parentName:"li"},"https://door.casdoor.com/login/oauth/authorize?client_id=014ae4bd048734ca2dea&response_type=code&redirect_uri=https%3A%2F%2Fforum.casbin.com%2Fcallback&scope=read&state=app-casnode")),(0,o.kt)("li",{parentName:"ol"},"The user enters username & password and clicks ",(0,o.kt)("inlineCode",{parentName:"li"},"Sign In")," (or just click the third-party login button\nlike ",(0,o.kt)("inlineCode",{parentName:"li"},"Sign in with GitHub"),")."),(0,o.kt)("li",{parentName:"ol"},"The user is redirected back to your application with the authorization code issued by Casdoor (\nlike: ",(0,o.kt)("inlineCode",{parentName:"li"},"https://forum.casbin.com?code=xxx&state=yyy"),"), your application's backend needs to exchange the authorization code with the access token and verify that the access token is valid and issued by Casdoor. The functions ",(0,o.kt)("inlineCode",{parentName:"li"},"GetOAuthToken()")," and ",(0,o.kt)("inlineCode",{parentName:"li"},"ParseJwtToken()")," are provided by Casdoor backend SDK.")),(0,o.kt)("p",null,"The following code shows how to get and verify the access token. For a real example of Casnode (a forum website written in Go), see: ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/casbin/casnode/blob/6d4c55f5c9a3c4bd8c85f2493abad3553b9c7ac0/controllers/account.go#L51-L64"},"https://github.com/casbin/casnode/blob/6d4c55f5c9a3c4bd8c85f2493abad3553b9c7ac0/controllers/account.go#L51-L64")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-go"},'// get code and state from the GET parameters of the redirected URL\ncode := c.Input().Get("code")\nstate := c.Input().Get("state")\n\n// exchange the access token with code and state\ntoken, err := auth.GetOAuthToken(code, state)\nif err != nil {\n    panic(err)\n}\n\n// verify the access token\nclaims, err := auth.ParseJwtToken(token.AccessToken)\nif err != nil {\n    panic(err)\n}\n')),(0,o.kt)("p",null,"If ",(0,o.kt)("inlineCode",{parentName:"p"},"ParseJwtToken()")," finishes with no error, then the user has successfully logged into the application. The\nreturned ",(0,o.kt)("inlineCode",{parentName:"p"},"claims")," can be used to identity the user later."),(0,o.kt)("h3",{id:"4-identify-user-with-access-token"},"4. Identify user with access token"),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"This part is actually your application's own business logic and not part of OIDC, OAuth or Casdoor. We just provide good practices as a lot of people don't know what to do for the next step.")),(0,o.kt)("p",null,"In Casdoor, access token is usually identical as ID token. They are the same thing. So the access token contains all information for the logged-in user."),(0,o.kt)("p",null,"The variable ",(0,o.kt)("inlineCode",{parentName:"p"},"claims")," returned by ",(0,o.kt)("inlineCode",{parentName:"p"},"ParseJwtToken()")," is defined as:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-go"},'type Claims struct {\n    User\n    AccessToken string `json:"accessToken"`\n    jwt.RegisteredClaims\n}\n')),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("inlineCode",{parentName:"li"},"User"),": the User object, containing all information for the logged-in user, see definition\nat: ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("a",{parentName:"strong",href:"/docs/basic/core-concepts#user"},"/docs/basic/core-concepts#user"))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("inlineCode",{parentName:"li"},"AccessToken"),": the access token string."),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("inlineCode",{parentName:"li"},"jwt.RegisteredClaims"),": some other values required by JWT.")),(0,o.kt)("p",null,"At this moment, the application usually has two ways to remember the user session: ",(0,o.kt)("inlineCode",{parentName:"p"},"session")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"JWT"),"."),(0,o.kt)("h4",{id:"session"},"Session"),(0,o.kt)("p",null,"The Method to set session varies greatly depending on the language and web framework. E.g., Casnode\nuses ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/beego/beego/"},"Beego web framework")," and set session by calling: ",(0,o.kt)("inlineCode",{parentName:"p"},"c.SetSessionUser()"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-go"},"token, err := auth.GetOAuthToken(code, state)\nif err != nil {\n    panic(err)\n}\n\nclaims, err := auth.ParseJwtToken(token.AccessToken)\nif err != nil {\n    panic(err)\n}\n\nclaims.AccessToken = token.AccessToken\nc.SetSessionUser(claims) // set session\n")),(0,o.kt)("h4",{id:"jwt"},"JWT"),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"accessToken")," returned by Casdoor is actually a JWT. So if your application uses JWT to keep user session, just use the access token directly for it:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Send the access token to frontend, save it in places like localStorage of the browser."),(0,o.kt)("li",{parentName:"ol"},"Let the browser send the access token to backend for every request."),(0,o.kt)("li",{parentName:"ol"},"Call ",(0,o.kt)("inlineCode",{parentName:"li"},"ParseJwtToken()")," or your own function to verify the access token and get logged-in user information in your backend.")),(0,o.kt)("h3",{id:"5-optional-interact-with-the-user-table"},"5. ",(0,o.kt)("strong",{parentName:"h3"},"(Optional)")," Interact with the User table"),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"This part is provided by ",(0,o.kt)("inlineCode",{parentName:"p"},"Casdoor Public API")," and not part of the OIDC or OAuth.")),(0,o.kt)("p",null,"Casdoor Backend SDK provides a lot of helper functions, not limited to:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"GetUser(name string)"),": get a user by username."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"GetUsers()"),": get all users."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"AddUser()"),": add a user."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"UpdateUser()"),": update a user."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"DeleteUser()"),": delete a user."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"CheckUserPassword(auth.User)"),": check user's password.")),(0,o.kt)("p",null,"These functions are implemented by making RESTful calls against ",(0,o.kt)("inlineCode",{parentName:"p"},"Casdoor Public API"),". If a function is not provided in Casdoor Backend SDK, you can make RESTful calls by yourself."))}c.isMDXComponent=!0},3448:(t,e,a)=>{a.d(e,{Z:()=>n});const n=a.p+"assets/images/howto_cert_edit-81b9d2d22373bef5304e8d44a4599307.png"},77309:(t,e,a)=>{a.d(e,{Z:()=>n});const n=a.p+"assets/images/howto_cert_list-d390f783cfbe9a70ce462bcefad9044b.png"},7661:(t,e,a)=>{a.d(e,{Z:()=>n});const n=a.p+"assets/images/howto_cert_select-bec6aa4df2dd44530cd1c54fd5838595.png"}}]);