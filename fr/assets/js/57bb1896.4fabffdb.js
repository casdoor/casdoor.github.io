"use strict";(self.webpackChunkcasdoor_website=self.webpackChunkcasdoor_website||[]).push([[5930],{3905:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>m});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var l=n.createContext({}),c=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},p=function(e){var t=c(e.components);return n.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),d=c(a),m=r,k=d["".concat(l,".").concat(m)]||d[m]||u[m]||o;return a?n.createElement(k,i(i({ref:t},p),{},{components:a})):n.createElement(k,i({ref:t},p))}));function m(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=a.length,i=new Array(o);i[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,i[1]=s;for(var c=2;c<o;c++)i[c]=a[c];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}d.displayName="MDXCreateElement"},8842:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>u,frontMatter:()=>o,metadata:()=>s,toc:()=>c});var n=a(87462),r=(a(67294),a(3905));const o={title:"API publique de Casdoor",description:"API publique de Casdoor",keywords:["API publique de Casdoor"],authors:["hsluoyz"]},i=void 0,s={unversionedId:"basic/public-api",id:"basic/public-api",title:"API publique de Casdoor",description:"API publique de Casdoor",source:"@site/i18n/fr/docusaurus-plugin-content-docs/current/basic/public-api.md",sourceDirName:"basic",slug:"/basic/public-api",permalink:"/fr/docs/basic/public-api",draft:!1,editUrl:"https://github.com/casdoor/casdoor-website/edit/master/docs/basic/public-api.md",tags:[],version:"current",frontMatter:{title:"API publique de Casdoor",description:"API publique de Casdoor",keywords:["API publique de Casdoor"],authors:["hsluoyz"]},sidebar:"tutorialSidebar",previous:{title:"(Facultatif) Essayez avec K8s Helm",permalink:"/fr/docs/basic/try-with-helm"},next:{title:"Tutoriels",permalink:"/fr/docs/basic/tutorials"}},l={},c=[{value:"Comment s&#39;authentifier avec l&#39;<code>Casdoor Public API</code>",id:"comment-sauthentifier-avec-lcasdoor-public-api",level:2},{value:"1. Par <code>Access token</code>",id:"1-par-access-token",level:3},{value:"Comment obtenir le token d&#39;acc\xe8s ?",id:"comment-obtenir-le-token-dacc\xe8s-",level:4},{value:"Comment s&#39;authentifier ?",id:"comment-sauthentifier-",level:4},{value:"2. Par <code>Client ID</code> et <code>Client secret</code>",id:"2-par-client-id-et-client-secret",level:3},{value:"Comment obtenir l&#39;ID client et le secret ?",id:"comment-obtenir-lid-client-et-le-secret-",level:4},{value:"Comment s&#39;authentifier ?",id:"comment-sauthentifier--1",level:4},{value:"3. Par <code>Access key</code> et <code>Access secret</code>",id:"3-par-access-key-et-access-secret",level:3},{value:"Comment s&#39;authentifier ?",id:"comment-sauthentifier--2",level:4},{value:"4. Par <code>username</code> et <code>password</code>",id:"4-par-username-et-password",level:3},{value:"Comment s&#39;authentifier ?",id:"comment-sauthentifier--3",level:4}],p={toc:c};function u(e){let{components:t,...a}=e;return(0,r.kt)("wrapper",(0,n.Z)({},p,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"L'interface utilisateur web frontend de Casdoor est une ",(0,r.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Glossary/SPA"},"SPA (Single-Page Application)")," d\xe9velopp\xe9e en React. Le frontend React consomme l'API RESTful de Casdoor expos\xe9e par le code backend en Go. Cette API RESTful est appel\xe9e ",(0,r.kt)("inlineCode",{parentName:"p"},"Casdoor Public API"),". En d'autres termes, avec des appels HTTP, vous pouvez tout faire comme le fait l'interface utilisateur web de Casdoor elle-m\xeame. Il n'y a pas d'autres limitations. L'API peut \xeatre utilis\xe9e par les suivants :"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Frontend de Casdoor"),(0,r.kt)("li",{parentName:"ul"},"SDKs clients de Casdoor (par exemple, casdoor-go-sdk)"),(0,r.kt)("li",{parentName:"ul"},"Tout autre code personnalis\xe9 du c\xf4t\xe9 de l'application")),(0,r.kt)("p",null,"La r\xe9f\xe9rence compl\xe8te pour l'",(0,r.kt)("inlineCode",{parentName:"p"},"Casdoor Public API")," peut \xeatre trouv\xe9e sur Swagger : ",(0,r.kt)("a",{parentName:"p",href:"https://door.casdoor.com/swagger"},(0,r.kt)("strong",{parentName:"a"},"https://door.casdoor.com/swagger")),". Ces documents Swagger sont g\xe9n\xe9r\xe9s automatiquement en utilisant l'outil Bee de Beego. Si vous souhaitez g\xe9n\xe9rer les documents Swagger par vous-m\xeame, voir : ",(0,r.kt)("a",{parentName:"p",href:"/docs/developer-guide/swagger/#how-to-generate-the-swagger-file"},"Comment g\xe9n\xe9rer le fichier swagger")),(0,r.kt)("h2",{id:"comment-sauthentifier-avec-lcasdoor-public-api"},"Comment s'authentifier avec l'",(0,r.kt)("inlineCode",{parentName:"h2"},"Casdoor Public API")),(0,r.kt)("h3",{id:"1-par-access-token"},"1. Par ",(0,r.kt)("inlineCode",{parentName:"h3"},"Access token")),(0,r.kt)("p",null,"Nous pouvons utiliser le token d'acc\xe8s accord\xe9 \xe0 un utilisateur authentifi\xe9 pour appeler l'",(0,r.kt)("inlineCode",{parentName:"p"},"Casdoor Public API")," comme l'utilisateur lui-m\xeame."),(0,r.kt)("h4",{id:"comment-obtenir-le-token-dacc\xe8s-"},"Comment obtenir le token d'acc\xe8s ?"),(0,r.kt)("p",null,"L'application peut obtenir le token d'acc\xe8s pour l'utilisateur de Casdoor \xe0 la fin du processus de connexion OAuth (alias obtenir le token par code et \xe9tat). Les permissions pour les appels API seront les m\xeames que celles de l'utilisateur."),(0,r.kt)("p",null,"L'exemple ci-dessous montre comment appeler la fonction ",(0,r.kt)("inlineCode",{parentName:"p"},"GetOAuthToken()")," en Go via casdoor-go-sdk."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-go"},'func (c *ApiController) Signin() {\n    code := c.Input().Get("code")\n    state := c.Input().Get("state")\n\n    token, err := casdoorsdk.GetOAuthToken(code, state)\n    if err != nil {\n        c.ResponseError(err.Error())\n        return\n    }\n\n    claims, err := casdoorsdk.ParseJwtToken(token.AccessToken)\n    if err != nil {\n        c.ResponseError(err.Error())\n        return\n    }\n\n    if !claims.IsAdmin {\n        claims.Type = "chat-user"\n    }\n\n    err = c.addInitialChat(&claims.User)\n    if err != nil {\n        c.ResponseError(err.Error())\n        return\n    }\n\n    claims.AccessToken = token.AccessToken\n    c.SetSessionClaims(claims)\n\n    c.ResponseOk(claims)\n}\n')),(0,r.kt)("p",null,"Tous les tokens d'acc\xe8s accord\xe9s peuvent \xe9galement \xeatre consult\xe9s via l'interface utilisateur web par un utilisateur administrateur dans la page Tokens. Par exemple, visitez : ",(0,r.kt)("a",{parentName:"p",href:"https://door.casdoor.com/tokens"},"https://door.casdoor.com/tokens")," pour le site de d\xe9monstration."),(0,r.kt)("h4",{id:"comment-sauthentifier-"},"Comment s'authentifier ?"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Param\xe8tre ",(0,r.kt)("inlineCode",{parentName:"p"},"GET")," HTTP, le format de l'URL est :"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"/page?access_token=<The access token>\n")),(0,r.kt)("p",{parentName:"li"},"Exemple de site de d\xe9monstration : ",(0,r.kt)("inlineCode",{parentName:"p"},"https://door.casdoor.com/api/get-global-providers?access_token=eyJhbGciOiJSUzI1NiIs"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Token porteur HTTP, le format de l'en-t\xeate HTTP est :"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"Authorization: Bearer <The access token>\n")))),(0,r.kt)("h3",{id:"2-par-client-id-et-client-secret"},"2. Par ",(0,r.kt)("inlineCode",{parentName:"h3"},"Client ID")," et ",(0,r.kt)("inlineCode",{parentName:"h3"},"Client secret")),(0,r.kt)("h4",{id:"comment-obtenir-lid-client-et-le-secret-"},"Comment obtenir l'ID client et le secret ?"),(0,r.kt)("p",null,"La page d'\xe9dition de l'application (par exemple, ",(0,r.kt)("a",{parentName:"p",href:"https://door.casdoor.com/applications/casbin/app-vue-python-example"},"https://door.casdoor.com/applications/casbin/app-vue-python-example"),") affichera l'ID client et le secret pour une application. Cette authentification est utile lorsque vous souhaitez appeler l'API en tant que \"machine\", \"application\" ou \"service\" au lieu d'un utilisateur. Les permissions pour les appels API seront les m\xeames que celles de l'application (alias l'administrateur de l'organisation)."),(0,r.kt)("p",null,"L'exemple ci-dessous montre comment appeler la fonction ",(0,r.kt)("inlineCode",{parentName:"p"},"GetOAuthToken()")," en Go via casdoor-go-sdk."),(0,r.kt)("h4",{id:"comment-sauthentifier--1"},"Comment s'authentifier ?"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Param\xe8tre ",(0,r.kt)("inlineCode",{parentName:"p"},"GET")," HTTP, le format de l'URL est :"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"/page?clientId=<The client ID>&clientSecret=<the client secret>\n")),(0,r.kt)("p",{parentName:"li"},"Exemple de site de d\xe9monstration : ",(0,r.kt)("inlineCode",{parentName:"p"},"https://door.casdoor.com/api/get-global-providers?clientId=294b09fbc17f95daf2fe&clientSecret=dd8982f7046ccba1bbd7851d5c1ece4e52bf039d"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Basic_access_authentication"},"Authentification de base HTTP"),", le format de l'en-t\xeate HTTP est :"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'Authorization: Basic <The Base64 encoding of client ID and client secret joined by a single colon ":">\n')))),(0,r.kt)("p",null,"Si vous n'\xeates pas familier avec l'encodage Base64, vous pouvez utiliser une biblioth\xe8que pour le faire car l'",(0,r.kt)("inlineCode",{parentName:"p"},"Authentification de base HTTP")," est une norme populaire prise en charge par de nombreux endroits."),(0,r.kt)("h3",{id:"3-par-access-key-et-access-secret"},"3. Par ",(0,r.kt)("inlineCode",{parentName:"h3"},"Access key")," et ",(0,r.kt)("inlineCode",{parentName:"h3"},"Access secret")),(0,r.kt)("p",null,"Nous pouvons utiliser la cl\xe9 d'acc\xe8s et le secret d'acc\xe8s pour un utilisateur Casdoor pour appeler l'",(0,r.kt)("inlineCode",{parentName:"p"},"Casdoor Public API")," comme l'utilisateur lui-m\xeame. La cl\xe9 d'acc\xe8s et le secret d'acc\xe8s peuvent \xeatre configur\xe9s dans la page des param\xe8tres de l'utilisateur par un administrateur ou l'utilisateur lui-m\xeame. L'API ",(0,r.kt)("inlineCode",{parentName:"p"},"update-user")," peut \xe9galement \xeatre appel\xe9e pour mettre \xe0 jour ces champs. Les permissions pour les appels API seront les m\xeames que celles de l'utilisateur."),(0,r.kt)("h4",{id:"comment-sauthentifier--2"},"Comment s'authentifier ?"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Param\xe8tre ",(0,r.kt)("inlineCode",{parentName:"p"},"GET")," HTTP, le format de l'URL est :"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"/page?accessKey=<The user's access key>&accessSecret=<the user's access secret>\"\n")))),(0,r.kt)("p",null,"Exemple de site de d\xe9monstration : ",(0,r.kt)("inlineCode",{parentName:"p"},"https://door.casdoor.com/api/get-global-providers?accessKey=b86db9dc-6bd7-4997-935c-af480dd2c796/admin&accessSecret=79911517-fc36-4093-b115-65a9741f6b14")),(0,r.kt)("h3",{id:"4-par-username-et-password"},"4. Par ",(0,r.kt)("inlineCode",{parentName:"h3"},"username")," et ",(0,r.kt)("inlineCode",{parentName:"h3"},"password")),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"Cette m\xe9thode d'authentification n'est pas s\xfbre et est conserv\xe9e ici uniquement \xe0 des fins de compatibilit\xe9 ou de d\xe9monstration. Nous recommandons d'utiliser les trois m\xe9thodes d'authentification pr\xe9c\xe9dentes \xe0 la place."),(0,r.kt)("h4",{parentName:"admonition",id:"que-se-passera-t-il-"},"Que se passera-t-il ?"),(0,r.kt)("p",{parentName:"admonition"},"Les informations d'identification de l'utilisateur seront expos\xe9es en tant que param\xe8tres ",(0,r.kt)("inlineCode",{parentName:"p"},"GET")," dans l'URL de la requ\xeate. De plus, les informations d'identification de l'utilisateur pourront \xeatre intercept\xe9es en texte clair par le r\xe9seau si vous utilisez HTTP au lieu de HTTPS.")),(0,r.kt)("p",null,"Nous pouvons utiliser le nom d'utilisateur et le mot de passe d'un utilisateur Casdoor pour appeler l'",(0,r.kt)("inlineCode",{parentName:"p"},"Casdoor Public API")," comme l'utilisateur lui-m\xeame. Le nom d'utilisateur prend le format de ",(0,r.kt)("inlineCode",{parentName:"p"},"<Le nom de l'organisation de l'utilisateur>/<Le nom de l'utilisateur>"),". Les permissions pour les appels API seront les m\xeames que celles de l'utilisateur."),(0,r.kt)("h4",{id:"comment-sauthentifier--3"},"Comment s'authentifier ?"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Param\xe8tre ",(0,r.kt)("inlineCode",{parentName:"p"},"GET")," HTTP, le format de l'URL est :"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"/page?username=<The user's organization name>/<The user name>&password=<the user's password>\"\n")))),(0,r.kt)("p",null,"Exemple de site de d\xe9monstration : ",(0,r.kt)("inlineCode",{parentName:"p"},"https://door.casdoor.com/api/get-global-providers?username=built-in/admin&password=123")))}u.isMDXComponent=!0}}]);