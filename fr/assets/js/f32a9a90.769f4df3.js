"use strict";(self.webpackChunkcasdoor_website=self.webpackChunkcasdoor_website||[]).push([[7462],{3905:(e,a,t)=>{t.d(a,{Zo:()=>u,kt:()=>f});var r=t(67294);function n(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function o(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);a&&(r=r.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,r)}return t}function i(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?o(Object(t),!0).forEach((function(a){n(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function l(e,a){if(null==e)return{};var t,r,n=function(e,a){if(null==e)return{};var t,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],a.indexOf(t)>=0||(n[t]=e[t]);return n}(e,a);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(n[t]=e[t])}return n}var s=r.createContext({}),p=function(e){var a=r.useContext(s),t=a;return e&&(t="function"==typeof e?e(a):i(i({},a),e)),t},u=function(e){var a=p(e.components);return r.createElement(s.Provider,{value:a},e.children)},c={inlineCode:"code",wrapper:function(e){var a=e.children;return r.createElement(r.Fragment,{},a)}},d=r.forwardRef((function(e,a){var t=e.components,n=e.mdxType,o=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),d=p(t),f=n,g=d["".concat(s,".").concat(f)]||d[f]||c[f]||o;return t?r.createElement(g,i(i({ref:a},u),{},{components:t})):r.createElement(g,i({ref:a},u))}));function f(e,a){var t=arguments,n=a&&a.mdxType;if("string"==typeof e||n){var o=t.length,i=new Array(o);i[0]=d;var l={};for(var s in a)hasOwnProperty.call(a,s)&&(l[s]=a[s]);l.originalType=e,l.mdxType="string"==typeof e?e:n,i[1]=l;for(var p=2;p<o;p++)i[p]=t[p];return r.createElement.apply(null,i)}return r.createElement.apply(null,t)}d.displayName="MDXCreateElement"},22718:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>s,contentTitle:()=>i,default:()=>c,frontMatter:()=>o,metadata:()=>l,toc:()=>p});var r=t(87462),n=(t(67294),t(3905));const o={title:"Grafana",description:"Utilisation de Casdoor pour l'authentification dans Grafana",keywords:["Grafana"],authors:["ComradeProgrammer"]},i=void 0,l={unversionedId:"integration/go/grafana",id:"integration/go/grafana",title:"Grafana",description:"Utilisation de Casdoor pour l'authentification dans Grafana",source:"@site/i18n/fr/docusaurus-plugin-content-docs/current/integration/go/grafana.md",sourceDirName:"integration/go",slug:"/integration/go/grafana",permalink:"/fr/docs/integration/go/grafana",draft:!1,editUrl:"https://github.com/casdoor/casdoor-website/edit/master/docs/integration/go/grafana.md",tags:[],version:"current",frontMatter:{title:"Grafana",description:"Utilisation de Casdoor pour l'authentification dans Grafana",keywords:["Grafana"],authors:["ComradeProgrammer"]},sidebar:"tutorialSidebar",previous:{title:"Gitea",permalink:"/fr/docs/integration/go/gitea"},next:{title:"MinIO",permalink:"/fr/docs/integration/go/minio"}},s={},p=[{value:"Utilisation de Casdoor pour l&#39;authentification dans Grafana",id:"utilisation-de-casdoor-pour-lauthentification-dans-grafana",level:2},{value:"\xc9tape 1 : Cr\xe9er une application pour Grafana dans Casdoor",id:"\xe9tape-1--cr\xe9er-une-application-pour-grafana-dans-casdoor",level:2},{value:"\xc9tape 2 : Modifier la configuration de Grafana",id:"\xe9tape-2--modifier-la-configuration-de-grafana",level:2},{value:"\xc0 propos de HTTPS",id:"\xe0-propos-de-https",level:3},{value:"\xc0 propos de redirectURI apr\xe8s la connexion avec Casdoor",id:"\xe0-propos-de-redirecturi-apr\xe8s-la-connexion-avec-casdoor",level:3},{value:"\xc0 propos du mappage des r\xf4les",id:"\xe0-propos-du-mappage-des-r\xf4les",level:3},{value:"\xc9tape 3 : V\xe9rifiez si cela fonctionne",id:"\xe9tape-3--v\xe9rifiez-si-cela-fonctionne",level:2}],u={toc:p};function c(e){let{components:a,...o}=e;return(0,n.kt)("wrapper",(0,r.Z)({},u,o,{components:a,mdxType:"MDXLayout"}),(0,n.kt)("h2",{id:"utilisation-de-casdoor-pour-lauthentification-dans-grafana"},"Utilisation de Casdoor pour l'authentification dans Grafana"),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://grafana.com/oss/grafana/"},"Grafana")," prend en charge l'authentification via OAuth. Par cons\xe9quent, il est extr\xeamement facile pour les utilisateurs d'utiliser Casdoor pour se connecter \xe0 Grafana. Seulement quelques \xe9tapes et configurations simples sont n\xe9cessaires pour y parvenir."),(0,n.kt)("p",null,"Voici un tutoriel sur comment utiliser Casdoor pour l'authentification dans Grafana. Avant de continuer, veuillez vous assurer que vous avez Grafana install\xe9 et en cours d'ex\xe9cution."),(0,n.kt)("h2",{id:"\xe9tape-1--cr\xe9er-une-application-pour-grafana-dans-casdoor"},"\xc9tape 1 : Cr\xe9er une application pour Grafana dans Casdoor"),(0,n.kt)("p",null,"Voici un exemple de cr\xe9ation d'une application dans Casdoor :"),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Cr\xe9er une application dans Casdoor",src:t(34709).Z,width:"1367",height:"810"})),(0,n.kt)("p",null,"Veuillez copier le secret client et l'ID client pour l'\xe9tape suivante."),(0,n.kt)("p",null,"Veuillez ajouter l'URL de rappel de Grafana. Par d\xe9faut, le rappel OAuth de Grafana est ",(0,n.kt)("inlineCode",{parentName:"p"},"/login/generic_oauth"),". Alors veuillez concat\xe9ner cette URL correctement."),(0,n.kt)("h2",{id:"\xe9tape-2--modifier-la-configuration-de-grafana"},"\xc9tape 2 : Modifier la configuration de Grafana"),(0,n.kt)("p",null,"Par d\xe9faut, le fichier de configuration pour OAuth se trouve \xe0 ",(0,n.kt)("inlineCode",{parentName:"p"},"conf/defaults.ini")," dans le r\xe9pertoire de travail de Grafana."),(0,n.kt)("p",null,"Veuillez trouver la section ",(0,n.kt)("inlineCode",{parentName:"p"},"[auth.generic_oauth]")," et modifier les champs suivants :"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-ini"},"[auth.generic_oauth]\nname = Casdoor\nicon = signin\nenabled = true\nallow_sign_up = true\nclient_id = <client ID from previous step>\nclient_secret = <client secret from previous step>\nauth_url = <Casdoor endpoint>/login/oauth/authorize\ntoken_url = <Casdoor endpoint>/api/login/oauth/access_token\n\n")),(0,n.kt)("h3",{id:"\xe0-propos-de-https"},"\xc0 propos de HTTPS"),(0,n.kt)("p",null,"Si vous ne souhaitez pas activer HTTPS pour Casdoor ou si vous d\xe9ployez Grafana sans HTTPS activ\xe9, veuillez \xe9galement d\xe9finir ",(0,n.kt)("inlineCode",{parentName:"p"},"tls_skip_verify_insecure = true"),"."),(0,n.kt)("h3",{id:"\xe0-propos-de-redirecturi-apr\xe8s-la-connexion-avec-casdoor"},"\xc0 propos de redirectURI apr\xe8s la connexion avec Casdoor"),(0,n.kt)("p",null,"Si l'URI de redirection n'est pas correcte apr\xe8s s'\xeatre connect\xe9 avec Casdoor dans Grafana, vous voudrez peut-\xeatre configurer ",(0,n.kt)("a",{parentName:"p",href:"https://stackoverflow.com/a/69814805"},"root_url"),"."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-ini"},"[server]\nhttp_port = 3000\n# The public-facing domain name used to access Grafana from a browser\ndomain = <your IP here>\n# The full public-facing URL\nroot_url = %(protocol)s://%(domain)s:%(http_port)s/\n")),(0,n.kt)("p",null,"Liens connexes :"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("a",{parentName:"p",href:"https://grafana.com/docs/grafana/latest/setup-grafana/configure-grafana/#root_url"},"Documentation de Grafana"))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("a",{parentName:"p",href:"https://github.com/grafana/grafana/blob/main/conf/defaults.ini"},"Grafana defaults.ini")))),(0,n.kt)("h3",{id:"\xe0-propos-du-mappage-des-r\xf4les"},"\xc0 propos du mappage des r\xf4les"),(0,n.kt)("p",null,"Vous voudrez peut-\xeatre configurer ",(0,n.kt)("inlineCode",{parentName:"p"},"role_attribute_path")," pour mapper le r\xf4le de votre utilisateur \xe0 Grafana via ",(0,n.kt)("a",{parentName:"p",href:"https://grafana.com/docs/grafana/latest/setup-grafana/configure-security/configure-authentication/generic-oauth/#role-mapping"},"role_attribute_path"),"."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-ini"},"[auth.generic_oauth]\nrole_attribute_path = contains(roles[*].name, 'admin') && 'Admin' || contains(roles[*].name, 'editor') && 'Editor' || 'Viewer'\nrole_attribute_strict = true\nallow_assign_grafana_admin = true\n")),(0,n.kt)("p",null,"L'expression JMESPath apr\xe8s ",(0,n.kt)("inlineCode",{parentName:"p"},"role_attribute_path")," est tr\xe8s importante ici. Veuillez vous r\xe9f\xe9rer \xe0 la documentation de Grafana."),(0,n.kt)("h2",{id:"\xe9tape-3--v\xe9rifiez-si-cela-fonctionne"},"\xc9tape 3 : V\xe9rifiez si cela fonctionne"),(0,n.kt)("p",null,"Arr\xeatez Grafana et red\xe9marrez-le."),(0,n.kt)("p",null,"Allez \xe0 la page de connexion. Vous devriez voir quelque chose comme ceci :"),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"R\xe9sultat final",src:t(60591).Z,width:"1384",height:"739"})))}c.isMDXComponent=!0},34709:(e,a,t)=>{t.d(a,{Z:()=>r});const r=t.p+"assets/images/grafana_1-9f197ebf06da48585fe18ce1d66ce212.png"},60591:(e,a,t)=>{t.d(a,{Z:()=>r});const r=t.p+"assets/images/grafana_2-5136a37a917e1c899feedb23e218fa13.png"}}]);