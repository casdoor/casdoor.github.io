(self.webpackChunkcasdoor_website=self.webpackChunkcasdoor_website||[]).push([[6271],{3905:function(e,t,n){"use strict";n.d(t,{Zo:function(){return p},kt:function(){return m}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),c=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=c(e.components);return a.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),d=c(n),m=r,k=d["".concat(s,".").concat(m)]||d[m]||u[m]||o;return n?a.createElement(k,i(i({ref:t},p),{},{components:n})):a.createElement(k,i({ref:t},p))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:r,i[1]=l;for(var c=2;c<o;c++)i[c]=n[c];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},9039:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return l},contentTitle:function(){return s},metadata:function(){return c},toc:function(){return p},default:function(){return d}});var a=n(4034),r=n(9973),o=(n(7294),n(3905)),i=["components"],l={sidebar_position:3,title:"Keycloak"},s=void 0,c={unversionedId:"provider/saml/keycloak",id:"provider/saml/keycloak",isDocsHomePage:!1,title:"Keycloak",description:"Le syst\xe8me JBoss KeyCloak est un syst\xe8me de gestion d'identit\xe9 open-source largement utilis\xe9 qui prend en charge l'int\xe9gration avec les applications via SAML et OpenID Connect. Il peut \xe9galement fonctionner comme un courtier d'identit\xe9 entre d'autres fournisseurs tels que LDAP ou d'autres fournisseurs et applications SAML qui supportent SAML ou OpenID Connect.",source:"@site/i18n/fr/docusaurus-plugin-content-docs/current/provider/saml/keycloak.md",sourceDirName:"provider/saml",slug:"/provider/saml/keycloak",permalink:"/fr/docs/provider/saml/keycloak",editUrl:"https://github.com/casdoor/casdoor-website/tree/master/docs/provider/saml/keycloak.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3,title:"Keycloak"},sidebar:"tutorialSidebar",previous:{title:"Aliyun IDaaS",permalink:"/fr/docs/provider/saml/aliyun"},next:{title:"Aper\xe7u",permalink:"/fr/docs/user/overview"}},p=[{value:"Configure Keycloak",id:"configure-keycloak",children:[],level:2},{value:"Ajouter une entr\xe9e client dans Keycloak",id:"ajouter-une-entr\xe9e-client-dans-keycloak",children:[],level:2},{value:"Configurer dans Casdoor",id:"configurer-dans-casdoor",children:[],level:2}],u={toc:p};function d(e){var t=e.components,l=(0,r.Z)(e,i);return(0,o.kt)("wrapper",(0,a.Z)({},u,l,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Le syst\xe8me JBoss ",(0,o.kt)("a",{parentName:"p",href:"https://www.keycloak.org/"},"KeyCloak")," est un syst\xe8me de gestion d'identit\xe9 open-source largement utilis\xe9 qui prend en charge l'int\xe9gration avec les applications via SAML et OpenID Connect. Il peut \xe9galement fonctionner comme un courtier d'identit\xe9 entre d'autres fournisseurs tels que LDAP ou d'autres fournisseurs et applications SAML qui supportent SAML ou OpenID Connect."),(0,o.kt)("p",null,"Voici un exemple de la fa\xe7on de configurer une nouvelle entr\xe9e client dans KeyCloak et de configurer Casdoor pour permettre aux utilisateurs de KeyCloak de se connecter \xe0 l'interface utilisateur qui ont acc\xe8s via la configuration de KeyCloak."),(0,o.kt)("h2",{id:"configure-keycloak"},"Configure Keycloak"),(0,o.kt)("p",null,"Quelques choix de configuration et hypoth\xe8ses sp\xe9cifiques pour cet exemple :"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Supposons que vous utilisez Casdoor comme mode de d\xe9veloppement localement. Casoor UI est disponible sur : ",(0,o.kt)("inlineCode",{parentName:"li"},"http://localhost:7001")," et le serveur est disponible sur ",(0,o.kt)("inlineCode",{parentName:"li"},"http://localhost:8000"),". Remplacer par l'URL appropri\xe9e si n\xe9cessaire."),(0,o.kt)("li",{parentName:"ul"},"Supposons que vous utilisez Keycloak localement. Keycloak UI est disponible sur : ",(0,o.kt)("inlineCode",{parentName:"li"},"http://localhost:8080/auth"),"."),(0,o.kt)("li",{parentName:"ul"},"Sur la base de cela, l'URL ACS SP pour ce d\xe9ploiement sera : ",(0,o.kt)("inlineCode",{parentName:"li"},"http://localhost:8000/api/acs"),"."),(0,o.kt)("li",{parentName:"ul"},"Notre SP Entity ID utilisera la m\xeame url : ",(0,o.kt)("inlineCode",{parentName:"li"},"http://localhost:8000/api/acs"),".")),(0,o.kt)("p",null,"Utilisez le royaume par d\xe9faut ou cr\xe9ez un nouveau royaume."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Ajouter un royaume de keycloak",src:n(6865).Z})),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Keycloak realm",src:n(3528).Z})),(0,o.kt)("h2",{id:"ajouter-une-entr\xe9e-client-dans-keycloak"},"Ajouter une entr\xe9e client dans Keycloak"),(0,o.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"Voir plus de d\xe9tails sur les clients de Keycloak dans ",(0,o.kt)("a",{parentName:"h5",href:"https://www.keycloak.org/docs/latest/server_admin/index.html#_client-saml-configuration"},"documentation de Keycloak"),". :::")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Cliquez sur ",(0,o.kt)("strong",{parentName:"p"},"Clients")," dans le menu puis cliquez sur ",(0,o.kt)("strong",{parentName:"p"},"Cr\xe9er")," pour aller \xe0 la page ",(0,o.kt)("strong",{parentName:"p"},"Ajouter un client"),". Remplissez comme ci-dessous."),(0,o.kt)("ul",{parentName:"div"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"ID client"),": ",(0,o.kt)("inlineCode",{parentName:"li"},"http://localhost:8000/api/acs")," - Ce sera l'ID d'entit\xe9 SP utilis\xe9 dans la configuration de Casdoor plus tard."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Client Protocol"),": ",(0,o.kt)("inlineCode",{parentName:"li"},"saml"),"."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Client SAML Endpoint"),": ",(0,o.kt)("inlineCode",{parentName:"li"},"http://localhost:8000/api/acs"),". - Cette URL est l'endroit o\xf9 vous voulez que le serveur Keycloak envoie des requ\xeates et des r\xe9ponses SAML. En g\xe9n\xe9ral, les applications ont une URL pour traiter les requ\xeates SAML. Plusieurs URL peuvent \xeatre d\xe9finies dans l'onglet Param\xe8tres du client.")),(0,o.kt)("p",{parentName:"div"},(0,o.kt)("img",{alt:"Ajouter un client keycloak",src:n(3749).Z})),(0,o.kt)("p",{parentName:"div"},"Cliquez sur ",(0,o.kt)("strong",{parentName:"p"},"Enregistrer"),". Cette action cr\xe9e le client et vous am\xe8ne \xe0 l'onglet ",(0,o.kt)("strong",{parentName:"p"},"Param\xe8tres"),"."),(0,o.kt)("p",{parentName:"div"},"La partie suivante de la liste des param\xe8tres:"),(0,o.kt)("ol",{parentName:"div"},(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"Nom")," - ",(0,o.kt)("inlineCode",{parentName:"li"},"Casdoor"),". Ceci est utilis\xe9 uniquement pour afficher un nom convivial aux utilisateurs de Keycloak dans l'interface de KeyCloak. Peut utiliser n'importe quel nom que vous aimez."),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"Activ\xe9")," - S\xe9lection activ\xe9e."),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"Include Authn Statement")," - Select."),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"Sign Documents")," - S\xe9lectionnez on."),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"Sign Assertions")," - S\xe9lectionn\xe9."),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"Chiffrer les assertions")," - S\xe9lectionner."),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"Signature du client requise")," - S\xe9lectionner."),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"Forcer Name ID Format")," - Select."),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"Name ID Format")," - S\xe9lectionner le nom d'utilisateur."),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"URIs de redirection valides")," - Ajouter ",(0,o.kt)("inlineCode",{parentName:"li"},"http://localhost:8000/api/acs"),"."),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"Master SAML Processing URL")," - ",(0,o.kt)("inlineCode",{parentName:"li"},"http://localhost:8000/api/acs"),"."),(0,o.kt)("li",{parentName:"ol"},"Configuration des points d'extr\xe9mit\xe9 SAML de grains fins",(0,o.kt)("ol",{parentName:"li"},(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"Assertion Consumer Service POST Liaison URL")," - ",(0,o.kt)("inlineCode",{parentName:"li"},"http://localhost:8000/api/acs"),"."),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"Assertion Consumer Service Redirect Binding URL")," - ",(0,o.kt)("inlineCode",{parentName:"li"},"http://localhost:8000/api/acs"),".")))),(0,o.kt)("p",{parentName:"div"},"Enregistrer la configuration."),(0,o.kt)("p",{parentName:"div"},(0,o.kt)("img",{alt:"Configure keycloak client",src:n(2661).Z})))),(0,o.kt)("p",null,"Cliquez sur l'onglet ",(0,o.kt)("strong",{parentName:"p"},"Installation"),"."),(0,o.kt)("p",null,"Pour le Keycloak <= 5.0.0, s\xe9lectionnez Option Format - ",(0,o.kt)("strong",{parentName:"p"},"SAML Metadata IDPSSODescriptor")," et copiez les m\xe9tadonn\xe9es."),(0,o.kt)("p",null,"Pour Keycloak 6.0.0+, s\xe9lectionnez Option Format - ",(0,o.kt)("strong",{parentName:"p"},"Fichiers Mod Auth Mellon")," et cliquez sur ",(0,o.kt)("strong",{parentName:"p"},"T\xe9l\xe9charger"),". D\xe9compressez le fichier .zip t\xe9l\xe9charg\xe9, localisez ",(0,o.kt)("inlineCode",{parentName:"p"},"idp-metadata.xml")," et copiez les m\xe9tadonn\xe9es."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"T\xe9l\xe9charger les m\xe9tadonn\xe9es",src:n(2302).Z})),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Copier les m\xe9tadonn\xe9es",src:n(3962).Z})),(0,o.kt)("h2",{id:"configurer-dans-casdoor"},"Configurer dans Casdoor"),(0,o.kt)("p",null,"Cr\xe9er un nouveau fournisseur dans Casdoor."),(0,o.kt)("p",null,"S\xe9lectionnez la cat\xe9gorie comme ",(0,o.kt)("strong",{parentName:"p"},"SAML"),", tapez comme ",(0,o.kt)("strong",{parentName:"p"},"Keycloak"),". Copiez le contenu des m\xe9tadonn\xe9es et collez-le dans l'entr\xe9e ",(0,o.kt)("strong",{parentName:"p"},"M\xe9tadonn\xe9es"),". Les valeurs de ",(0,o.kt)("strong",{parentName:"p"},"Endpoint"),", ",(0,o.kt)("strong",{parentName:"p"},"IdP")," et ",(0,o.kt)("strong",{parentName:"p"},"URL d'\xe9metteur")," seront g\xe9n\xe9r\xe9s automatiquement apr\xe8s avoir cliqu\xe9 sur le bouton ",(0,o.kt)("strong",{parentName:"p"},"Analyser"),". Enfin, cliquez sur le bouton ",(0,o.kt)("strong",{parentName:"p"},"Enregistrer"),"."),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Si vous activez l'option ",(0,o.kt)("strong",{parentName:"h5"},"Signature Client requise")," dans Keycloak et t\xe9l\xe9chargez le certificat, veuillez activer l'option ",(0,o.kt)("strong",{parentName:"h5"},"Demande de signe")," dans Casdoor. :::")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},(0,o.kt)("img",{alt:"Fournisseur de porte",src:n(2294).Z})),(0,o.kt)("p",{parentName:"div"},"Modifiez l'application que vous voulez configurer dans Casdoor. S\xe9lectionnez le fournisseur vient d'ajouter et cliquez sur le bouton ",(0,o.kt)("strong",{parentName:"p"},"Enregistrer"),"."),(0,o.kt)("p",{parentName:"div"},(0,o.kt)("img",{alt:"Ajouter un fournisseur pour l&#39;application",src:n(6757).Z})),(0,o.kt)("h2",{parentName:"div",id:"valider-leffet"},"Valider l'effet"),(0,o.kt)("p",{parentName:"div"},"Allez \xe0 l'application que vous venez de configurer et vous pouvez trouver qu'il y a une ic\xf4ne Keycloak dans la page de connexion."),(0,o.kt)("p",{parentName:"div"},"Cliquez sur l'ic\xf4ne et passez \xe0 la page de connexion Keycloak, puis connectez-vous avec succ\xe8s \xe0 la Casdoor apr\xe8s authentification."),(0,o.kt)("p",{parentName:"div"},(0,o.kt)("img",{alt:"Connexion \xe0 Casdoor",src:n(8079).Z})))))}d.isMDXComponent=!0},6757:function(e,t,n){"use strict";t.Z=n.p+"assets/images/keycloak_casdoor_app-c3afe561f88f7c5ade9973f8aa706dec.png"},8079:function(e,t,n){"use strict";t.Z=n.p+"assets/images/keycloak_casdoor_login-5080e3bced4808bd768772ecfb15ca97.gif"},2294:function(e,t,n){"use strict";t.Z=n.p+"assets/images/keycloak_casdoor_provider-238d41bdb7a2ce7eab3252b45b8f7d63.png"},3749:function(e,t,n){"use strict";t.Z=n.p+"assets/images/keycloak_client_add-a22a58cfe1cac19aac7c471f4b95a391.png"},2661:function(e,t,n){"use strict";t.Z=n.p+"assets/images/keycloak_client_configure-d8a4520b9809494ac277da30d02a8d35.png"},3962:function(e,t,n){"use strict";t.Z=n.p+"assets/images/keycloak_client_copy-3233ceff3f6b91883873e5441c6e50fe.png"},2302:function(e,t,n){"use strict";t.Z=n.p+"assets/images/keycloak_client_install-e8ed45db439c33e32b2f46fbdc476f40.png"},3528:function(e,t,n){"use strict";t.Z=n.p+"assets/images/keycloak_realm-aa47ec9142083126d9c9f1ce79c75eac.png"},6865:function(e,t,n){"use strict";t.Z=n.p+"assets/images/keycloak_realm_add-9a27d681ede089b89474ebd0acc155c0.png"}}]);