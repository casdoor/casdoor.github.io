"use strict";(self.webpackChunkcasdoor_website=self.webpackChunkcasdoor_website||[]).push([[4310],{3905:(a,e,t)=>{t.d(e,{Zo:()=>c,kt:()=>d});var r=t(67294);function n(a,e,t){return e in a?Object.defineProperty(a,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[e]=t,a}function o(a,e){var t=Object.keys(a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(a);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),t.push.apply(t,r)}return t}function i(a){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?o(Object(t),!0).forEach((function(e){n(a,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(e){Object.defineProperty(a,e,Object.getOwnPropertyDescriptor(t,e))}))}return a}function l(a,e){if(null==a)return{};var t,r,n=function(a,e){if(null==a)return{};var t,r,n={},o=Object.keys(a);for(r=0;r<o.length;r++)t=o[r],e.indexOf(t)>=0||(n[t]=a[t]);return n}(a,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(a);for(r=0;r<o.length;r++)t=o[r],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(a,t)&&(n[t]=a[t])}return n}var s=r.createContext({}),p=function(a){var e=r.useContext(s),t=e;return a&&(t="function"==typeof a?a(e):i(i({},e),a)),t},c=function(a){var e=p(a.components);return r.createElement(s.Provider,{value:e},a.children)},u={inlineCode:"code",wrapper:function(a){var e=a.children;return r.createElement(r.Fragment,{},e)}},f=r.forwardRef((function(a,e){var t=a.components,n=a.mdxType,o=a.originalType,s=a.parentName,c=l(a,["components","mdxType","originalType","parentName"]),f=p(t),d=n,g=f["".concat(s,".").concat(d)]||f[d]||u[d]||o;return t?r.createElement(g,i(i({ref:e},c),{},{components:t})):r.createElement(g,i({ref:e},c))}));function d(a,e){var t=arguments,n=e&&e.mdxType;if("string"==typeof a||n){var o=t.length,i=new Array(o);i[0]=f;var l={};for(var s in e)hasOwnProperty.call(e,s)&&(l[s]=e[s]);l.originalType=a,l.mdxType="string"==typeof a?a:n,i[1]=l;for(var p=2;p<o;p++)i[p]=t[p];return r.createElement.apply(null,i)}return r.createElement.apply(null,t)}f.displayName="MDXCreateElement"},18402:(a,e,t)=>{t.r(e),t.d(e,{assets:()=>s,contentTitle:()=>i,default:()=>u,frontMatter:()=>o,metadata:()=>l,toc:()=>p});var r=t(87462),n=(t(67294),t(3905));const o={title:"Grafana",description:"\u5728 Grafana \u4e2d\u4f7f\u7528 Casdoor \u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1",keywords:["Grafana"],authors:["ComradeProgrammer"]},i=void 0,l={unversionedId:"integration/go/grafana",id:"integration/go/grafana",title:"Grafana",description:"\u5728 Grafana \u4e2d\u4f7f\u7528 Casdoor \u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1",source:"@site/i18n/zh/docusaurus-plugin-content-docs/current/integration/go/grafana.md",sourceDirName:"integration/go",slug:"/integration/go/grafana",permalink:"/zh/docs/integration/go/grafana",draft:!1,editUrl:"https://github.com/casdoor/casdoor-website/edit/master/docs/integration/go/grafana.md",tags:[],version:"current",frontMatter:{title:"Grafana",description:"\u5728 Grafana \u4e2d\u4f7f\u7528 Casdoor \u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1",keywords:["Grafana"],authors:["ComradeProgrammer"]},sidebar:"tutorialSidebar",previous:{title:"Gitea",permalink:"/zh/docs/integration/go/gitea"},next:{title:"MinIO",permalink:"/zh/docs/integration/go/minio"}},s={},p=[{value:"\u5728 Grafana \u4e2d\u4f7f\u7528 Casdoor \u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1",id:"\u5728-grafana-\u4e2d\u4f7f\u7528-casdoor-\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1",level:2},{value:"\u6b65\u9aa41\uff1a\u5728Casdoor\u4e2d\u4e3aGrafana\u521b\u5efa\u4e00\u4e2a\u5e94\u7528",id:"\u6b65\u9aa41\u5728casdoor\u4e2d\u4e3agrafana\u521b\u5efa\u4e00\u4e2a\u5e94\u7528",level:2},{value:"\u6b65\u9aa42\uff1a\u4fee\u6539Grafana\u7684\u914d\u7f6e",id:"\u6b65\u9aa42\u4fee\u6539grafana\u7684\u914d\u7f6e",level:2},{value:"\u5173\u4e8eHTTPS",id:"\u5173\u4e8ehttps",level:3},{value:"\u5173\u4e8e\u4f7f\u7528Casdoor\u767b\u5f55\u540e\u7684redirectURI",id:"\u5173\u4e8e\u4f7f\u7528casdoor\u767b\u5f55\u540e\u7684redirecturi",level:3},{value:"\u5173\u4e8e\u89d2\u8272\u6620\u5c04",id:"\u5173\u4e8e\u89d2\u8272\u6620\u5c04",level:3},{value:"\u6b65\u9aa43\uff1a\u67e5\u770b\u662f\u5426\u6709\u6548",id:"\u6b65\u9aa43\u67e5\u770b\u662f\u5426\u6709\u6548",level:2}],c={toc:p};function u(a){let{components:e,...o}=a;return(0,n.kt)("wrapper",(0,r.Z)({},c,o,{components:e,mdxType:"MDXLayout"}),(0,n.kt)("h2",{id:"\u5728-grafana-\u4e2d\u4f7f\u7528-casdoor-\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1"},"\u5728 Grafana \u4e2d\u4f7f\u7528 Casdoor \u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1"),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://grafana.com/oss/grafana/"},"Grafana"),"\u652f\u6301\u901a\u8fc7OAuth\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u3002 \u56e0\u6b64\uff0c\u7528\u6237\u4f7f\u7528Casdoor\u767b\u5f55Grafana\u975e\u5e38\u5bb9\u6613\u3002 \u53ea\u9700\u8981\u51e0\u4e2a\u6b65\u9aa4\u548c\u7b80\u5355\u7684\u914d\u7f6e\u5c31\u53ef\u4ee5\u5b9e\u73b0\u3002"),(0,n.kt)("p",null,"\u8fd9\u662f\u4e00\u4e2a\u5173\u4e8e\u5982\u4f55\u5728Grafana\u4e2d\u4f7f\u7528Casdoor\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u7684\u6559\u7a0b\u3002 \u5728\u60a8\u7ee7\u7eed\u4e4b\u524d\uff0c\u8bf7\u786e\u4fdd\u60a8\u5df2\u5b89\u88c5\u5e76\u8fd0\u884c\u4e86Grafana\u3002"),(0,n.kt)("h2",{id:"\u6b65\u9aa41\u5728casdoor\u4e2d\u4e3agrafana\u521b\u5efa\u4e00\u4e2a\u5e94\u7528"},"\u6b65\u9aa41\uff1a\u5728Casdoor\u4e2d\u4e3aGrafana\u521b\u5efa\u4e00\u4e2a\u5e94\u7528"),(0,n.kt)("p",null,"\u8fd9\u662f\u5728Casdoor\u4e2d\u521b\u5efa\u5e94\u7528\u7684\u4e00\u4e2a\u793a\u4f8b\uff1a"),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"\u5728Casdoor\u4e2d\u521b\u5efa\u4e00\u4e2a\u5e94\u7528",src:t(34709).Z,width:"1367",height:"810"})),(0,n.kt)("p",null,"\u8bf7\u590d\u5236\u5ba2\u6237\u7aef\u5bc6\u94a5\u548c\u5ba2\u6237\u7aefID\u4ee5\u8fdb\u884c\u4e0b\u4e00\u6b65\u64cd\u4f5c\u3002"),(0,n.kt)("p",null,"\u8bf7\u6dfb\u52a0Grafana\u7684\u56de\u8c03URL\u3002 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cGrafana\u7684OAuth\u56de\u8c03\u662f",(0,n.kt)("inlineCode",{parentName:"p"},"/login/generic_oauth"),"\u3002 \u6240\u4ee5\u8bf7\u6b63\u786e\u5730\u8fde\u63a5\u8fd9\u4e2aURL\u3002"),(0,n.kt)("h2",{id:"\u6b65\u9aa42\u4fee\u6539grafana\u7684\u914d\u7f6e"},"\u6b65\u9aa42\uff1a\u4fee\u6539Grafana\u7684\u914d\u7f6e"),(0,n.kt)("p",null,"\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cOAuth\u7684\u914d\u7f6e\u6587\u4ef6\u4f4d\u4e8eGrafana\u7684\u5de5\u4f5c\u76ee\u5f55\u4e2d\u7684",(0,n.kt)("inlineCode",{parentName:"p"},"conf/defaults.ini"),"\u3002"),(0,n.kt)("p",null,"\u8bf7\u627e\u5230\u90e8\u5206",(0,n.kt)("inlineCode",{parentName:"p"},"[auth.generic_oauth]"),"\u5e76\u4fee\u6539\u4ee5\u4e0b\u5b57\u6bb5\uff1a"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-ini"},"[auth.generic_oauth]\nname = Casdoor\nicon = signin\nenabled = true\nallow_sign_up = true\nclient_id = <\u6765\u81ea\u4e0a\u4e00\u6b65\u7684\u5ba2\u6237\u7aefID>\nclient_secret = <\u6765\u81ea\u4e0a\u4e00\u6b65\u7684\u5ba2\u6237\u7aef\u79d8\u5bc6>\nauth_url = <Casdoor\u7aef\u70b9>/login/oauth/authorize\ntoken_url = <Casdoor\u7aef\u70b9>/api/login/oauth/access_token\n\n")),(0,n.kt)("h3",{id:"\u5173\u4e8ehttps"},"\u5173\u4e8eHTTPS"),(0,n.kt)("p",null,"\u5982\u679c\u4f60\u4e0d\u5e0c\u671b\u4e3aCasdoor\u542f\u7528HTTPS\uff0c\u6216\u8005\u4f60\u5728\u6ca1\u6709\u542f\u7528HTTPS\u7684\u60c5\u51b5\u4e0b\u90e8\u7f72Grafana\uff0c\u8bf7\u540c\u65f6\u8bbe\u7f6e",(0,n.kt)("inlineCode",{parentName:"p"},"tls_skip_verify_insecure = true"),"\u3002"),(0,n.kt)("h3",{id:"\u5173\u4e8e\u4f7f\u7528casdoor\u767b\u5f55\u540e\u7684redirecturi"},"\u5173\u4e8e\u4f7f\u7528Casdoor\u767b\u5f55\u540e\u7684redirectURI"),(0,n.kt)("p",null,"\u5982\u679c\u5728Grafana\u4e2d\u4f7f\u7528Casdoor\u767b\u5f55\u540e\u91cd\u5b9a\u5411URI\u4e0d\u6b63\u786e\uff0c\u60a8\u53ef\u80fd\u9700\u8981\u914d\u7f6e",(0,n.kt)("a",{parentName:"p",href:"https://stackoverflow.com/a/69814805"},"root_url"),"\u3002"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-ini"},"[server]\nhttp_port = 3000\n# \u7528\u4e8e\u4ece\u6d4f\u89c8\u5668\u8bbf\u95eeGrafana\u7684\u516c\u5f00\u9762\u5411\u7684\u57df\u540d\ndomain = <\u4f60\u7684IP\u5730\u5740>\n# \u5b8c\u6574\u7684\u516c\u5f00\u9762\u5411\u7684URL\nroot_url = %(protocol)s://%(domain)s:%(http_port)s/\n")),(0,n.kt)("p",null,"\u76f8\u5173\u94fe\u63a5\uff1a"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("a",{parentName:"p",href:"https://grafana.com/docs/grafana/latest/setup-grafana/configure-grafana/#root_url"},"Grafana \u6587\u6863"))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("a",{parentName:"p",href:"https://github.com/grafana/grafana/blob/main/conf/defaults.ini"},"Grafana \u9ed8\u8ba4\u7684ini")))),(0,n.kt)("h3",{id:"\u5173\u4e8e\u89d2\u8272\u6620\u5c04"},"\u5173\u4e8e\u89d2\u8272\u6620\u5c04"),(0,n.kt)("p",null,"\u60a8\u53ef\u80fd\u5e0c\u671b\u914d\u7f6e",(0,n.kt)("inlineCode",{parentName:"p"},"role_attribute_path"),"\uff0c\u901a\u8fc7",(0,n.kt)("a",{parentName:"p",href:"https://grafana.com/docs/grafana/latest/setup-grafana/configure-security/configure-authentication/generic-oauth/#role-mapping"},"role_attribute_path"),"\u5c06\u60a8\u7684\u7528\u6237\u89d2\u8272\u6620\u5c04\u5230Grafana\u3002"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-ini"},"[auth.generic_oauth]\nrole_attribute_path = contains(roles[*].name, 'admin') && 'Admin' || contains(roles[*].name, 'editor') && 'Editor' || 'Viewer'\nrole_attribute_strict = true\nallow_assign_grafana_admin = true\n")),(0,n.kt)("p",null,"\u8fd9\u91cc\u7684",(0,n.kt)("inlineCode",{parentName:"p"},"role_attribute_path"),"\u540e\u7684JMESPath\u8868\u8fbe\u5f0f\u975e\u5e38\u91cd\u8981\u3002 \u8bf7\u53c2\u8003Grafana\u6587\u6863\u3002"),(0,n.kt)("h2",{id:"\u6b65\u9aa43\u67e5\u770b\u662f\u5426\u6709\u6548"},"\u6b65\u9aa43\uff1a\u67e5\u770b\u662f\u5426\u6709\u6548"),(0,n.kt)("p",null,"\u5173\u95edGrafana\u5e76\u91cd\u65b0\u542f\u52a8\u5b83\u3002"),(0,n.kt)("p",null,"\u524d\u5f80\u767b\u5f55\u9875\u9762\u3002 \u4f60\u5e94\u8be5\u4f1a\u770b\u5230\u7c7b\u4f3c\u8fd9\u6837\u7684\u4e1c\u897f\uff1a"),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"\u6700\u7ec8\u7ed3\u679c",src:t(60591).Z,width:"1384",height:"739"})))}u.isMDXComponent=!0},34709:(a,e,t)=>{t.d(e,{Z:()=>r});const r=t.p+"assets/images/grafana_1-9f197ebf06da48585fe18ce1d66ce212.png"},60591:(a,e,t)=>{t.d(e,{Z:()=>r});const r=t.p+"assets/images/grafana_2-5136a37a917e1c899feedb23e218fa13.png"}}]);