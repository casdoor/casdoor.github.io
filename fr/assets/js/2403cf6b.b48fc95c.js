"use strict";(self.webpackChunkcasdoor_website=self.webpackChunkcasdoor_website||[]).push([[8455],{3905:(e,t,r)=>{r.d(t,{Zo:()=>p,kt:()=>m});var a=r(67294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},o=Object.keys(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var l=a.createContext({}),u=function(e){var t=a.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},p=function(e){var t=u(e.components);return a.createElement(l.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var r=e.components,n=e.mdxType,o=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),d=u(r),m=n,v=d["".concat(l,".").concat(m)]||d[m]||c[m]||o;return r?a.createElement(v,i(i({ref:t},p),{},{components:r})):a.createElement(v,i({ref:t},p))}));function m(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=r.length,i=new Array(o);i[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:n,i[1]=s;for(var u=2;u<o;u++)i[u]=r[u];return a.createElement.apply(null,i)}return a.createElement.apply(null,r)}d.displayName="MDXCreateElement"},85162:(e,t,r)=>{r.d(t,{Z:()=>i});var a=r(67294),n=r(86010);const o="tabItem_Ymn6";function i(e){let{children:t,hidden:r,className:i}=e;return a.createElement("div",{role:"tabpanel",className:(0,n.Z)(o,i),hidden:r},t)}},74866:(e,t,r)=>{r.d(t,{Z:()=>C});var a=r(87462),n=r(67294),o=r(86010),i=r(12466),s=r(76775),l=r(91980),u=r(67392),p=r(50012);function c(e){return function(e){var t;return(null==(t=n.Children.map(e,(e=>{if(!e||(0,n.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})))?void 0:t.filter(Boolean))??[]}(e).map((e=>{let{props:{value:t,label:r,attributes:a,default:n}}=e;return{value:t,label:r,attributes:a,default:n}}))}function d(e){const{values:t,children:r}=e;return(0,n.useMemo)((()=>{const e=t??c(r);return function(e){const t=(0,u.l)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,r])}function m(e){let{value:t,tabValues:r}=e;return r.some((e=>e.value===t))}function v(e){let{queryString:t=!1,groupId:r}=e;const a=(0,s.k6)(),o=function(e){let{queryString:t=!1,groupId:r}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!r)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return r??null}({queryString:t,groupId:r});return[(0,l._X)(o),(0,n.useCallback)((e=>{if(!o)return;const t=new URLSearchParams(a.location.search);t.set(o,e),a.replace({...a.location,search:t.toString()})}),[o,a])]}function g(e){const{defaultValue:t,queryString:r=!1,groupId:a}=e,o=d(e),[i,s]=(0,n.useState)((()=>function(e){let{defaultValue:t,tabValues:r}=e;if(0===r.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!m({value:t,tabValues:r}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${r.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const a=r.find((e=>e.default))??r[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:t,tabValues:o}))),[l,u]=v({queryString:r,groupId:a}),[c,g]=function(e){let{groupId:t}=e;const r=function(e){return e?`docusaurus.tab.${e}`:null}(t),[a,o]=(0,p.Nk)(r);return[a,(0,n.useCallback)((e=>{r&&o.set(e)}),[r,o])]}({groupId:a}),k=(()=>{const e=l??c;return m({value:e,tabValues:o})?e:null})();(0,n.useLayoutEffect)((()=>{k&&s(k)}),[k]);return{selectedValue:i,selectValue:(0,n.useCallback)((e=>{if(!m({value:e,tabValues:o}))throw new Error(`Can't select invalid tab value=${e}`);s(e),u(e),g(e)}),[u,g,o]),tabValues:o}}var k=r(72389);const f="tabList__CuJ",b="tabItem_LNqP";function h(e){let{className:t,block:r,selectedValue:s,selectValue:l,tabValues:u}=e;const p=[],{blockElementScrollPositionUntilNextRender:c}=(0,i.o5)(),d=e=>{const t=e.currentTarget,r=p.indexOf(t),a=u[r].value;a!==s&&(c(t),l(a))},m=e=>{var t;let r=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const t=p.indexOf(e.currentTarget)+1;r=p[t]??p[0];break}case"ArrowLeft":{const t=p.indexOf(e.currentTarget)-1;r=p[t]??p[p.length-1];break}}null==(t=r)||t.focus()};return n.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,o.Z)("tabs",{"tabs--block":r},t)},u.map((e=>{let{value:t,label:r,attributes:i}=e;return n.createElement("li",(0,a.Z)({role:"tab",tabIndex:s===t?0:-1,"aria-selected":s===t,key:t,ref:e=>p.push(e),onKeyDown:m,onClick:d},i,{className:(0,o.Z)("tabs__item",b,null==i?void 0:i.className,{"tabs__item--active":s===t})}),r??t)})))}function N(e){let{lazy:t,children:r,selectedValue:a}=e;const o=(Array.isArray(r)?r:[r]).filter(Boolean);if(t){const e=o.find((e=>e.props.value===a));return e?(0,n.cloneElement)(e,{className:"margin-top--md"}):null}return n.createElement("div",{className:"margin-top--md"},o.map(((e,t)=>(0,n.cloneElement)(e,{key:t,hidden:e.props.value!==a}))))}function y(e){const t=g(e);return n.createElement("div",{className:(0,o.Z)("tabs-container",f)},n.createElement(h,(0,a.Z)({},e,t)),n.createElement(N,(0,a.Z)({},e,t)))}function C(e){const t=(0,k.Z)();return n.createElement(y,(0,a.Z)({key:String(t)},e))}},92663:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>p,contentTitle:()=>l,default:()=>m,frontMatter:()=>s,metadata:()=>u,toc:()=>c});var a=r(87462),n=(r(67294),r(3905)),o=r(74866),i=r(85162);const s={title:"Spring Boot",description:"Utiliser Casdoor dans un projet Spring Boot",keywords:["Spring Boot"],authors:["seriouszyx"]},l=void 0,u={unversionedId:"integration/java/spring-boot",id:"integration/java/spring-boot",title:"Spring Boot",description:"Utiliser Casdoor dans un projet Spring Boot",source:"@site/i18n/fr/docusaurus-plugin-content-docs/current/integration/java/spring-boot.mdx",sourceDirName:"integration/java",slug:"/integration/java/spring-boot",permalink:"/fr/docs/integration/java/spring-boot",draft:!1,editUrl:"https://github.com/casdoor/casdoor-website/edit/master/docs/integration/java/spring-boot.mdx",tags:[],version:"current",frontMatter:{title:"Spring Boot",description:"Utiliser Casdoor dans un projet Spring Boot",keywords:["Spring Boot"],authors:["seriouszyx"]},sidebar:"tutorialSidebar",previous:{title:"Java",permalink:"/fr/docs/category/java"},next:{title:"Spring Cloud",permalink:"/fr/docs/integration/java/spring-cloud"}},p={},c=[{value:"\xc9tape 1 : D\xe9ployer Casdoor",id:"\xe9tape-1--d\xe9ployer-casdoor",level:2},{value:"\xc9tape 2 : Importer casdoor-spring-boot-starter",id:"\xe9tape-2--importer-casdoor-spring-boot-starter",level:2},{value:"\xc9tape 3 : Initialiser la Configuration",id:"\xe9tape-3--initialiser-la-configuration",level:2},{value:"\xc9tape 4 : Rediriger vers la Page de Connexion",id:"\xe9tape-4--rediriger-vers-la-page-de-connexion",level:2},{value:"\xc9tape 5 : Obtenir le Token et l&#39;Analyser",id:"\xe9tape-5--obtenir-le-token-et-lanalyser",level:2},{value:"Services",id:"services",level:2},{value:"Plus de Ressources",id:"plus-de-ressources",level:2}],d={toc:c};function m(e){let{components:t,...r}=e;return(0,n.kt)("wrapper",(0,a.Z)({},d,r,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://github.com/casdoor/casdoor-spring-boot-example"},"casdoor-spring-boot-example")," est un exemple de comment utiliser ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/casdoor/casdoor-spring-boot-starter"},"casdoor-spring-boot-starter")," dans un projet Spring Boot. Nous allons vous guider \xe0 travers les \xe9tapes ci-dessous."),(0,n.kt)("h2",{id:"\xe9tape-1--d\xe9ployer-casdoor"},"\xc9tape 1 : D\xe9ployer Casdoor"),(0,n.kt)("p",null,"Tout d'abord, Casdoor doit \xeatre d\xe9ploy\xe9."),(0,n.kt)("p",null,"Vous pouvez vous r\xe9f\xe9rer \xe0 la documentation officielle de Casdoor pour l'",(0,n.kt)("a",{parentName:"p",href:"/docs/basic/server-installation"},"Installation du Serveur"),". Veuillez d\xe9ployer votre instance Casdoor en ",(0,n.kt)("strong",{parentName:"p"},"mode production"),"."),(0,n.kt)("p",null,"Apr\xe8s un d\xe9ploiement r\xe9ussi, assurez-vous de ce qui suit :"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Ouvrez votre navigateur pr\xe9f\xe9r\xe9 et visitez ",(0,n.kt)("strong",{parentName:"li"},(0,n.kt)("a",{parentName:"strong",href:"http://localhost:8000"},"http://localhost:8000")),". Vous verrez la page de connexion de Casdoor."),(0,n.kt)("li",{parentName:"ul"},"Testez la fonctionnalit\xe9 de connexion en entrant ",(0,n.kt)("inlineCode",{parentName:"li"},"admin")," comme nom d'utilisateur et ",(0,n.kt)("inlineCode",{parentName:"li"},"123")," comme mot de passe.")),(0,n.kt)("p",null,"Maintenant, vous pouvez rapidement impl\xe9menter une page de connexion bas\xe9e sur Casdoor dans votre propre application en suivant les \xe9tapes suivantes."),(0,n.kt)("h2",{id:"\xe9tape-2--importer-casdoor-spring-boot-starter"},"\xc9tape 2 : Importer casdoor-spring-boot-starter"),(0,n.kt)("p",null,"Vous pouvez importer le casdoor-spring-boot-starter en utilisant Maven ou Gradle."),(0,n.kt)(o.Z,{defaultValue:"maven",groupId:"import-sdk",values:[{label:"Maven",value:"maven"},{label:"Gradle",value:"gradle"}],mdxType:"Tabs"},(0,n.kt)(i.Z,{value:"maven",mdxType:"TabItem"},(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-xml"},"\x3c!-- https://mvnrepository.com/artifact/org.casbin/casdoor-spring-boot-starter --\x3e\n<dependency>\n    <groupId>org.casbin</groupId>\n    <artifactId>casdoor-spring-boot-starter</artifactId>\n    <version>1.x.y</version>\n</dependency>\n"))),(0,n.kt)(i.Z,{value:"gradle",mdxType:"TabItem"},(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-xml"},"// https://mvnrepository.com/artifact/org.casbin/casdoor-spring-boot-starter\nimplementation group: 'org.casbin', name: 'casdoor-spring-boot-starter', version: '1.x.y'\n")))),(0,n.kt)("h2",{id:"\xe9tape-3--initialiser-la-configuration"},"\xc9tape 3 : Initialiser la Configuration"),(0,n.kt)("p",null,"L'initialisation n\xe9cessite 6 param\xe8tres de type cha\xeene de caract\xe8res dans l'ordre suivant :\n| Nom              | Requis | Description                                           |\n| ---------------- | ------ | ----------------------------------------------------- |\n| endpoint         | Oui    | URL du serveur Casdoor, comme ",(0,n.kt)("inlineCode",{parentName:"p"},"http://localhost:8000")," |\n| clientId         | Oui    | ID client de l'application                            |\n| clientSecret     | Oui    | Secret client de l'application                        |\n| certificate      | Oui    | Certificat de l'application                           |\n| organizationName | Oui    | Organisation de l'application                         |\n| applicationName  | Non    | Nom de l'application                                  |\nVous pouvez utiliser des propri\xe9t\xe9s Java ou des fichiers YAML pour l'initialisation."),(0,n.kt)(o.Z,{defaultValue:"properties",groupId:"configuration",values:[{label:"Properties",value:"properties"},{label:"YML",value:"yml"}],mdxType:"Tabs"},(0,n.kt)(i.Z,{value:"properties",mdxType:"TabItem"},(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-properties"},"casdoor.endpoint = http://localhost:8000\ncasdoor.clientId = <client-id>\ncasdoor.clientSecret = <client-secret>\ncasdoor.certificate = <certificate>\ncasdoor.organizationName = built-in\ncasdoor.applicationName = app-built-in\n"))),(0,n.kt)(i.Z,{value:"yml",mdxType:"TabItem"},(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-yaml"},"casdoor:\n  endpoint: http://localhost:8000\n  client-id: <client-id>\n  client-secret: <client-secret>\n  certificate: <certificate>\n  organization-name: built-in\n  application-name: app-built-in\n")))),(0,n.kt)("admonition",{type:"caution"},(0,n.kt)("p",{parentName:"admonition"},"Remplacez les valeurs de configuration par celles de votre propre instance Casdoor, en particulier le ",(0,n.kt)("inlineCode",{parentName:"p"},"clientId"),", ",(0,n.kt)("inlineCode",{parentName:"p"},"clientSecret"),", et ",(0,n.kt)("inlineCode",{parentName:"p"},"jwtPublicKey"),".")),(0,n.kt)("h2",{id:"\xe9tape-4--rediriger-vers-la-page-de-connexion"},"\xc9tape 4 : Rediriger vers la Page de Connexion"),(0,n.kt)("p",null,"Lorsque vous avez besoin d'authentifier les utilisateurs qui acc\xe8dent \xe0 votre application, vous pouvez envoyer l'URL cible et rediriger vers la page de connexion fournie par Casdoor.\nAssurez-vous d'avoir ajout\xe9 l'URL de rappel (par exemple ",(0,n.kt)("strong",{parentName:"p"},(0,n.kt)("a",{parentName:"strong",href:"http://localhost:8080/login"},"http://localhost:8080/login")),") dans la configuration de l'application au pr\xe9alable."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-java"},'@Resource\nprivate CasdoorAuthService casdoorAuthService;\n\n@RequestMapping("toLogin")\npublic String toLogin() {\n    return "redirect:" + casdoorAuthService.getSigninUrl("http://localhost:8080/login");\n}\n')),(0,n.kt)("h2",{id:"\xe9tape-5--obtenir-le-token-et-lanalyser"},"\xc9tape 5 : Obtenir le Token et l'Analyser"),(0,n.kt)("p",null,"Apr\xe8s que la v\xe9rification Casdoor soit pass\xe9e, elle redirigera vers votre application avec le code et l'\xe9tat."),(0,n.kt)("p",null,"Vous pouvez obtenir le code et appeler la m\xe9thode ",(0,n.kt)("inlineCode",{parentName:"p"},"getOAuthToken"),", puis analyser le token JWT."),(0,n.kt)("p",null,(0,n.kt)("inlineCode",{parentName:"p"},"CasdoorUser")," contient les informations de base sur l'utilisateur fournies par Casdoor. Vous pouvez l'utiliser pour d\xe9finir la session dans votre application."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-java"},'@RequestMapping("login")\npublic String login(String code, String state, HttpServletRequest request) {\n    String token = "";\n    CasdoorUser user = null;\n    try {\n        token = casdoorAuthService.getOAuthToken(code, state);\n        user = casdoorAuthService.parseJwtToken(token);\n    } catch (CasdoorAuthException e) {\n        e.printStackTrace();\n    }\n    HttpSession session = request.getSession();\n    session.setAttribute("casdoorUser", user);\n    return "redirect:/";\n}\n')),(0,n.kt)("h2",{id:"services"},"Services"),(0,n.kt)("p",null,"Des exemples d'API sont montr\xe9s ci-dessous :"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"CasdoorAuthService",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},'String token = casdoorAuthService.getOAuthToken(code, "app-built-in");')),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"CasdoorUser casdoorUser = casdoorAuthService.parseJwtToken(token);")))),(0,n.kt)("li",{parentName:"ul"},"CasdoorUserService",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},'CasdoorUser casdoorUser = casdoorUserService.getUser("admin");')),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},'CasdoorUser casdoorUser = casdoorUserService.getUserByEmail("admin@example.com");')),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"CasdoorUser[] casdoorUsers = casdoorUserService.getUsers();")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},'CasdoorUser[] casdoorUsers = casdoorUserService.getSortedUsers("created_time", 5);')),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},'int count = casdoorUserService.getUserCount("0");')),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"CasdoorResponse response = casdoorUserService.addUser(user);")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"CasdoorResponse response = casdoorUserService.updateUser(user);")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"CasdoorResponse response = casdoorUserService.deleteUser(user);")))),(0,n.kt)("li",{parentName:"ul"},"CasdoorEmailService",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"CasdoorResponse response = casdoorEmailService.sendEmail(title, content, sender, receiver);")))),(0,n.kt)("li",{parentName:"ul"},"CasdoorSmsService",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"CasdoorResponse response = casdoorSmsService.sendSms(randomCode(), receiver);")))),(0,n.kt)("li",{parentName:"ul"},"CasdoorResourceService",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"CasdoorResponse response = casdoorResourceService.uploadResource(user, tag, parent, fullFilePath, file);")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"CasdoorResponse response = casdoorResourceService.deleteResource(file.getName());"))))),(0,n.kt)("h2",{id:"plus-de-ressources"},"Plus de Ressources"),(0,n.kt)("p",null,"Vous pouvez explorer les projets/docs suivants pour en savoir plus sur l'int\xe9gration de Java avec Casdoor :"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://github.com/casdoor/casdoor-java-sdk"},"casdoor-java-sdk")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://github.com/casdoor/casdoor-spring-boot-starter"},"casdoor-spring-boot-starter")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://github.com/casdoor/casdoor-spring-boot-example"},"casdoor-spring-boot-example")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/docs/integration/java/spring-security/spring-security-oauth"},"casdoor-spring-security-example")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/docs/integration/java/spring-security/spring-security-filter"},"casdoor-spring-security-react-example")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://github.com/casdoor/casdoor-spring-boot-shiro-example"},"casdoor-spring-boot-shiro-example"))))}m.isMDXComponent=!0}}]);