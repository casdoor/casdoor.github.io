"use strict";(self.webpackChunkcasdoor_website=self.webpackChunkcasdoor_website||[]).push([[1315],{3905:function(t,e,a){a.d(e,{Zo:function(){return p},kt:function(){return m}});var n=a(67294);function o(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function r(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function i(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?r(Object(a),!0).forEach((function(e){o(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function l(t,e){if(null==t)return{};var a,n,o=function(t,e){if(null==t)return{};var a,n,o={},r=Object.keys(t);for(n=0;n<r.length;n++)a=r[n],e.indexOf(a)>=0||(o[a]=t[a]);return o}(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(n=0;n<r.length;n++)a=r[n],e.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(t,a)&&(o[a]=t[a])}return o}var d=n.createContext({}),s=function(t){var e=n.useContext(d),a=e;return t&&(a="function"==typeof t?t(e):i(i({},e),t)),a},p=function(t){var e=s(t.components);return n.createElement(d.Provider,{value:e},t.children)},c={inlineCode:"code",wrapper:function(t){var e=t.children;return n.createElement(n.Fragment,{},e)}},u=n.forwardRef((function(t,e){var a=t.components,o=t.mdxType,r=t.originalType,d=t.parentName,p=l(t,["components","mdxType","originalType","parentName"]),u=s(a),m=o,f=u["".concat(d,".").concat(m)]||u[m]||c[m]||r;return a?n.createElement(f,i(i({ref:e},p),{},{components:a})):n.createElement(f,i({ref:e},p))}));function m(t,e){var a=arguments,o=e&&e.mdxType;if("string"==typeof t||o){var r=a.length,i=new Array(r);i[0]=u;var l={};for(var d in e)hasOwnProperty.call(e,d)&&(l[d]=e[d]);l.originalType=t,l.mdxType="string"==typeof t?t:o,i[1]=l;for(var s=2;s<r;s++)i[s]=a[s];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}u.displayName="MDXCreateElement"},71188:function(t,e,a){a.r(e),a.d(e,{assets:function(){return p},contentTitle:function(){return d},default:function(){return m},frontMatter:function(){return l},metadata:function(){return s},toc:function(){return c}});var n=a(83117),o=a(80102),r=(a(67294),a(3905)),i=["components"],l={title:"Data Initialization",description:"How to initialize Casdoor data from files",keywords:["data initialization","deployment","Intranet"]},d=void 0,s={unversionedId:"deployment/data-initialization",id:"deployment/data-initialization",title:"Data Initialization",description:"How to initialize Casdoor data from files",source:"@site/i18n/zh/docusaurus-plugin-content-docs/current/deployment/data-initialization.md",sourceDirName:"deployment",slug:"/deployment/data-initialization",permalink:"/zh/docs/deployment/data-initialization",draft:!1,editUrl:"https://crowdin.com/project/casdoor-website/zh-CN",tags:[],version:"current",frontMatter:{title:"Data Initialization",description:"How to initialize Casdoor data from files",keywords:["data initialization","deployment","Intranet"]},sidebar:"tutorialSidebar",previous:{title:"Casdoor\u516c\u5171API",permalink:"/zh/docs/basic/public-api"},next:{title:"Hosting Static Files in CDN",permalink:"/zh/docs/deployment/deploy-cdn"}},p={},c=[{value:"How to use",id:"how-to-use",level:2},{value:"Docker",id:"docker",level:3},{value:"Kubernetes",id:"kubernetes",level:3},{value:"File details",id:"file-details",level:2}],u={toc:c};function m(t){var e=t.components,a=(0,o.Z)(t,i);return(0,r.kt)("wrapper",(0,n.Z)({},u,a,{components:e,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"If you are deploying Casdoor with other services as a whole application, you may want to provide an ",(0,r.kt)("strong",{parentName:"p"},"out-of-box")," feature for users (User can directly use the application without any configuration)."),(0,r.kt)("p",null,"For such situation, you can use data initialization to register your service in Casdoor through one configuration file. This file can be pre-defined or dynamically generated by your owner service."),(0,r.kt)("h2",{id:"how-to-use"},"How to use"),(0,r.kt)("p",null,"If there is one configuration file named as ",(0,r.kt)("inlineCode",{parentName:"p"},"init_data.json")," at the root directory of Casdoor, it will be used to initialize data in Casdoor. ",(0,r.kt)("strong",{parentName:"p"},"What you should do is just to put this file at the root directory where Casdoor will run.")),(0,r.kt)("p",null,"If you use official docker image of Casdoor, the following are some scripts that can help you to mount ",(0,r.kt)("inlineCode",{parentName:"p"},"init_data.json")," into the container."),(0,r.kt)("h3",{id:"docker"},"Docker"),(0,r.kt)("p",null,"If you deploy Casdoor with docker, you can use the ",(0,r.kt)("inlineCode",{parentName:"p"},"volume")," to mount ",(0,r.kt)("inlineCode",{parentName:"p"},"init_data.json")," into the container."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"docker run ... -v /path/to/init_data.json:/init_data.json\n")),(0,r.kt)("h3",{id:"kubernetes"},"Kubernetes"),(0,r.kt)("p",null,"If you deploy Casdoor with kubernetes, you can use the ",(0,r.kt)("inlineCode",{parentName:"p"},"configmap")," to store ",(0,r.kt)("inlineCode",{parentName:"p"},"init_data.json"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"apiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: casdoor-init-data\ndata:\n  init_data.json:\n")),(0,r.kt)("p",null,"You can mount the data into Casdoor ",(0,r.kt)("inlineCode",{parentName:"p"},"pods")," by mounting the ",(0,r.kt)("inlineCode",{parentName:"p"},"configmap"),". You may modify your ",(0,r.kt)("inlineCode",{parentName:"p"},"deployment")," as follows:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"apiVersion: apps/v1\nkind: Deployment\n...\nspec:\n  template:\n    ...\n    spec:\n      containers:\n      ...\n        volumeMounts:\n        - mountPath: /init_data.json\n          name: casdoor-init-data-volume\n          subPath: init_data.json\n      volumes:\n      - configMap:\n          name: casdoor-init-data\n        name: casdoor-init-data-volume\n")),(0,r.kt)("h2",{id:"file-details"},"File details"),(0,r.kt)("p",null,"There is already a template named ",(0,r.kt)("inlineCode",{parentName:"p"},"init_data.json.template")," at the root directory of Casdoor repository. You can refer to this file to customize your initilization."),(0,r.kt)("p",null,"The following is the Go struct of each part mapping to and their documentation:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Object"),(0,r.kt)("th",{parentName:"tr",align:null},"Go Struct"),(0,r.kt)("th",{parentName:"tr",align:null},"Documentation"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"organizations"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://github.com/casdoor/casdoor/blob/2fec3f72ae9a38891a951e55e088b4967cdf4836/object/organization.go#L32"},"stuct")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://casdoor.org/docs/organization/overview"},"doc"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"applications"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://github.com/casdoor/casdoor/blob/2fec3f72ae/object/application.go#L34"},"stuct")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://casdoor.org/docs/application/overview"},"doc"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"users"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://github.com/casdoor/casdoor/blob/2fec3f72ae9a38891a951e55e088b4967cdf4836/object/user.go#L27"},"stuct")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://casdoor.org/docs/user/overview"},"doc"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"providers"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://github.com/casdoor/casdoor/blob/2fec3f72ae9a38891a951e55e088b4967cdf4836/object/provider.go#L25"},"stuct")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://casdoor.org/docs/provider/overview"},"doc"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"certs"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://github.com/casdoor/casdoor/blob/2fec3f72ae9a38891a951e55e088b4967cdf4836/object/cert.go#L24"},"stuct")),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"ldaps"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://github.com/casdoor/casdoor/blob/2fec3f72ae9a38891a951e55e088b4967cdf4836/object/ldap.go#L28"},"stuct")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://casdoor.org/docs/ldap/overview"},"doc"))))),(0,r.kt)("p",null,"If you still feel confused to fill this template, you can call restful api or use the debug mode of your browser to see the response of ",(0,r.kt)("inlineCode",{parentName:"p"},"GetXXX")," for these objects. These response are in the same format with ",(0,r.kt)("inlineCode",{parentName:"p"},"init_data.json"),"."))}m.isMDXComponent=!0}}]);