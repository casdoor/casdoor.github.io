"use strict";(self.webpackChunkcasdoor_website=self.webpackChunkcasdoor_website||[]).push([[6723],{3905:(e,t,a)=>{a.d(t,{Zo:()=>d,kt:()=>h});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function p(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var l=n.createContext({}),c=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},d=function(e){var t=c(e.components);return n.createElement(l.Provider,{value:t},e.children)},s={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,d=p(e,["components","mdxType","originalType","parentName"]),m=c(a),h=r,u=m["".concat(l,".").concat(h)]||m[h]||s[h]||i;return a?n.createElement(u,o(o({ref:t},d),{},{components:a})):n.createElement(u,o({ref:t},d))}));function h(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,o=new Array(i);o[0]=m;var p={};for(var l in t)hasOwnProperty.call(t,l)&&(p[l]=t[l]);p.originalType=e,p.mdxType="string"==typeof e?e:r,o[1]=p;for(var c=2;c<i;c++)o[c]=a[c];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}m.displayName="MDXCreateElement"},9810:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>s,frontMatter:()=>i,metadata:()=>p,toc:()=>c});var n=a(87462),r=(a(67294),a(3905));const i={title:"WeChatPay",description:"Add Wechat OAuth provider to your application",keywords:["WeChatPay","payment"],authors:["Wrapping-2000"]},o=void 0,p={unversionedId:"provider/payment/WeChatPay",id:"provider/payment/WeChatPay",title:"WeChatPay",description:"Add Wechat OAuth provider to your application",source:"@site/i18n/de/docusaurus-plugin-content-docs/current/provider/payment/WeChatPay.md",sourceDirName:"provider/payment",slug:"/provider/payment/WeChatPay",permalink:"/de/docs/provider/payment/WeChatPay",draft:!1,editUrl:"https://crowdin.com/project/casdoor-website/de",tags:[],version:"current",frontMatter:{title:"WeChatPay",description:"Add Wechat OAuth provider to your application",keywords:["WeChatPay","payment"],authors:["Wrapping-2000"]},sidebar:"tutorialSidebar",previous:{title:"Alipay",permalink:"/de/docs/provider/payment/Alipay"},next:{title:"Captcha",permalink:"/de/docs/category/captcha"}},l={},c=[{value:"Step1. Deploy Casdoor",id:"step1-deploy-casdoor",level:2},{value:"Step2. Configure payment callback notification address",id:"step2-configure-payment-callback-notification-address",level:2},{value:"Step3. Configure API Security",id:"step3-configure-api-security",level:2},{value:"Get APIv3 key",id:"get-apiv3-key",level:3},{value:"Get the serial number of the merchant certificate",id:"get-the-serial-number-of-the-merchant-certificate",level:3},{value:"Step4. Add payment provider",id:"step4-add-payment-provider",level:2},{value:"Select the WeChat Pay as the Payment type.",id:"select-the-wechat-pay-as-the-payment-type",level:3},{value:"Get Payment URL",id:"get-payment-url",level:3},{value:"Fill the necessary information in Casdoor",id:"fill-the-necessary-information-in-casdoor",level:3},{value:"Step5. Add WeChat Cert",id:"step5-add-wechat-cert",level:2},{value:"Step6. Add WeChat Payment Provider in Products",id:"step6-add-wechat-payment-provider-in-products",level:2},{value:"What&#39;s more",id:"whats-more",level:2}],d={toc:c};function s(e){let{components:t,...i}=e;return(0,r.kt)("wrapper",(0,n.Z)({},d,i,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"step1-deploy-casdoor"},"Step1. Deploy Casdoor"),(0,r.kt)("p",null,"Firstly, the Casdoor should be deployed."),(0,r.kt)("p",null,"You can refer to the Casdoor official documentation for the ",(0,r.kt)("a",{parentName:"p",href:"/docs/basic/server-installation"},"Server Installation"),". Please deploy your Casdoor instance in ",(0,r.kt)("strong",{parentName:"p"},"production mode"),"."),(0,r.kt)("p",null,"After a successful deployment, you need to ensure:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Open your favorite browser and visit ",(0,r.kt)("strong",{parentName:"li"},"http://localhost:8000"),", you will see the login page of Casdoor."),(0,r.kt)("li",{parentName:"ul"},"Input ",(0,r.kt)("inlineCode",{parentName:"li"},"admin")," and ",(0,r.kt)("inlineCode",{parentName:"li"},"123")," to test login functionality is working fine.")),(0,r.kt)("p",null,"Then you can quickly implement a casdoor based login page in your own app with the following steps."),(0,r.kt)("h2",{id:"step2-configure-payment-callback-notification-address"},"Step2. Configure payment callback notification address"),(0,r.kt)("p",null,"Before that, please log in to the WeChat Pay Merchant Platform. In order for Casdoor to receive payment result notifications, you need to set a callback notification address in the WeChat Pay Merchant Platform."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"In Merchant Dashboard, go to ",(0,r.kt)("inlineCode",{parentName:"li"},"Development Configuration")," -> ",(0,r.kt)("inlineCode",{parentName:"li"},"Payment Configuration"),"."),(0,r.kt)("li",{parentName:"ul"},"Find the ",(0,r.kt)("inlineCode",{parentName:"li"},"Callback Notification Address")," setting, and click the ",(0,r.kt)("inlineCode",{parentName:"li"},"Modify")," button."),(0,r.kt)("li",{parentName:"ul"},"Fill in the payment callback notification address of the Casdoor instance. For example:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"https://your-casdoor-instance.com/api/wechat-payment-callback\n")),(0,r.kt)("h2",{id:"step3-configure-api-security"},"Step3. Configure API Security"),(0,r.kt)("h3",{id:"get-apiv3-key"},"Get APIv3 key"),(0,r.kt)("p",null,"To ensure the security of API calls, you need to configure API security settings in the WeChat Pay Merchant Platform."),(0,r.kt)("p",null,"Log in the ",(0,r.kt)("a",{parentName:"p",href:"https://pay.weixin.qq.com/"},"WeChat merchant platform")," -> ",(0,r.kt)("inlineCode",{parentName:"p"},"Account center")," -> ",(0,r.kt)("inlineCode",{parentName:"p"},"Account settings")," -> ",(0,r.kt)("inlineCode",{parentName:"p"},"API security")," -> ",(0,r.kt)("inlineCode",{parentName:"p"},"APIv3 key")," -> ",(0,r.kt)("inlineCode",{parentName:"p"},"set up")),(0,r.kt)("h3",{id:"get-the-serial-number-of-the-merchant-certificate"},"Get the serial number of the merchant certificate"),(0,r.kt)("p",null,"It is also necessary to obtain the serial number of the merchant certificate. The following are the steps to obtain it."),(0,r.kt)("p",null,"Log in the ",(0,r.kt)("a",{parentName:"p",href:"https://pay.weixin.qq.com/"},"WeChat merchant platform")," -> ",(0,r.kt)("inlineCode",{parentName:"p"},"Account center")," -> ",(0,r.kt)("inlineCode",{parentName:"p"},"Account settings")," -> ",(0,r.kt)("inlineCode",{parentName:"p"},"API security")," ->  ",(0,r.kt)("inlineCode",{parentName:"p"},"API certificate management")," -> copy the serial number."),(0,r.kt)("p",null,"You can refer to the ",(0,r.kt)("a",{parentName:"p",href:"https://kf.qq.com/faq/200729EZ7fEj200729aumYR7.html"},"WeChat payment merchant ID query guide")," , ",(0,r.kt)("a",{parentName:"p",href:"https://kf.qq.com/faq/180830E36vyQ180830AZFZvu.html"},"APIv3 key settings")," and ",(0,r.kt)("a",{parentName:"p",href:"https://pay.weixin.qq.com/wiki/doc/apiv3/wechatpay/wechatpay7_0.shtml#part-5"},"How to view the certificate serial number")," for help."),(0,r.kt)("h2",{id:"step4-add-payment-provider"},"Step4. Add payment provider"),(0,r.kt)("h3",{id:"select-the-wechat-pay-as-the-payment-type"},"Select the WeChat Pay as the Payment type."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"wechat_select",src:a(36510).Z,width:"1390",height:"978"})),(0,r.kt)("h3",{id:"get-payment-url"},"Get Payment URL"),(0,r.kt)("p",null,"Log in the ",(0,r.kt)("a",{parentName:"p",href:"https://pay.weixin.qq.com/"},"WeChat merchant platform")," -> ",(0,r.kt)("inlineCode",{parentName:"p"},"Commodity centered")," -> ",(0,r.kt)("inlineCode",{parentName:"p"},"Development arrangement")," -> ",(0,r.kt)("inlineCode",{parentName:"p"},"payment arrangements")," -> ",(0,r.kt)("inlineCode",{parentName:"p"},"Payment URL")," -> ",(0,r.kt)("inlineCode",{parentName:"p"},"copy")),(0,r.kt)("h3",{id:"fill-the-necessary-information-in-casdoor"},"Fill the necessary information in Casdoor"),(0,r.kt)("p",null,"There are four required fields, ",(0,r.kt)("inlineCode",{parentName:"p"},"Client ID"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"Client secret"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"appId"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"Provider URL"),". The relationship corresponding to the Azure Blob account is as follows:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Name"),(0,r.kt)("th",{parentName:"tr",align:null},"Name in WeChat Pay"),(0,r.kt)("th",{parentName:"tr",align:null},"is required"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Client ID"),(0,r.kt)("td",{parentName:"tr",align:null},"merchant ID"),(0,r.kt)("td",{parentName:"tr",align:null},"required")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Client secret"),(0,r.kt)("td",{parentName:"tr",align:null},"APIv3 key"),(0,r.kt)("td",{parentName:"tr",align:null},"required")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"appId"),(0,r.kt)("td",{parentName:"tr",align:null},"appId"),(0,r.kt)("td",{parentName:"tr",align:null},"required")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Provider URL"),(0,r.kt)("td",{parentName:"tr",align:null},"Payment URL"),(0,r.kt)("td",{parentName:"tr",align:null},"required")))),(0,r.kt)("p",null,"The acquisition of ",(0,r.kt)("inlineCode",{parentName:"p"},"merchant ID")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"APIv3 key")," is as mentioned before. For appId, see ",(0,r.kt)("a",{parentName:"p",href:"https://pay.weixin.qq.com/static/pay_setting/appid_protocol.shtml"},"here")," for more help."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"wechat_provider",src:a(22269).Z,width:"1532",height:"1278"})),(0,r.kt)("h2",{id:"step5-add-wechat-cert"},"Step5. Add WeChat Cert"),(0,r.kt)("p",null,"In this step, you need two required fields, ",(0,r.kt)("inlineCode",{parentName:"p"},"serial number"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"private key"),"."),(0,r.kt)("p",null,"How to obtain the serial number has been stated in the third step."),(0,r.kt)("p",null,"To get ",(0,r.kt)("inlineCode",{parentName:"p"},"private key"),", click ",(0,r.kt)("a",{parentName:"p",href:"https://pay.weixin.qq.com/wiki/doc/apiv3/wechatpay/wechatpay3_1.shtml"},"here")," for help."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"wechat_cert",src:a(28673).Z,width:"2642",height:"1286"})),(0,r.kt)("h2",{id:"step6-add-wechat-payment-provider-in-products"},"Step6. Add WeChat Payment Provider in Products"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"wechat_provider",src:a(33776).Z,width:"1526",height:"876"})),(0,r.kt)("p",null,"Final effect: ",(0,r.kt)("img",{alt:"wechat_provider",src:a(4134).Z,width:"2166",height:"964"})),(0,r.kt)("h2",{id:"whats-more"},"What's more"),(0,r.kt)("p",null,"You can explore the following projects/docs to learn more about WeChat Pay."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/wechatpay-apiv3/wechatpay-go"},"wechatpay-apiv3-go-sdk")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://pay.weixin.qq.com/wiki/doc/api/index.html"},"Wechat payment development document"))))}s.isMDXComponent=!0},22269:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/wechat_Provider-7919d0f102111cd53896a7cd65deeaab.png"},28673:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/wechat_cert-b2c3b6ba16a733324af45a420187cc45.png"},33776:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/wechat_products-e26f38899394909ea252cee6368742f4.png"},4134:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/wechat_result-445f82c410fae6bb85659eecc2fbcb18.png"},36510:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/wechat_select-2a1dd637c59e02b1cc89ff440305424c.png"}}]);