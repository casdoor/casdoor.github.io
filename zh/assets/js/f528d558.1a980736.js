(self.webpackChunkcasdoor_website=self.webpackChunkcasdoor_website||[]).push([[7253],{3905:function(e,t,n){"use strict";n.d(t,{Zo:function(){return c},kt:function(){return u}});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),d=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=d(e.components);return a.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),m=d(n),u=r,k=m["".concat(l,".").concat(u)]||m[u]||p[u]||o;return n?a.createElement(k,i(i({ref:t},c),{},{components:n})):a.createElement(k,i({ref:t},c))}));function u(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=m;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,i[1]=s;for(var d=2;d<o;d++)i[d]=n[d];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},13729:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return s},contentTitle:function(){return l},metadata:function(){return d},toc:function(){return c},default:function(){return m}});var a=n(74034),r=n(79973),o=(n(67294),n(3905)),i=["components"],s={title:"Casdoor SDK"},l=void 0,d={unversionedId:"how-to-connect/sdk",id:"how-to-connect/sdk",isDocsHomePage:!1,title:"Casdoor SDK",description:"\u7b80\u4ecb",source:"@site/i18n/zh/docusaurus-plugin-content-docs/current/how-to-connect/sdk.md",sourceDirName:"how-to-connect",slug:"/how-to-connect/sdk",permalink:"/zh/docs/how-to-connect/sdk",editUrl:"https://github.com/casdoor/casdoor-website/tree/master/docs/how-to-connect/sdk.md",tags:[],version:"current",frontMatter:{title:"Casdoor SDK"},sidebar:"tutorialSidebar",previous:{title:"\u6807\u51c6OIDC \u5ba2\u6237\u7aef",permalink:"/zh/docs/how-to-connect/oidc-client"},next:{title:"Casdoor\u63d2\u4ef6",permalink:"/zh/docs/how-to-connect/plugin"}},c=[{value:"\u7b80\u4ecb",id:"\u7b80\u4ecb",children:[],level:2},{value:"\u5982\u4f55\u4f7f\u7528 Casdoor SDK \uff1f",id:"\u5982\u4f55\u4f7f\u7528-casdoor-sdk-",children:[{value:"1. \u540e\u7aef SDK \u914d\u7f6e",id:"1-\u540e\u7aef-sdk-\u914d\u7f6e",children:[],level:3},{value:"2. \u524d\u7aef\u914d\u7f6e",id:"2-\u524d\u7aef\u914d\u7f6e",children:[],level:3},{value:"3. \u83b7\u53d6\u767b\u5f55 URL",id:"3-\u83b7\u53d6\u767b\u5f55-url",children:[],level:3},{value:"4. \u83b7\u53d6\u5e76\u9a8c\u8bc1\u8bbf\u95ee\u4ee4\u724c",id:"4-\u83b7\u53d6\u5e76\u9a8c\u8bc1\u8bbf\u95ee\u4ee4\u724c",children:[],level:3},{value:"4. \u7528\u8bbf\u95ee\u4ee4\u724c\u8bc6\u522b\u7528\u6237",id:"4-\u7528\u8bbf\u95ee\u4ee4\u724c\u8bc6\u522b\u7528\u6237",children:[{value:"Session",id:"session",children:[],level:4},{value:"JWT",id:"jwt",children:[],level:4}],level:3},{value:"5. <strong>(\u53ef\u9009)</strong> \u4e0e\u7528\u6237\u8868\u7684\u4e92\u52a8",id:"5-\u53ef\u9009-\u4e0e\u7528\u6237\u8868\u7684\u4e92\u52a8",children:[],level:3}],level:2}],p={toc:c};function m(e){var t=e.components,s=(0,r.Z)(e,i);return(0,o.kt)("wrapper",(0,a.Z)({},p,s,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"\u7b80\u4ecb"},"\u7b80\u4ecb"),(0,o.kt)("p",null,"\u4e0e\u6807\u51c6\u7684 OIDC \u534f\u8bae\u76f8\u6bd4\uff0cCasdoor \u5728 SDK \u4e2d\u63d0\u4f9b\u4e86\u66f4\u591a\u7684\u529f\u80fd\uff0c\u5982\u7528\u6237\u7ba1\u7406\u3001\u8d44\u6e90\u4e0a\u4f20\u7b49\u3002 \u901a\u8fc7 Casdoor SDK \u8fde\u63a5\u5230Casdoor \u7684\u6210\u672c\u6bd4\u4f7f\u7528 OIDC \u6807\u51c6\u5ba2\u6237\u7aef\u5e93\u66f4\u9ad8\uff0c\u5e76\u5c06\u63d0\u4f9b\u7075\u6d3b\u6027\u6700\u4f73\u548c\u6700\u5f3a\u5927\u7684 API\u3002"),(0,o.kt)("p",null,"Casdoor SDK\u53ef\u5206\u4e3a\u4e24\u7c7b\uff1a"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"Frontend SDKs"),": Javascript SDK and Vue SDK for websites, Android or iOS SDKs for Apps. Casdoor\u652f\u6301\u4e3a\u7f51\u7ad9\u548c\u79fb\u52a8\u5e94\u7528\u7a0b\u5e8f\u63d0\u4f9b\u8eab\u4efd\u9a8c\u8bc1\u3002"),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"\u540e\u7aef SDK"),": Go, Java, Node.js, Python, PHP \u7b49\u540e\u7aef\u8bed\u8a00\u7684 SDK \u3002")),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"If your website is developed in a frontend and backend separated manner, then you can use the Javascript SDK: ",(0,o.kt)("inlineCode",{parentName:"p"},"casdoor-js-sdk")," or the Vue SDK: ",(0,o.kt)("inlineCode",{parentName:"p"},"casdoor-vue-sdk")," to integrate Casdoor in frontend. \u5982\u679c\u60a8\u7684\u7f51\u9875\u5e94\u7528\u7a0b\u5e8f\u662f\u7531 JSP \u6216 PHP \u5f00\u53d1\u7684\u4f20\u7edf\u7f51\u7ad9\uff0c\u90a3\u60a8\u5c31\u53ea\u80fd\u4f7f\u7528\u540e\u7aefSDK\u3002"),(0,o.kt)("p",{parentName:"div"},"a example: ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/casdoor/casdoor-python-vue-sdk-example"},"casdoor-python-vue-sdk-example")))),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Casdoor\u524d\u7aef SDK"),(0,o.kt)("th",{parentName:"tr",align:null},"\u63cf\u8ff0"),(0,o.kt)("th",{parentName:"tr",align:null},"\u6e90\u4ee3\u7801"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"Javascript SDK"),(0,o.kt)("td",{parentName:"tr",align:null},"\u9002\u7528\u4e8e\u7f51\u9875"),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"https://github.com/casdoor/casdoor-js-sdk"},"https://github.com/casdoor/casdoor-js-sdk"))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"Vue SDK"),(0,o.kt)("td",{parentName:"tr",align:null},"For websites"),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"https://github.com/casdoor/casdoor-vue-sdk"},"https://github.com/casdoor/casdoor-vue-sdk"))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"Android SDK"),(0,o.kt)("td",{parentName:"tr",align:null},"For Android apps"),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"https://github.com/casdoor/casdoor-android-sdk"},"https://github.com/casdoor/casdoor-android-sdk"))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"iOS SDK"),(0,o.kt)("td",{parentName:"tr",align:null},"For iOS apps"),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"https://github.com/casdoor/casdoor-ios-sdk"},"https://github.com/casdoor/casdoor-ios-sdk"))))),(0,o.kt)("p",null,"Next, use one of the following backend SDKs based on the language of your backend:"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"\u540e\u7aef SDK"),(0,o.kt)("th",{parentName:"tr",align:null},"\u6e90\u4ee3\u7801"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"Go SDK"),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"https://github.com/casdoor/casdo-go-sdk"},"https://github.com/casdoor/casdo-go-sdk"))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"Java SDK"),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"https://github.com/casdoor/casdoor-java-sdk"},"https://github.com/casdoor/casdoor-java-sdk"))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"Node.js SDK"),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"https://github.com/casdoor/casdoor-nodejs-sdk"},"https://github.com/casdoor/casdoor-nodejs-sdk"))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"Python SDK"),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"https://github.com/casdoor/casdoor-python-sdk"},"https://github.com/casdoor/casdoor-python-sdk"))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"PHP SDK"),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"https://github.com/casdoor/casdoor-php-sdk"},"https://github.com/casdoor/casdoor-php-sdk"))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},".NET SDK"),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"https://github.com/casdoor/casdonet-sdk"},"https://github.com/casdoor/casdonet-sdk"))))),(0,o.kt)("p",null,"For a full list of the official Casdoor SDKs, please see: ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/casdoor?q=sdk&type=all&language=&sort="},"https://github.com/casdoor?q=sdk&type=all&language=&sort=")),(0,o.kt)("h2",{id:"\u5982\u4f55\u4f7f\u7528-casdoor-sdk-"},"\u5982\u4f55\u4f7f\u7528 Casdoor SDK \uff1f"),(0,o.kt)("h3",{id:"1-\u540e\u7aef-sdk-\u914d\u7f6e"},"1. \u540e\u7aef SDK \u914d\u7f6e"),(0,o.kt)("p",null,"When your application starts up, you need to initialize the Casdoor SDK config by calling the ",(0,o.kt)("inlineCode",{parentName:"p"},"InitConfig()")," function with required parameters. Take casdoor-go-sdk as example: ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/casbin/casnode/blob/6d4c55f5c9a3c4bd8c85f2493abad3553b9c7ac0/controllers/account.go#L51-L64"},"https://github.com/casbin/casnode/blob/6d4c55f5c9a3c4bd8c85f2493abad3553b9c7ac0/controllers/account.go#L51-L64")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-go"},'var CasdoorEndpoint = "https://door.casdoor.com"\nvar ClientId = "541738959670d221d59d"\nvar ClientSecret = "66863369a64a5863827cf949bab70ed560ba24bf"\nvar CasdoorOrganization = "casbin"\nvar CasdoorApplication = "app-casnode"\n\n//go:embed token_jwt_key.pem\nvar JwtPublicKey string\n\nfunc init() {\n    auth.InitConfig(CasdoorEndpoint, ClientId, ClientSecret, JwtPublicKey, CasdoorOrganization, CasdoorApplication)\n}\n')),(0,o.kt)("p",null,"All the parameters for ",(0,o.kt)("inlineCode",{parentName:"p"},"InitConfig()")," are explained as follows:"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"\u53c2\u6570"),(0,o.kt)("th",{parentName:"tr",align:null},"\u662f\u5426\u5fc5\u987b"),(0,o.kt)("th",{parentName:"tr",align:null},"\u63cf\u8ff0"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"endpoint"),(0,o.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,o.kt)("td",{parentName:"tr",align:null},"Casdoor \u7684\u670d\u52a1URL\uff0c\u4f8b\u5982\uff1a ",(0,o.kt)("inlineCode",{parentName:"td"},"https://door.casdoor.com")," or ",(0,o.kt)("inlineCode",{parentName:"td"},"http://localhost:8000"))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"clientId"),(0,o.kt)("td",{parentName:"tr",align:null},"\u786e\u5b9a"),(0,o.kt)("td",{parentName:"tr",align:null},"Casdoor \u5e94\u7528\u7a0b\u5e8f\u7684\u5ba2\u6237\u7aef ID")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"clientSecret"),(0,o.kt)("td",{parentName:"tr",align:null},"\u786e\u5b9a"),(0,o.kt)("td",{parentName:"tr",align:null},"Casdoor \u5e94\u7528\u7a0b\u5e8f\u7684\u5ba2\u6237\u7aef\u5bc6\u94a5")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"jwtPublicKey"),(0,o.kt)("td",{parentName:"tr",align:null},"\u786e\u5b9a"),(0,o.kt)("td",{parentName:"tr",align:null},"Casdoor \u5e94\u7528\u7a0b\u5e8f\u8bc1\u4e66\u7684\u516c\u94a5")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"organizationName"),(0,o.kt)("td",{parentName:"tr",align:null},"\u786e\u5b9a"),(0,o.kt)("td",{parentName:"tr",align:null},"Casdoor \u7ec4\u7ec7\u7684\u540d\u79f0")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"applicationName"),(0,o.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,o.kt)("td",{parentName:"tr",align:null},"Casdoor \u5e94\u7528\u7a0b\u5e8f\u7684\u540d\u79f0")))),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"The ",(0,o.kt)("inlineCode",{parentName:"p"},"jwtPublicKey")," can be managed in the ",(0,o.kt)("inlineCode",{parentName:"p"},"Certs")," page as below."),(0,o.kt)("p",{parentName:"div"},(0,o.kt)("img",{alt:"Certs Management",src:n(19516).Z})),(0,o.kt)("p",{parentName:"div"},"You can find the public key in the cert edit page, copy it or download it for the sdk."),(0,o.kt)("p",{parentName:"div"},(0,o.kt)("img",{alt:"Certs Edit",src:n(58402).Z})),(0,o.kt)("p",{parentName:"div"},"Then you can select the cert in the application edit page."),(0,o.kt)("p",{parentName:"div"},(0,o.kt)("img",{alt:"Certs Select",src:n(80733).Z})))),(0,o.kt)("h3",{id:"2-\u524d\u7aef\u914d\u7f6e"},"2. \u524d\u7aef\u914d\u7f6e"),(0,o.kt)("p",null,"First, install ",(0,o.kt)("inlineCode",{parentName:"p"},"casdoor-js-sdk")," via NPM or Yarn:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},"npm install casdoor-js-sdk\n")),(0,o.kt)("p",null,"Or:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},"yarn add casdoor-js-sdk\n")),(0,o.kt)("p",null,"Then define the following utility functions (better in a global JS file like ",(0,o.kt)("inlineCode",{parentName:"p"},"Setting.js"),"):"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'import Sdk from "casdoor-js-sdk";\n\nexport function initCasdoorSdk(config) {\n   CasdoorSdk = new Sdk(config);\n}\n\nexport function getSignupUrl() {\n   return CasdoorSdk.getSignupUrl();\n}\n\nexport function getSigninUrl() {\n   return CasdoorSdk.getSigninUrl();\n}\n\nexport function getUserProfileUrl(userName, account) {\n   return CasdoorSdk.getUserProfileUrl(userName, account);\n}\n\nexport function getMyProfileUrl(account) {\n   return CasdoorSdk.getMyProfileUrl(account);\n}\n\nexport function getMyResourcesUrl(account) {\n   return CasdoorSdk.getMyProfileUrl(account).replace("/account?", "/resources?");\n}\n\nexport function signin() {\n   return CasdoorSdk.signin(ServerUrl);\n}\n\nexport function showMessage(type, text) {\n  if (type === "") {\n    return;\n  } else if (type === "success") {\n    message.success(text);\n  } else if (type === "error") {\n    message.error(text);\n  }\n}\n\nexport function goToLink(link) {\n  window.location.href = link;\n}\n')),(0,o.kt)("p",null,"In the entrance file of your frontend code (like ",(0,o.kt)("inlineCode",{parentName:"p"},"index.js")," or ",(0,o.kt)("inlineCode",{parentName:"p"},"app.js")," in React), you need to initialize the ",(0,o.kt)("inlineCode",{parentName:"p"},"casdoor-js-sdk")," by calling the ",(0,o.kt)("inlineCode",{parentName:"p"},"InitConfig()")," function with required parameters. The first 4 parameters should use the same value as the Casdoor backend SDK. The last parameter ",(0,o.kt)("inlineCode",{parentName:"p"},"redirectPath")," is relative path for the redirected URL, returned from Casdoor's login page."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'const config = {\n  serverUrl: "https://door.casdoor.com",\n  clientId: "014ae4bd048734ca2dea",\n  organizationName: "casbin",\n  appName: "app-casnode",\n  redirectPath: "/callback",\n};\n\nxxx.initCasdoorSdk(config);\n')),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"(Optional)")," Because we are using React as example, so our ",(0,o.kt)("inlineCode",{parentName:"p"},"/callback")," path is hitting the React route, we use the following React component to receive the ",(0,o.kt)("inlineCode",{parentName:"p"},"/callback")," call and sends to the backend. You can ignore this step if you are redirecting to backend directly (like in JSP or PHP)."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'import React from "react";\nimport { Button, Result, Spin } from "antd";\nimport { withRouter } from "react-router-dom";\nimport * as Setting from "./Setting";\n\nclass AuthCallback extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      classes: props,\n      msg: null,\n    };\n  }\n\n  componentWillMount() {\n    this.login();\n  }\n\n  login() {\n    Setting.signin().then((res) => {\n      if (res.status === "ok") {\n        Setting.showMessage("success", `Logged in successfully`);\n        Setting.goToLink("/");\n      } else {\n        this.setState({\n          msg: res.msg,\n        });\n      }\n    });\n  }\n\n  render() {\n    return (\n      <div style={{ textAlign: "center" }}>\n        {this.state.msg === null ? (\n          <Spin\n            size="large"\n            tip="Signing in..."\n            style={{ paddingTop: "10%" }}\n          />\n        ) : (\n          <div style={{ display: "inline" }}>\n            <Result\n              status="error"\n              title="Login Error"\n              subTitle={this.state.msg}\n              extra={[\n                <Button type="primary" key="details">\n                  Details\n                </Button>,\n                <Button key="help">Help</Button>,\n              ]}\n            />\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n\nexport default withRouter(AuthCallback);\n')),(0,o.kt)("h3",{id:"3-\u83b7\u53d6\u767b\u5f55-url"},"3. \u83b7\u53d6\u767b\u5f55 URL"),(0,o.kt)("p",null,'Next you can show the "Sign up" and "Sign in" buttons or links to your users. The URLs can either be retrieved in the frontend or backend. See more details at: ',(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"/docs/basic/core-concepts#login-urls"},"/docs/basic/core-concepts#login-urls"))),(0,o.kt)("h3",{id:"4-\u83b7\u53d6\u5e76\u9a8c\u8bc1\u8bbf\u95ee\u4ee4\u724c"},"4. \u83b7\u53d6\u5e76\u9a8c\u8bc1\u8bbf\u95ee\u4ee4\u724c"),(0,o.kt)("p",null,"Here are the steps:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"\u7528\u6237\u70b9\u51fb\u767b\u5f55URL\u5e76\u91cd\u5b9a\u5411\u5230Casdoor\u7684\u767b\u5f55\u9875\u9762\uff0c\u5982 ",(0,o.kt)("inlineCode",{parentName:"li"},"https://door.casbin.com/login/oauth/authorize?client_id=014ae4bd048734ca2dea&response_type=code&redirect_uri=https%3A%2F%2Fforum.casbin.com%2Fcallback&scope=read&state=app-casnode")),(0,o.kt)("li",{parentName:"ol"},"\u7528\u6237\u8f93\u5165\u7528\u6237\u540d & \u5bc6\u7801\u5e76\u70b9\u51fb ",(0,o.kt)("inlineCode",{parentName:"li"},"\u767b\u5f55")," (\u6216\u70b9\u51fb\u7b2c\u4e09\u65b9\u767b\u5f55\u6309\u94ae\uff0c\u5982 ",(0,o.kt)("inlineCode",{parentName:"li"},"\u4f7f\u7528 GitHub")," \u767b\u5f55)\u3002"),(0,o.kt)("li",{parentName:"ol"},"\u8be5\u7528\u6237\u88ab\u91cd\u5b9a\u5411\u5230\u60a8\u7684\u5e94\u7528\uff0c\u4f7f\u7528Casto\u53d1\u884c\u7684\u6388\u6743\u7801(\u4f8b\u5982\uff1a ",(0,o.kt)("inlineCode",{parentName:"li"},"https://forum.casbin.com?code=xxx&state=yyy"),"), \u60a8\u7684\u5e94\u7528\u7a0b\u5e8f\u7684\u540e\u7aef\u9700\u8981\u5c06\u6388\u6743\u7801\u4e0e\u8bbf\u95ee\u4ee4\u724c\u4ea4\u6362\uff0c\u5e76\u9a8c\u8bc1\u8bbf\u95ee\u4ee4\u724c\u662f\u5426\u6709\u6548\u548c\u7531Casdoor\u7b7e\u53d1\u3002 \u51fd\u6570 ",(0,o.kt)("inlineCode",{parentName:"li"},"GetOAuthToken()")," and ",(0,o.kt)("inlineCode",{parentName:"li"},"ParseJwtToken()")," \u7531 Casdoor \u540e\u7aefSDK \u63d0\u4f9b\u3002")),(0,o.kt)("p",null,"The following code shows how to get and verify the access token. For a real example of Casnode (a forum website written in Go), see: ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/casbin/casnode/blob/6d4c55f5c9a3c4bd8c85f2493abad3553b9c7ac0/controllers/account.go#L51-L64"},"https://github.com/casbin/casnode/blob/6d4c55f5c9a3c4bd8c85f2493abad3553b9c7ac0/controllers/account.go#L51-L64")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-go"},'// \u4ece\u91cd\u5b9a\u5411 URL \u7684 GET \u53c2\u6570\u4e2d\u83b7\u53d6\u4ee3\u7801\u548c\u72b6\u6001\ncode := c.Input().Get("code")\nstate := c.Input().Get("state")\n\n// \u7528\u4ee3\u7801\u548c\u72b6\u6001\u4ea4\u6362\u8bbf\u95ee\u4ee4\u724c\ntoken, err := auth.GetOAuthToken(code, state)\nif err != nil {\n    panic(err)\n}\n\n// \u9a8c\u8bc1\u8bbf\u95ee\u4ee4\u724c\nclaims, err := auth.ParseJwtToken(token.AccessToken)\nif err != nil {\n    panic(err)\n}\n')),(0,o.kt)("p",null,"If ",(0,o.kt)("inlineCode",{parentName:"p"},"ParseJwtToken()")," finishes with no error, then the user has successfully logged into the application. The returned ",(0,o.kt)("inlineCode",{parentName:"p"},"claims")," can be used to identity the user later."),(0,o.kt)("h3",{id:"4-\u7528\u8bbf\u95ee\u4ee4\u724c\u8bc6\u522b\u7528\u6237"},"4. \u7528\u8bbf\u95ee\u4ee4\u724c\u8bc6\u522b\u7528\u6237"),(0,o.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"This part is actually your application's own business logic and not part of OIDC, OAuth or Casdoor. We just provide good practices as a lot of people don't know what to do for next step.")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"})),(0,o.kt)("p",null,"In Casdoor, access token is usually identical as ID token. They are the same thing. So the access token contains all information for the logged-in user."),(0,o.kt)("p",null,"The variable ",(0,o.kt)("inlineCode",{parentName:"p"},"claims")," returned by ",(0,o.kt)("inlineCode",{parentName:"p"},"ParseJwtToken()")," is defined as:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-go"},'Type Claims struct\n    User\n    AccessToken string `json:"accessToken"\n    jwt.RegisteredClaims\n}\n')),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("inlineCode",{parentName:"li"},"User"),": User \u5bf9\u8c61\uff0c\u5305\u542b\u767b\u5f55\u7528\u6237\u7684\u6240\u6709\u4fe1\u606f\uff0c\u8bf7\u53c2\u89c1\u5b9a\u4e49\uff1a",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("a",{parentName:"strong",href:"/docs/basic/core-concepts#user"},"/docs/basic/core-concepts#user"))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("inlineCode",{parentName:"li"},"AccessToken"),": \u8bbf\u95ee\u4ee4\u724c\u5b57\u7b26\u4e32\u3002"),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("inlineCode",{parentName:"li"},"jwt.RegisteredClaim"),": JWT\u9700\u8981\u4e00\u4e9b\u5176\u4ed6\u503c\u3002")),(0,o.kt)("p",null,"At this moment, the application usually has two ways to remember the user session: ",(0,o.kt)("inlineCode",{parentName:"p"},"session")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"JWT"),"."),(0,o.kt)("h4",{id:"session"},"Session"),(0,o.kt)("p",null,"The Method to set session varies greatly depending on the language and web framework. E.g., Casnode uses ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/beego/beego/"},"Beego web framework")," and set session by calling: ",(0,o.kt)("inlineCode",{parentName:"p"},"c.SetSessionUser()"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-go"},"token, err := auth.GetOAuthToken(code, state)\nif err != nil {\n    panic(err)\n}\n\nclaims, err := auth.ParseJwtToken(token.AccessToken)\nif err != nil {\n    panic(err)\n}\n\nclaims.AccessToken = token.AccessToken\nc.SetSessionUser(claims) // \u8bbe\u7f6e\u4f1a\u8bdd\n")),(0,o.kt)("h4",{id:"jwt"},"JWT"),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"accessToken")," returned by Casdoor is actually a JWT. So if your application uses JWT to keep user session, just use the access token directly for it:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"\u5c06\u8bbf\u95ee\u4ee4\u724c\u53d1\u9001\u5230\u524d\u7aef\uff0c\u5728\u672c\u5730\u5b58\u50a8\u6d4f\u89c8\u5668\u7b49\u5730\u65b9\u4fdd\u5b58\u3002"),(0,o.kt)("li",{parentName:"ol"},"\u8ba9\u6d4f\u89c8\u5668\u4e3a\u6bcf\u4e2a\u8bf7\u6c42\u53d1\u9001\u8bbf\u95ee\u4ee4\u724c\u5230\u540e\u7aef\u3002"),(0,o.kt)("li",{parentName:"ol"},"\u8c03\u7528 ",(0,o.kt)("inlineCode",{parentName:"li"},"ParseJwtToken()")," \u6216\u60a8\u81ea\u5df1\u7684\u51fd\u6570\u6765\u9a8c\u8bc1\u8bbf\u95ee\u4ee4\u724c\u5e76\u5728\u60a8\u7684\u540e\u7aef\u83b7\u53d6\u767b\u5f55\u7528\u6237\u4fe1\u606f\u3002")),(0,o.kt)("h3",{id:"5-\u53ef\u9009-\u4e0e\u7528\u6237\u8868\u7684\u4e92\u52a8"},"5. ",(0,o.kt)("strong",{parentName:"h3"},"(\u53ef\u9009)")," \u4e0e\u7528\u6237\u8868\u7684\u4e92\u52a8"),(0,o.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"This part is provided by ",(0,o.kt)("inlineCode",{parentName:"h5"},"Casdoor Public API")," and not part of the OIDC or OAuth.")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"})),(0,o.kt)("p",null,"Casdoor Backend SDK provides a lot of helper functions, not limited to:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"GetUser(name string)"),": \u901a\u8fc7\u7528\u6237\u540d\u83b7\u53d6\u7528\u6237\u3002"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"GetUsers()"),": \u83b7\u53d6\u6240\u6709\u7528\u6237\u3002"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"AddUser()"),": \u6dfb\u52a0\u4e00\u4e2a\u7528\u6237\u3002"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"UpdateUser()"),": \u66f4\u65b0\u4e00\u4e2a\u7528\u6237\u3002"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"DeleteUser()"),": \u5220\u9664\u4e00\u4e2a\u7528\u6237\u3002"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"CheckUserPassword(auth.User)"),": \u68c0\u67e5\u7528\u6237\u7684\u5bc6\u7801\u3002")),(0,o.kt)("p",null,"These functions are implemented by making RESTful calls against ",(0,o.kt)("inlineCode",{parentName:"p"},"Casdoor Public API"),". If a function is not provided in Casdoor Backend SDK, you can make RESTful calls by yourself."))}m.isMDXComponent=!0},58402:function(e,t,n){"use strict";t.Z=n.p+"assets/images/howto_cert_edit-81b9d2d22373bef5304e8d44a4599307.png"},19516:function(e,t,n){"use strict";t.Z=n.p+"assets/images/howto_cert_list-d390f783cfbe9a70ce462bcefad9044b.png"},80733:function(e,t,n){"use strict";t.Z=n.p+"assets/images/howto_cert_select-bec6aa4df2dd44530cd1c54fd5838595.png"}}]);