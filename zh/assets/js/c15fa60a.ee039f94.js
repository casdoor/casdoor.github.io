"use strict";(self.webpackChunkcasdoor_website=self.webpackChunkcasdoor_website||[]).push([[9418],{3905:(e,n,t)=>{t.d(n,{Zo:()=>c,kt:()=>u});var i=t(67294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function r(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,i,a=function(e,n){if(null==e)return{};var t,i,a={},o=Object.keys(e);for(i=0;i<o.length;i++)t=o[i],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)t=o[i],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var s=i.createContext({}),p=function(e){var n=i.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):r(r({},n),e)),t},c=function(e){var n=p(e.components);return i.createElement(s.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return i.createElement(i.Fragment,{},n)}},k=i.forwardRef((function(e,n){var t=e.components,a=e.mdxType,o=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),k=p(t),u=a,m=k["".concat(s,".").concat(u)]||k[u]||d[u]||o;return t?i.createElement(m,r(r({ref:n},c),{},{components:t})):i.createElement(m,r({ref:n},c))}));function u(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var o=t.length,r=new Array(o);r[0]=k;var l={};for(var s in n)hasOwnProperty.call(n,s)&&(l[s]=n[s]);l.originalType=e,l.mdxType="string"==typeof e?e:a,r[1]=l;for(var p=2;p<o;p++)r[p]=t[p];return i.createElement.apply(null,r)}return i.createElement.apply(null,t)}k.displayName="MDXCreateElement"},21839:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>r,default:()=>d,frontMatter:()=>o,metadata:()=>l,toc:()=>p});var i=t(87462),a=(t(67294),t(3905));const o={title:"Jenkins OIDC",description:"\u4f7f\u7528 OIDC \u534f\u8bae\u4f5c\u4e3aIDP \u8fde\u63a5\u5404\u79cd\u5e94\u7528\u7a0b\u5e8f\uff0c\u5982Jenkins",keywords:["OIDC","Jenkins","IDP"],authors:["Abingcbc"]},r=void 0,l={unversionedId:"integration/java/jenkins oidc",id:"integration/java/jenkins oidc",title:"Jenkins OIDC",description:"\u4f7f\u7528 OIDC \u534f\u8bae\u4f5c\u4e3aIDP \u8fde\u63a5\u5404\u79cd\u5e94\u7528\u7a0b\u5e8f\uff0c\u5982Jenkins",source:"@site/i18n/zh/docusaurus-plugin-content-docs/current/integration/java/jenkins oidc.md",sourceDirName:"integration/java",slug:"/integration/java/jenkins oidc",permalink:"/zh/docs/integration/java/jenkins oidc",draft:!1,editUrl:"https://crowdin.com/project/casdoor-website/zh-CN",tags:[],version:"current",frontMatter:{title:"Jenkins OIDC",description:"\u4f7f\u7528 OIDC \u534f\u8bae\u4f5c\u4e3aIDP \u8fde\u63a5\u5404\u79cd\u5e94\u7528\u7a0b\u5e8f\uff0c\u5982Jenkins",keywords:["OIDC","Jenkins","IDP"],authors:["Abingcbc"]},sidebar:"tutorialSidebar",previous:{title:"Jenkins \u63d2\u4ef6",permalink:"/zh/docs/integration/java/jenkins plugin"},next:{title:"Jira",permalink:"/zh/docs/integration/java/jira"}},s={},p=[{value:"\u7b2c1\u6b65\u3002 \u90e8\u7f72Casdoor\u548cJenkins",id:"\u7b2c1\u6b65-\u90e8\u7f72casdoor\u548cjenkins",level:2},{value:"\u7b2c2\u6b65\uff1a \u914d\u7f6eCasdoor\u5e94\u7528\u7a0b\u5e8f",id:"\u7b2c2\u6b65-\u914d\u7f6ecasdoor\u5e94\u7528\u7a0b\u5e8f",level:2},{value:"\u7b2c3\u6b65 \u914d\u7f6e Jenkins",id:"\u7b2c3\u6b65-\u914d\u7f6e-jenkins",level:2}],c={toc:p};function d(e){let{components:n,...o}=e;return(0,a.kt)("wrapper",(0,i.Z)({},c,o,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"Casdoor \u53ef\u4ee5\u4f7f\u7528 OIDC \u534f\u8bae\u4f5c\u4e3aIDP \u8fde\u63a5\u5404\u79cd\u5e94\u7528\u7a0b\u5e8f\u3002 \u8fd9\u91cc\u6211\u4eec\u5c06\u4f7f\u7528Jenkins\u4f5c\u4e3a\u793a\u4f8b\uff0c\u5411\u60a8\u5c55\u793a\u5982\u4f55\u4f7f\u7528 OIDC \u94fe\u63a5\u5230\u60a8\u7684\u5e94\u7528\u7a0b\u5e8f\u3002"),(0,a.kt)("p",null,"\u4ee5\u4e0b\u662f\u914d\u7f6e\u4e2d\u7684\u4e00\u4e9b\u4e13\u6709\u540d\u8bcd\uff1a"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"CASDOOR_HOSTNAME"),"\uff1a\u79c1\u6709\u90e8\u7f72\u7684Casdoor\u57df\u540d\u6216IP\u3002"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"JENKINS_HOSTNAME"),": \u90e8\u7f72Jenkins\u7684\u57df\u540d\u6216IP\u3002"),(0,a.kt)("h2",{id:"\u7b2c1\u6b65-\u90e8\u7f72casdoor\u548cjenkins"},"\u7b2c1\u6b65\u3002 \u90e8\u7f72Casdoor\u548cJenkins"),(0,a.kt)("p",null,"\u9996\u5148\uff0c\u5e94\u8be5\u90e8\u7f72 ",(0,a.kt)("a",{parentName:"p",href:"/docs/basic/server-installation"},"Casdoor")," \u548c ",(0,a.kt)("a",{parentName:"p",href:"https://www.jenkins.io/doc/book/installing/"},"Jenkins"),"\u3002"),(0,a.kt)("p",null,"\u5728\u6210\u529f\u90e8\u7f72\u540e\uff0c\u60a8\u9700\u8981\u786e\u4fdd\uff1a"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"\u5c06 Jenkins URL(Manage Jenkins -> Configure System -> Jenkins Location) \u8bbe\u7f6e\u4e3a ",(0,a.kt)("inlineCode",{parentName:"li"},"JENKINS_HOSTNAME")," ",(0,a.kt)("img",{alt:"Jenkins URL",src:t(25742).Z,width:"1887",height:"825"})),(0,a.kt)("li",{parentName:"ol"},"\u53ef\u4ee5\u767b\u5f55\u5e76\u6b63\u5e38\u4f7f\u7528Casdoor \u3002"),(0,a.kt)("li",{parentName:"ol"},"\u5c06Casdoor \u7684 ",(0,a.kt)("inlineCode",{parentName:"li"},"origin")," value (conf/app.conf) \u8bbe\u7f6e\u4e3a ",(0,a.kt)("inlineCode",{parentName:"li"},"CASDOOR_HOSTNAME"),"\u3002 ",(0,a.kt)("img",{alt:"Casdoor \u914d\u7f6e",src:t(66496).Z,width:"1013",height:"448"}))),(0,a.kt)("h2",{id:"\u7b2c2\u6b65-\u914d\u7f6ecasdoor\u5e94\u7528\u7a0b\u5e8f"},"\u7b2c2\u6b65\uff1a \u914d\u7f6eCasdoor\u5e94\u7528\u7a0b\u5e8f"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"\u521b\u5efa\u6216\u4f7f\u7528\u73b0\u6709\u7684 Casdoor \u5e94\u7528\u7a0b\u5e8f\u3002"),(0,a.kt)("li",{parentName:"ol"},"\u6dfb\u52a0\u91cd\u5b9a\u5411URL\uff1a ",(0,a.kt)("inlineCode",{parentName:"li"},"http://JENKINS_HOSTNAME/securityRealm/finishLogin")," ",(0,a.kt)("img",{alt:"Casdoor \u5e94\u7528\u8bbe\u7f6e",src:t(9871).Z,width:"1366",height:"581"})),(0,a.kt)("li",{parentName:"ol"},"\u6dfb\u52a0\u60a8\u60f3\u8981\u7684provider\u5e76\u8865\u5145\u5176\u4ed6\u8bbe\u7f6e\u3002")),(0,a.kt)("p",null,"\u4e0d\u51fa\u610f\u5916\u7684\u8bdd\uff0c\u60a8\u4f1a\u5728\u5e94\u7528\u7a0b\u5e8f\u8bbe\u7f6e\u9875\u9762\u770b\u5230\uff1a ",(0,a.kt)("inlineCode",{parentName:"p"},"Client ID")," \u548c ",(0,a.kt)("inlineCode",{parentName:"p"},"Client secret")," \u5c31\u50cf\u4e0a\u9762\u7684\u56fe\u7247\u4e00\u6837\u3002 \u6211\u4eec\u5c06\u5728\u4e0b\u4e00\u6b65\u4e2d\u4f7f\u7528\u5b83\u4eec\u3002"),(0,a.kt)("p",null,"\u6253\u5f00\u4f60\u559c\u6b22\u7684\u6d4f\u89c8\u5668\uff0c\u8bbf\u95ee\uff1a",(0,a.kt)("strong",{parentName:"p"},"http://",(0,a.kt)("inlineCode",{parentName:"strong"},"CASDOOR_HOSTNAME"),"/.well-known/openid-configuration"),"\uff0c\u4f60\u4f1a\u770b\u5230 Casdoor \u7684 OIDC \u914d\u7f6e\u3002"),(0,a.kt)("h2",{id:"\u7b2c3\u6b65-\u914d\u7f6e-jenkins"},"\u7b2c3\u6b65 \u914d\u7f6e Jenkins"),(0,a.kt)("p",null,"First, we need to install ",(0,a.kt)("a",{parentName:"p",href:"https://plugins.jenkins.io/oic-auth/"},"OpenId Connect Authentication"),", Jenkins does not natively support OIDC."),(0,a.kt)("p",null,"After completing the installation, go to ",(0,a.kt)("strong",{parentName:"p"},"Manage Jenkins")," -> ",(0,a.kt)("strong",{parentName:"p"},"Configure Global Security"),". ",(0,a.kt)("img",{alt:"jenkins global security",src:t(4289).Z,width:"1902",height:"876"})),(0,a.kt)("admonition",{type:"tip"},(0,a.kt)("p",{parentName:"admonition"},"Back up the Jenkins ",(0,a.kt)("inlineCode",{parentName:"p"},"config.xml")," file, and use it to recover in case of setup errors.")),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"In Access Control, ",(0,a.kt)("strong",{parentName:"li"},"Security Realm")," select ",(0,a.kt)("inlineCode",{parentName:"li"},"Login with Openid Connect"),"."),(0,a.kt)("li",{parentName:"ol"},"\u5728\u5ba2\u6237\u7aefID\u4e2d\uff0c\u6307\u5b9a\u4e0a\u9762\u6ce8\u660e\u7684 ",(0,a.kt)("inlineCode",{parentName:"li"},"\u5ba2\u6237\u7aefID"),"\u3002"),(0,a.kt)("li",{parentName:"ol"},"\u5728Client serect\u4e2d\uff0c\u6307\u5b9a\u4e0a\u9762\u6ce8\u660e\u7684 ",(0,a.kt)("inlineCode",{parentName:"li"},"Client secret")),(0,a.kt)("li",{parentName:"ol"},"In Configuration mode, select ",(0,a.kt)("inlineCode",{parentName:"li"},"Automatic configuration")," and fill in ",(0,a.kt)("strong",{parentName:"li"},"http://",(0,a.kt)("inlineCode",{parentName:"strong"},"CASDOOR_HOSTNAME"),"/.well-known/openid-configuration")," into Well-known configuration endpoint.",(0,a.kt)("img",{alt:"Jenkins&#39; Setting",src:t(2498).Z,width:"1410",height:"631"}))),(0,a.kt)("p",null,"If your casdoor is deployed locally, you may need to select ",(0,a.kt)("inlineCode",{parentName:"p"},"Manual configuration")," and input some information:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Token server url: ",(0,a.kt)("strong",{parentName:"li"},"http://",(0,a.kt)("inlineCode",{parentName:"strong"},"CASDOOR_HOSTNAME"),"/api/login/oauth/access_token")),(0,a.kt)("li",{parentName:"ul"},"Authorization server url: ",(0,a.kt)("strong",{parentName:"li"},"http://",(0,a.kt)("inlineCode",{parentName:"strong"},"CASDOOR_HOSTNAME"),"/login/oauth/authorize")),(0,a.kt)("li",{parentName:"ul"},"UserInfo server url: ",(0,a.kt)("strong",{parentName:"li"},"http://",(0,a.kt)("inlineCode",{parentName:"strong"},"CASDOOR_HOSTNAME"),"/api/get-account")),(0,a.kt)("li",{parentName:"ul"},"Scopes: ",(0,a.kt)("inlineCode",{parentName:"li"},"address phone openid profile offline_access email")," ",(0,a.kt)("img",{alt:"Manual configuration",src:t(38517).Z,width:"1361",height:"548"}))),(0,a.kt)("ol",{start:5},(0,a.kt)("li",{parentName:"ol"},"Click ",(0,a.kt)("strong",{parentName:"li"},"Advanced setting"),", fill in the following:")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"In User name field, specify ",(0,a.kt)("inlineCode",{parentName:"li"},"name")),(0,a.kt)("li",{parentName:"ul"},"In Full name field, specify ",(0,a.kt)("inlineCode",{parentName:"li"},"displayName")),(0,a.kt)("li",{parentName:"ul"},"In Email field, specify ",(0,a.kt)("inlineCode",{parentName:"li"},"email")," ",(0,a.kt)("img",{alt:"Userinfo Field Setting",src:t(80215).Z,width:"1550",height:"613"}))),(0,a.kt)("ol",{start:6},(0,a.kt)("li",{parentName:"ol"},"In the ",(0,a.kt)("strong",{parentName:"li"},"Authorization")," section, check \u201cLogged-in users can do anything\u201d. Disable \u201cAllow anonymous read access\u201d. You can configure more complex authorization later, for now check if OpenID actually works.")),(0,a.kt)("p",null,"Log out of Jenkins, it should now redirect you to Casdoor for authentication. ",(0,a.kt)("img",{alt:"Jenkins Login Page",src:t(2845).Z,width:"1383",height:"769"})))}d.isMDXComponent=!0},66496:(e,n,t)=>{t.d(n,{Z:()=>i});const i=t.p+"assets/images/casdoor_origin-8f5d9e44f6b58828ce69e6e6d896e122.png"},9871:(e,n,t)=>{t.d(n,{Z:()=>i});const i=t.p+"assets/images/appseeting_jenkins-6e0a2968614d0735005951278f44c008.png"},2498:(e,n,t)=>{t.d(n,{Z:()=>i});const i=t.p+"assets/images/jenkins_auto-acde42e269bf8ed09bf57320d1eecdc0.png"},80215:(e,n,t)=>{t.d(n,{Z:()=>i});const i=t.p+"assets/images/jenkins_field-31b28e80dce83b780c934c68648ed0e1.png"},4289:(e,n,t)=>{t.d(n,{Z:()=>i});const i=t.p+"assets/images/jenkins_global_security-0f4feee9caf8c58579f9275e1f281333.png"},2845:(e,n,t)=>{t.d(n,{Z:()=>i});const i=t.p+"assets/images/jenkins_login-d7c2179fcdc73e29ca6b90c494cba55b.png"},38517:(e,n,t)=>{t.d(n,{Z:()=>i});const i=t.p+"assets/images/jenkins_manual-e28d6e6af536025049ea2a3a22f38eb3.png"},25742:(e,n,t)=>{t.d(n,{Z:()=>i});const i=t.p+"assets/images/jenkins_url-9e8f261138a88501bdfce79ee1c1f3fa.png"}}]);