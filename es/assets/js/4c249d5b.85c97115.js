"use strict";(self.webpackChunkcasdoor_website=self.webpackChunkcasdoor_website||[]).push([[3887],{3905:(e,a,o)=>{o.d(a,{Zo:()=>c,kt:()=>m});var t=o(67294);function n(e,a,o){return a in e?Object.defineProperty(e,a,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[a]=o,e}function r(e,a){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);a&&(t=t.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),o.push.apply(o,t)}return o}function i(e){for(var a=1;a<arguments.length;a++){var o=null!=arguments[a]?arguments[a]:{};a%2?r(Object(o),!0).forEach((function(a){n(e,a,o[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(o,a))}))}return e}function s(e,a){if(null==e)return{};var o,t,n=function(e,a){if(null==e)return{};var o,t,n={},r=Object.keys(e);for(t=0;t<r.length;t++)o=r[t],a.indexOf(o)>=0||(n[o]=e[o]);return n}(e,a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(t=0;t<r.length;t++)o=r[t],a.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}var l=t.createContext({}),u=function(e){var a=t.useContext(l),o=a;return e&&(o="function"==typeof e?e(a):i(i({},a),e)),o},c=function(e){var a=u(e.components);return t.createElement(l.Provider,{value:a},e.children)},p={inlineCode:"code",wrapper:function(e){var a=e.children;return t.createElement(t.Fragment,{},a)}},d=t.forwardRef((function(e,a){var o=e.components,n=e.mdxType,r=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),d=u(o),m=n,h=d["".concat(l,".").concat(m)]||d[m]||p[m]||r;return o?t.createElement(h,i(i({ref:a},c),{},{components:o})):t.createElement(h,i({ref:a},c))}));function m(e,a){var o=arguments,n=a&&a.mdxType;if("string"==typeof e||n){var r=o.length,i=new Array(r);i[0]=d;var s={};for(var l in a)hasOwnProperty.call(a,l)&&(s[l]=a[l]);s.originalType=e,s.mdxType="string"==typeof e?e:n,i[1]=s;for(var u=2;u<r;u++)i[u]=o[u];return t.createElement.apply(null,i)}return t.createElement.apply(null,o)}d.displayName="MDXCreateElement"},76541:(e,a,o)=>{o.r(a),o.d(a,{assets:()=>l,contentTitle:()=>i,default:()=>p,frontMatter:()=>r,metadata:()=>s,toc:()=>u});var t=o(87462),n=(o(67294),o(3905));const r={title:"NginxCommunityVersion",description:"Usando Casdoor con Nginx (No Nginx-Plus) y Oauth2-Proxy",keywords:["nginx","OAuth2-Proxy","nginx-community-version"],authors:["gzyzhy"]},i=void 0,s={unversionedId:"integration/C++/NginxCommunityVersion",id:"integration/C++/NginxCommunityVersion",title:"NginxCommunityVersion",description:"Usando Casdoor con Nginx (No Nginx-Plus) y Oauth2-Proxy",source:"@site/i18n/es/docusaurus-plugin-content-docs/current/integration/C++/NginxCommunityVersion.md",sourceDirName:"integration/C++",slug:"/integration/C++/NginxCommunityVersion",permalink:"/es/docs/integration/C++/NginxCommunityVersion",draft:!1,editUrl:"https://github.com/casdoor/casdoor-website/edit/master/docs/integration/C++/NginxCommunityVersion.md",tags:[],version:"current",frontMatter:{title:"NginxCommunityVersion",description:"Usando Casdoor con Nginx (No Nginx-Plus) y Oauth2-Proxy",keywords:["nginx","OAuth2-Proxy","nginx-community-version"],authors:["gzyzhy"]},sidebar:"tutorialSidebar",previous:{title:"Nginx",permalink:"/es/docs/integration/C++/Nginx"},next:{title:"Envoy",permalink:"/es/docs/integration/C++/Envoy"}},l={},u=[{value:"Prerrequisitos",id:"prerrequisitos",level:2},{value:"I. Configurar Casdoor",id:"i-configurar-casdoor",level:2},{value:"II. Configurar Oauth2-Proxy",id:"ii-configurar-oauth2-proxy",level:2},{value:"III. Configurar Nginx",id:"iii-configurar-nginx",level:2},{value:"Pruebas",id:"pruebas",level:2},{value:"Resoluci\xf3n de problemas",id:"resoluci\xf3n-de-problemas",level:2}],c={toc:u};function p(e){let{components:a,...r}=e;return(0,n.kt)("wrapper",(0,t.Z)({},c,r,{components:a,mdxType:"MDXLayout"}),(0,n.kt)("h2",{id:"prerrequisitos"},"Prerrequisitos"),(0,n.kt)("p",null,"Esta gu\xeda asume que tienes las siguientes condiciones:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Servicio Casdoor en funcionamiento. Si a\xfan no has instalado el servicio Casdoor, por favor consulta ",(0,n.kt)("a",{parentName:"li",href:"https://casdoor.org/docs/basic/server-installation"},"Instalaci\xf3n del Servidor")," o ",(0,n.kt)("a",{parentName:"li",href:"https://casdoor.org/docs/basic/try-with-docker"},"Prueba con Docker"),"."),(0,n.kt)("li",{parentName:"ul"},"Edici\xf3n de c\xf3digo abierto de Nginx con el m\xf3dulo ",(0,n.kt)("inlineCode",{parentName:"li"},"ngx_http_auth_request_module")," habilitado en el momento de la compilaci\xf3n. Si no sabes c\xf3mo habilitar el m\xf3dulo ",(0,n.kt)("inlineCode",{parentName:"li"},"ngx_http_auth_request_module"),", por favor consulta el ",(0,n.kt)("a",{parentName:"li",href:"https://nginx.org/en/docs/http/ngx_http_auth_request_module.html"},"Documento del M\xf3dulo de Nginx"),"."),(0,n.kt)("li",{parentName:"ul"},"El sitio web en el que deseas habilitar la autenticaci\xf3n est\xe1 exitosamente desplegado en Nginx, con un ",(0,n.kt)("strong",{parentName:"li"},"nombre de dominio configurado")," (en lugar de usar una direcci\xf3n IP), y puede ser accedido normalmente."),(0,n.kt)("li",{parentName:"ul"},"Herramienta OAuth2-Proxy (actualmente, los siguientes dos proyectos populares con muchas estrellas est\xe1n disponibles en GitHub, y necesitas elegir uno de ellos):")),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"oauth2-proxy/oauth2-proxy (usado en este art\xedculo) ",(0,n.kt)("a",{parentName:"li",href:"https://github.com/oauth2-proxy/oauth2-proxy"},"GitHub")," O ",(0,n.kt)("a",{parentName:"li",href:"https://oauth2-proxy.github.io/oauth2-proxy"},"Sitio Oficial")),(0,n.kt)("li",{parentName:"ol"},"vouch/vouch-proxy ",(0,n.kt)("a",{parentName:"li",href:"https://github.com/vouch/vouch-proxy"},"GitHub"))),(0,n.kt)("h2",{id:"i-configurar-casdoor"},"I. Configurar Casdoor"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Nota"),": Las operaciones en este art\xedculo se basan en la GUI de Casdoor en el momento de la publicaci\xf3n, pero la GUI de Casdoor puede cambiar dependiendo de la versi\xf3n. Por favor, sigue las referencias proporcionadas en este art\xedculo para configurar tu versi\xf3n de Casdoor desplegada."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Nota"),": Las claves, contrase\xf1as, nombres de usuario y otra informaci\xf3n confidencial mencionada en este art\xedculo son todos ejemplos. Por razones de seguridad, debes reemplazarlos con tu propio contenido relevante al desplegar."),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Inicia sesi\xf3n en tu cuenta de administrador de Casdoor.")),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},'En la barra superior, selecciona "Autenticaci\xf3n de Identidad" > "Aplicaciones", y luego haz clic en "Agregar" en la p\xe1gina de "Aplicaciones".'),(0,n.kt)("p",{parentName:"li"},(0,n.kt)("img",{alt:"addApp",src:o(17381).Z,width:"2532",height:"1170"}))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},'Completa la configuraci\xf3n de la aplicaci\xf3n basada en la informaci\xf3n de tu proyecto. En este art\xedculo, usamos "Nginx-Community" como el nombre de la aplicaci\xf3n de ejemplo.'),(0,n.kt)("p",{parentName:"li"},(0,n.kt)("img",{alt:"ConfigureApp",src:o(42002).Z,width:"2532",height:"1170"}))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},'Toma nota de los valores de los campos "Client ID" y "Client Secret". Se utilizar\xe1n al configurar OAuth2-Proxy m\xe1s adelante. Luego configura la "URL de Redirecci\xf3n" como ',(0,n.kt)("inlineCode",{parentName:"p"},"https://project.yourdomain.com/oauth2/callback/"),"."),(0,n.kt)("p",{parentName:"li"},(0,n.kt)("img",{alt:"RecordInfo",src:o(378).Z,width:"2532",height:"1170"}))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},'En la barra superior, selecciona "Gesti\xf3n de Permisos de Casbin" > "Roles", y luego haz clic en "Agregar" en la p\xe1gina de "Roles".'),(0,n.kt)("p",{parentName:"li"},(0,n.kt)("img",{alt:"AddRole",src:o(77228).Z,width:"2532",height:"1170"}))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},'Completa la configuraci\xf3n del rol basada en la informaci\xf3n de tu proyecto. En este art\xedculo, usamos "nginx_role" como el nombre del rol de ejemplo.'),(0,n.kt)("p",{parentName:"li"},(0,n.kt)("img",{alt:"ConfigureRole",src:o(76532).Z,width:"2532",height:"1170"}))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},'(Opcional) En la barra superior, selecciona "Gesti\xf3n de Usuarios" > "Usuarios", y luego agrega nuevos usuarios seg\xfan tus necesidades. Si los usuarios que necesitas ya existen, puedes omitir este paso. En este art\xedculo, creamos un usuario de ejemplo llamado "usuario".')),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},'Vuelve a la p\xe1gina de "Roles" mencionada en el paso 5, edita el rol ',(0,n.kt)("inlineCode",{parentName:"p"},"nginx_role"),', y agrega los usuarios que necesitas a la opci\xf3n "Usuarios Incluidos". En este art\xedculo, agregamos el ',(0,n.kt)("inlineCode",{parentName:"p"},"builtin/user")," creado previamente aqu\xed."))),(0,n.kt)("h2",{id:"ii-configurar-oauth2-proxy"},"II. Configurar Oauth2-Proxy"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Nota"),": Este art\xedculo utiliza el proyecto Oauth2-Proxy como ejemplo. Si deseas usar Vouch en lugar de Oauth2-Proxy, por favor consulta su documentaci\xf3n oficial en ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/vouch/vouch-proxy"},"GitHub"),"."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Nota"),": Este art\xedculo asume que tu sitio est\xe1 configurado con un certificado SSL de confianza y solo permite el acceso HTTPS, o que has configurado una redirecci\xf3n autom\xe1tica de visitantes HTTP a HTTPS. Esto ayuda a maximizar la protecci\xf3n de las cookies y previene la lectura maliciosa de los tokens de inicio de sesi\xf3n. Si tu sitio necesita ser accedido a trav\xe9s del protocolo HTTP inseguro, por favor modifica los comandos relevantes en consecuencia. Para obtener m\xe1s ayuda con la implementaci\xf3n a trav\xe9s de HTTP, por favor consulta la documentaci\xf3n oficial de Oauth2-Proxy en ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/oauth2-proxy/oauth2-proxy"},"GitHub"),"."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Consejos"),": ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/oauth2-proxy/oauth2-proxy"},"OAuth2-Proxy"),' proporciona varios m\xe9todos de implementaci\xf3n (como compilaci\xf3n de c\xf3digo fuente, instalaci\xf3n de Docker, etc.). Para facilitar la explicaci\xf3n, este art\xedculo utiliza el "binario preconstruido" para la implementaci\xf3n.'),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Ve a la p\xe1gina de ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/oauth2-proxy/oauth2-proxy/releases"},"GitHub Releases")," y descarga el paquete binario correspondiente a tu sistema operativo y arquitectura de CPU.\nA partir del 1 de enero de 2024, la \xfaltima versi\xf3n de lanzamiento de OAuth-Proxy es ",(0,n.kt)("inlineCode",{parentName:"p"},"V7.5.1"),". Si deseas descargar el paquete binario para esta versi\xf3n, puedes ejecutar el siguiente comando para Linux con AMD64:"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"wget -O oauth2-proxy-linux.tar.gz https://github.com/oauth2-proxy/oauth2-proxy/releases/download/v7.5.1/oauth2-proxy-v7.5.1.linux-amd64.tar.gz\n")),(0,n.kt)("p",{parentName:"li"},"Se recomienda encarecidamente que verifiques el valor de ",(0,n.kt)("inlineCode",{parentName:"p"},"SHA256SUM")," proporcionado por el sitio oficial en la p\xe1gina de ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/oauth2-proxy/oauth2-proxy/releases"},"GitHub Releases")," despu\xe9s de descargar el paquete comprimido y lo compares con el valor de ",(0,n.kt)("inlineCode",{parentName:"p"},"SHA256SUM")," del paquete que descargaste, car\xe1cter por car\xe1cter.")),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Extrae el paquete descargado:"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"tar -zxvf oauth2-proxy-*.tar.gz\n"))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Entra en el directorio extra\xeddo:"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"cd oauth2-proxy-v7.5.1.linux-amd64\n"))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Mueve el archivo binario obtenido a ",(0,n.kt)("inlineCode",{parentName:"p"},"/usr/local/bin")," y config\xfaralo con permisos de ejecuci\xf3n. Puede que necesites elevar permisos usando ",(0,n.kt)("inlineCode",{parentName:"p"},"sudo")," dependiendo de tu situaci\xf3n."),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"cp ./oauth2-proxy /usr/local/bin\ncd /usr/local/bin\nchmod +x ./oauth2-proxy\n"))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Prueba la instalaci\xf3n del binario. Si la instalaci\xf3n es exitosa, despu\xe9s de ejecutar el siguiente comando, deber\xedas ver una salida similar a ",(0,n.kt)("inlineCode",{parentName:"p"},"oauth2-proxy v7.5.1 (construido con go1.21.1)"),"."),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"cd ~\noauth2-proxy --version\n"))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Ejecuta oauth2-proxy con par\xe1metros de l\xednea de comandos. Los par\xe1metros marcados con ","[requerido]"," deben ser configurados de acuerdo a tu situaci\xf3n espec\xedfica, mientras que los par\xe1metros marcados con ","[opcional]"," pueden optimizar el rendimiento pero tambi\xe9n pueden ser omitidos. Para asegurar que oauth2-proxy pueda ejecutarse en segundo plano, puedes usar herramientas de monitoreo de procesos como ",(0,n.kt)("inlineCode",{parentName:"p"},"Screen")," o ",(0,n.kt)("inlineCode",{parentName:"p"},"Supervisor")," o herramientas de terminal."),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"oauth2-proxy \\ \n--provider=oidc \\ #[required] Do not change\n--client-id=abc123456def \\ #[required] \"Client ID\" obtained in step I.4 above\n--client-secret=abc123456def \\ #[required] \"Client Secret\" obtained in step I.4 above\n--oidc-issuer-url=https://auth.yourdomain.com \\ #[required] Your Casdoor URL (domain name or public IP)\n--redirect-url=https://project.yourdomain.com/oauth2/callback \\ #[required] https://domain-of-the-project-to-protect/oauth2/callback \n--scope=email+profile+groups+openid \\ #[required] Obtained from Casdoor: user email, user profile, groups, and login authentication\n--cookie-domain=project.yourdomain.com \\ #[required] Domain name of the project you want to protect\n--whitelist-domain=project.yourdomain.com \\ #[required] Domain name of the project you want to protect\n--cookie-secret=abc123456def \\ #[required] Please generate a random string of numbers and letters and fill it in here\n--email-domain=* \\ #[required] List of acceptable user email domains (* means accept all domains). If the user's email suffix is not in this list, a 403 error will be returned even if the login is successful.\n--insecure-oidc-allow-unverified-email=true \\ #[required] Whether to accept users with unverified email addresses\n--http-address=http://127.0.0.1:65534 \\ #[required] Address that oauth2-proxy listens on. The port number here can be set arbitrarily. Please record the value you set, as it will be needed for configuring Nginx later.\n--cookie-expire=24h0m0s \\ #[optional] Cookie expiration time. After this period, users will need to log in again.\n--custom-sign-in-logo=https://cdn.yourdomain.com/pic/proj.png \\ #[optional] Icon displayed on the login page. It is recommended to use a rectangular image rather than a square one.\n--session-store-type=redis \\ #[optional] Use Redis cache. If you don't need Redis, you can delete this item.\n--redis-connection-url=redis://127.0.0.1:6379/0 \\ #[optional] Redis URL. If you don't need Redis, you can delete this item.\n--redis-password=123456 #[optional] Redis connection password. If you don't need Redis or Redis has no password, you can delete this item.\n")))),(0,n.kt)("h2",{id:"iii-configurar-nginx"},"III. Configurar Nginx"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Nota"),": Por favor, confirma de nuevo que tu Nginx ha habilitado el m\xf3dulo ",(0,n.kt)("inlineCode",{parentName:"p"},"ngx_http_auth_request_module")," al compilar e instalar desde el c\xf3digo fuente (el comando de compilaci\xf3n incluye ",(0,n.kt)("inlineCode",{parentName:"p"},"--with_http_auth_request_module"),"). Si no sabes c\xf3mo habilitar el m\xf3dulo ",(0,n.kt)("inlineCode",{parentName:"p"},"ngx_http_auth_request_module"),", por favor consulta el ",(0,n.kt)("a",{parentName:"p",href:"https://nginx.org/en/docs/http/ngx_http_auth_request_module.html"},"Documento del M\xf3dulo de Nginx"),"."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Consejos"),": Nginx instalado usando la herramienta del panel Baota no habilita este m\xf3dulo por defecto."),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Abre el archivo de configuraci\xf3n del sitio web que ya has desplegado y quieres proteger, y realiza las siguientes modificaciones:"),(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"Nota"),": Necesitas ajustar este archivo de configuraci\xf3n de acuerdo a tu situaci\xf3n espec\xedfica. Debido a las versiones de Nginx y otros factores, este archivo de configuraci\xf3n puede no funcionar sin problemas en todas las instancias de Nginx. Por favor, ajusta el contenido relevante basado en tu propia informaci\xf3n de Nginx."),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-nginx"},'server {\n    listen 443 ssl http2;\n\n    include /path/to/ssl.conf;\n\n    # Add the following content\n    location ^~ /oauth2/ {\n        proxy_pass       http://127.0.0.1:65534; # Change this to the "--http-address" configured in step II.6\n\n        proxy_set_header Host                    $host;\n        proxy_set_header X-Real-IP               $remote_addr;\n        proxy_set_header X-Scheme                $scheme;\n\n        proxy_set_header X-Auth-Request-Redirect $request_uri;\n        # or, if you are handling multiple domains:\n        # proxy_set_header X-Auth-Request-Redirect $scheme://$host$request_uri;\n    }\n    location = /oauth2/auth {\n        proxy_pass       http://127.0.0.1:65534; # Change this to the "--http-address" configured in step II.6\n\n        proxy_set_header Host             $host;\n        proxy_set_header X-Real-IP        $remote_addr;\n        proxy_set_header X-Scheme         $scheme;\n        proxy_set_header Content-Length   "";\n        proxy_pass_request_body           off;\n    }\n    location ^~ / {\n        auth_request /oauth2/auth;\n        error_page 401 = /oauth2/sign_in;\n\n        auth_request_set $user   $upstream_http_x_auth_request_user; \n        auth_request_set $email  $upstream_http_x_auth_request_email; \n        proxy_set_header X-User  $user; # Pass the username of the user logged in to your backend service\n        proxy_set_header X-Email $email; # Pass the email of the user logged in to your backend service\n\n        auth_request_set $token  $upstream_http_x_auth_request_access_token;\n        proxy_set_header X-Access-Token $token; # Pass the user\'s login token to your backend service\n\n        # The following configurations are related to cookie validation for user login\n        auth_request_set $auth_cookie $upstream_http_set_cookie;\n        add_header Set-Cookie $auth_cookie;\n\n        auth_request_set $auth_cookie_name_upstream_1 $upstream_cookie_auth_cookie_name_1;\n\n        if ($auth_cookie ~* "(; .*)") {\n            set $auth_cookie_name_0 $auth_cookie;\n            set $auth_cookie_name_1 "auth_cookie_name_1=$auth_cookie_name_upstream_1$1";\n        }   \n\n        if ($auth_cookie_name_upstream_1) {\n            add_header Set-Cookie $auth_cookie_name_0;\n            add_header Set-Cookie $auth_cookie_name_1;\n        }\n        proxy_no_cache $cookie_session;\n\n        # Provide the web page to the user after successful validation\n\n        proxy_pass http://127.0.0.1:8080; # The address where your backend service runs\n        # Note: This is not the Casdoor deployment address or the Oauth2-Proxy running address, but the address where your backend service that needs login protection runs.\n\n        # Then add configurations to pass user IP, Connection request headers, etc., to your backend service, for example:\n        proxy_set_header X-Forwarded-For $remote_addr;\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection upgrade;\n        proxy_set_header Accept-Encoding gzip;\n    }\n    access_log /path/to/access_log.log;\n    error_log /path/to/error_log.log;\n}\n'))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Guarda el archivo y recarga tu Nginx."))),(0,n.kt)("h2",{id:"pruebas"},"Pruebas"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"A continuaci\xf3n, puedes probar tu implementaci\xf3n."),(0,n.kt)("li",{parentName:"ul"},"En circunstancias normales, tus usuarios pasar\xe1n por el siguiente proceso al iniciar sesi\xf3n en tu servicio:"),(0,n.kt)("li",{parentName:"ul"},"Abrir la URL ",(0,n.kt)("inlineCode",{parentName:"li"},"project.yourdomain.com"),' en un navegador -> Solo ver una p\xe1gina que requiere inicio de sesi\xf3n, incluyendo un bot\xf3n llamado "Iniciar sesi\xf3n con OpenID Connect" -> Hacer clic en el bot\xf3n y ser redirigido a tu direcci\xf3n de Casdoor, donde se les pedir\xe1 que inicien sesi\xf3n -> Los usuarios ingresan su nombre de usuario y contrase\xf1a, y Casdoor verifica sus credenciales -> Redirecci\xf3n autom\xe1tica de vuelta a tu URL ',(0,n.kt)("inlineCode",{parentName:"li"},"project.yourdomain.com")," -> Acceso exitoso a tu servicio -> A los usuarios se les pedir\xe1 que inicien sesi\xf3n nuevamente cuando expire el tiempo de ",(0,n.kt)("inlineCode",{parentName:"li"},"--cookie-expire")," que configuraste.")),(0,n.kt)("h2",{id:"resoluci\xf3n-de-problemas"},"Resoluci\xf3n de problemas"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Si tu proyecto no funciona como se espera, por favor verifica la correcci\xf3n de tu configuraci\xf3n de Nginx y los par\xe1metros de configuraci\xf3n de Oauth2-Proxy."),(0,n.kt)("li",{parentName:"ul"},"Tambi\xe9n puedes consultar la documentaci\xf3n oficial de Oauth2-Proxy en ",(0,n.kt)("a",{parentName:"li",href:"https://github.com/oauth2-proxy/oauth2-proxy"},"GitHub"),"."),(0,n.kt)("li",{parentName:"ul"},"Si encuentras alg\xfan error en este documento, no dudes en solicitar ediciones en GitHub.")))}p.isMDXComponent=!0},77228:(e,a,o)=>{o.d(a,{Z:()=>t});const t=o.p+"assets/images/AddRole-b385b307305fe11ca476ee9d0b41ab0d.png"},42002:(e,a,o)=>{o.d(a,{Z:()=>t});const t=o.p+"assets/images/ConfigureApp-fc36fc06dd93b4e8ff438a160c34a255.png"},76532:(e,a,o)=>{o.d(a,{Z:()=>t});const t=o.p+"assets/images/ConfigureRole-ba58c31b5d67a3929107a49083d6c505.png"},378:(e,a,o)=>{o.d(a,{Z:()=>t});const t=o.p+"assets/images/RecordInfo-f8bf04f982122eba51e222fd47375ce0.png"},17381:(e,a,o)=>{o.d(a,{Z:()=>t});const t=o.p+"assets/images/addApp-ce709a1272f7c601539f9dc5dfe90894.png"}}]);