"use strict";(self.webpackChunkcasdoor_website=self.webpackChunkcasdoor_website||[]).push([[1345],{3905:(e,t,o)=>{o.d(t,{Zo:()=>d,kt:()=>u});var a=o(67294);function n(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function r(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,a)}return o}function i(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?r(Object(o),!0).forEach((function(t){n(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function p(e,t){if(null==e)return{};var o,a,n=function(e,t){if(null==e)return{};var o,a,n={},r=Object.keys(e);for(a=0;a<r.length;a++)o=r[a],t.indexOf(o)>=0||(n[o]=e[o]);return n}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)o=r[a],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}var l=a.createContext({}),c=function(e){var t=a.useContext(l),o=t;return e&&(o="function"==typeof e?e(t):i(i({},t),e)),o},d=function(e){var t=c(e.components);return a.createElement(l.Provider,{value:t},e.children)},s={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var o=e.components,n=e.mdxType,r=e.originalType,l=e.parentName,d=p(e,["components","mdxType","originalType","parentName"]),m=c(o),u=n,f=m["".concat(l,".").concat(u)]||m[u]||s[u]||r;return o?a.createElement(f,i(i({ref:t},d),{},{components:o})):a.createElement(f,i({ref:t},d))}));function u(e,t){var o=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var r=o.length,i=new Array(r);i[0]=m;var p={};for(var l in t)hasOwnProperty.call(t,l)&&(p[l]=t[l]);p.originalType=e,p.mdxType="string"==typeof e?e:n,i[1]=p;for(var c=2;c<r;c++)i[c]=o[c];return a.createElement.apply(null,i)}return a.createElement.apply(null,o)}m.displayName="MDXCreateElement"},82091:(e,t,o)=>{o.r(t),o.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>s,frontMatter:()=>r,metadata:()=>p,toc:()=>c});var a=o(87462),n=(o(67294),o(3905));const r={title:"Zentao",description:"Usando Casdoor para autentica\xe7\xe3o no Zentao",keywords:["Zentao","zentao-oidc"],authors:["leo220yuyaodog"]},i=void 0,p={unversionedId:"integration/php/zentao",id:"integration/php/zentao",title:"Zentao",description:"Usando Casdoor para autentica\xe7\xe3o no Zentao",source:"@site/i18n/pt/docusaurus-plugin-content-docs/current/integration/php/zentao.md",sourceDirName:"integration/php",slug:"/integration/php/zentao",permalink:"/pt/docs/integration/php/zentao",draft:!1,editUrl:"https://github.com/casdoor/casdoor-website/edit/master/docs/integration/php/zentao.md",tags:[],version:"current",frontMatter:{title:"Zentao",description:"Usando Casdoor para autentica\xe7\xe3o no Zentao",keywords:["Zentao","zentao-oidc"],authors:["leo220yuyaodog"]},sidebar:"tutorialSidebar",previous:{title:"Zabbix",permalink:"/pt/docs/integration/php/Zabbix"},next:{title:"Usando Casdoor como um Servidor OAuth2 no ShowDoc",permalink:"/pt/docs/integration/php/showdoc"}},l={},c=[{value:"Etapa 1: Implementar Casdoor e Zentao",id:"etapa-1-implementar-casdoor-e-zentao",level:2},{value:"Etapa 2: Integrar o m\xf3dulo OIDC de terceiros do Zentao",id:"etapa-2-integrar-o-m\xf3dulo-oidc-de-terceiros-do-zentao",level:2},{value:"Etapa 3: Configurar Aplicativo Casdoor",id:"etapa-3-configurar-aplicativo-casdoor",level:2},{value:"Etapa 4: Configurar Zentao",id:"etapa-4-configurar-zentao",level:2}],d={toc:c};function s(e){let{components:t,...r}=e;return(0,n.kt)("wrapper",(0,a.Z)({},d,r,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://www.zentao.pm/"},"Zentao")," \xe9 um sistema/ferramenta de gerenciamento de projetos \xe1gil (scrum), mas n\xe3o suporta OIDC por si s\xf3. Para integrar o Zentao com o SSO do Casdoor, precisamos usar um m\xf3dulo OIDC de terceiros chamado ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/casdoor/zentao-oidc"},"zentao-oidc"),", e este documento mostrar\xe1 como fazer isso."),(0,n.kt)("h2",{id:"etapa-1-implementar-casdoor-e-zentao"},"Etapa 1: Implementar Casdoor e Zentao"),(0,n.kt)("p",null,"Primeiramente, implemente ",(0,n.kt)("a",{parentName:"p",href:"/docs/basic/server-installation"},"Casdoor")," e ",(0,n.kt)("a",{parentName:"p",href:"https://www.zentao.pm/download/zentao-community-edition-release-164-1100.html"},"Zentao"),". Ap\xf3s uma implementa\xe7\xe3o bem-sucedida, certifique-se de:"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"Casdoor pode ser acessado e usado com sucesso."),(0,n.kt)("li",{parentName:"ol"},"Voc\xea pode acessar e usar o Zentao com sucesso.")),(0,n.kt)("h2",{id:"etapa-2-integrar-o-m\xf3dulo-oidc-de-terceiros-do-zentao"},"Etapa 2: Integrar o m\xf3dulo OIDC de terceiros do Zentao"),(0,n.kt)("p",null,"Instale ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/casdoor/zentao-oidc"},"zentao-oidc")," executando o seguinte comando:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-java"},"git clone https://github.com/casdoor/zentao-oidc.git\n")),(0,n.kt)("p",null,"Alternativamente, voc\xea pode baixar o ZIP e descompact\xe1-lo."),(0,n.kt)("p",null,"Este m\xf3dulo \xe9 usado para integrar o Zentao com SSO para OpenId. Eis como us\xe1-lo:"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Copie o diret\xf3rio inteiro ",(0,n.kt)("inlineCode",{parentName:"p"},"oidc")," para o m\xf3dulo do Zentao e use-o como um m\xf3dulo do Zentao. Renomeie o pacote baixado para 'oidc'.")),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Configure o filtro."),(0,n.kt)("p",{parentName:"li"},"Como o framework do Zentao filtra os par\xe2metros na URL e n\xe3o permite espa\xe7os, voc\xea precisa colocar o seguinte c\xf3digo no final de ",(0,n.kt)("inlineCode",{parentName:"p"},"/config/my.php"),"."),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-php"},"$filter->oidc = new stdclass();\n$filter->oidc->index = new stdclass();\n$filter->oidc->index->paramValue['scope'] = 'reg::any';\n"))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Modifique ",(0,n.kt)("inlineCode",{parentName:"p"},"/module/commom/model.php"),"."),(0,n.kt)("p",{parentName:"li"},"Adicione 'oidc' \xe0 lista de acesso an\xf4nimo e adicione uma linha ao m\xe9todo ",(0,n.kt)("inlineCode",{parentName:"p"},"isOpenMethod")," de ",(0,n.kt)("inlineCode",{parentName:"p"},"model.php"),"."),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-php"},"public function isOpenMethod($module, $method)\n{          \n    if ($module == 'oidc' and $method == 'index') {\n        return true; \n    }\n}\n"))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Se voc\xea n\xe3o quer que a tela de login do Zentao apare\xe7a, v\xe1 diretamente para a tela de login do Casdoor."),(0,n.kt)("p",{parentName:"li"},"Modifique a \xfaltima linha de c\xf3digo em ",(0,n.kt)("inlineCode",{parentName:"p"},"public function checkPriv()")," em ",(0,n.kt)("inlineCode",{parentName:"p"},"/module/common/model.php"),"."),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-php"},"//return print(js::locate(helper::createLink('user', 'login', \"referer=$referer\")));\nreturn print(js::locate(helper::createLink('oidc', 'index', \"referer=$referer\")));\n"))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Modifique o m\xe9todo ",(0,n.kt)("inlineCode",{parentName:"p"},"setSuperVars()")," dentro de ",(0,n.kt)("inlineCode",{parentName:"p"},"framework/base/router.class.php")," e comente as seguintes declara\xe7\xf5es."),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-php"},"public function setSuperVars()\n//  unset($_REQUEST);\n")))),(0,n.kt)("h2",{id:"etapa-3-configurar-aplicativo-casdoor"},"Etapa 3: Configurar Aplicativo Casdoor"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"Crie um novo aplicativo Casdoor ou use um existente."),(0,n.kt)("li",{parentName:"ol"},"Adicione sua URL de redirecionamento.",(0,n.kt)("img",{alt:"Configura\xe7\xe3o do Aplicativo Casdoor",src:o(9798).Z,width:"793",height:"360"})),(0,n.kt)("li",{parentName:"ol"},"Adicione o provedor que voc\xea deseja e preencha outras configura\xe7\xf5es necess\xe1rias.")),(0,n.kt)("h2",{id:"etapa-4-configurar-zentao"},"Etapa 4: Configurar Zentao"),(0,n.kt)("p",null,"Configure o arquivo ",(0,n.kt)("inlineCode",{parentName:"p"},"config.php")," no diret\xf3rio ",(0,n.kt)("inlineCode",{parentName:"p"},"oidc"),"."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-php"},'$config->oidc->clientId = "<Your ClientId>";\n$config->oidc->clientSecret = "<Your ClientSecret>";\n$config->oidc->issuer = "http://localhost:8000";\n')),(0,n.kt)("p",null,"Defina sua URL de redirecionamento em ",(0,n.kt)("inlineCode",{parentName:"p"},"module/oidc")," no m\xe9todo ",(0,n.kt)("inlineCode",{parentName:"p"},"public function index()"),"."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-php"},'$oidc->setRedirectURL($path."/zentao/oidc-index.html");\n')),(0,n.kt)("admonition",{type:"note"},(0,n.kt)("p",{parentName:"admonition"},"A URL aqui se refere a chamar o m\xe9todo 'index' no m\xf3dulo 'oidc'. Voc\xea tamb\xe9m precisa definir um separador de vari\xe1veis. Por padr\xe3o, o framework usa um tra\xe7o ('-'). Por favor, consulte o framework oficial do Zentao para mais detalhes. ",(0,n.kt)("a",{parentName:"p",href:"https://devel.easycorp.cn/book/zentaophphelp/about-10.html"},'"zentaoPHP\u6846\u67b6"'))))}s.isMDXComponent=!0},9798:(e,t,o)=>{o.d(t,{Z:()=>a});const a=o.p+"assets/images/clientId-563efc95f2798062bde65091a87cc546.png"}}]);