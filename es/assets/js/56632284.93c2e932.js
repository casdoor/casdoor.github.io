"use strict";(self.webpackChunkcasdoor_website=self.webpackChunkcasdoor_website||[]).push([[5526],{3905:(a,e,r)=>{r.d(e,{Zo:()=>u,kt:()=>f});var n=r(67294);function t(a,e,r){return e in a?Object.defineProperty(a,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):a[e]=r,a}function o(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),r.push.apply(r,n)}return r}function i(a){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?o(Object(r),!0).forEach((function(e){t(a,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(e){Object.defineProperty(a,e,Object.getOwnPropertyDescriptor(r,e))}))}return a}function c(a,e){if(null==a)return{};var r,n,t=function(a,e){if(null==a)return{};var r,n,t={},o=Object.keys(a);for(n=0;n<o.length;n++)r=o[n],e.indexOf(r)>=0||(t[r]=a[r]);return t}(a,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(a);for(n=0;n<o.length;n++)r=o[n],e.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(a,r)&&(t[r]=a[r])}return t}var s=n.createContext({}),l=function(a){var e=n.useContext(s),r=e;return a&&(r="function"==typeof a?a(e):i(i({},e),a)),r},u=function(a){var e=l(a.components);return n.createElement(s.Provider,{value:e},a.children)},p={inlineCode:"code",wrapper:function(a){var e=a.children;return n.createElement(n.Fragment,{},e)}},d=n.forwardRef((function(a,e){var r=a.components,t=a.mdxType,o=a.originalType,s=a.parentName,u=c(a,["components","mdxType","originalType","parentName"]),d=l(r),f=t,g=d["".concat(s,".").concat(f)]||d[f]||p[f]||o;return r?n.createElement(g,i(i({ref:e},u),{},{components:r})):n.createElement(g,i({ref:e},u))}));function f(a,e){var r=arguments,t=e&&e.mdxType;if("string"==typeof a||t){var o=r.length,i=new Array(o);i[0]=d;var c={};for(var s in e)hasOwnProperty.call(e,s)&&(c[s]=e[s]);c.originalType=a,c.mdxType="string"==typeof a?a:t,i[1]=c;for(var l=2;l<o;l++)i[l]=r[l];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}d.displayName="MDXCreateElement"},34194:(a,e,r)=>{r.r(e),r.d(e,{assets:()=>s,contentTitle:()=>i,default:()=>p,frontMatter:()=>o,metadata:()=>c,toc:()=>l});var n=r(87462),t=(r(67294),r(3905));const o={title:"Grafana",description:"Usando Casdoor para autenticaci\xf3n en Grafana",keywords:["Grafana"],authors:["ComradeProgrammer"]},i=void 0,c={unversionedId:"integration/go/grafana",id:"integration/go/grafana",title:"Grafana",description:"Usando Casdoor para autenticaci\xf3n en Grafana",source:"@site/i18n/es/docusaurus-plugin-content-docs/current/integration/go/grafana.md",sourceDirName:"integration/go",slug:"/integration/go/grafana",permalink:"/es/docs/integration/go/grafana",draft:!1,editUrl:"https://github.com/casdoor/casdoor-website/edit/master/docs/integration/go/grafana.md",tags:[],version:"current",frontMatter:{title:"Grafana",description:"Usando Casdoor para autenticaci\xf3n en Grafana",keywords:["Grafana"],authors:["ComradeProgrammer"]},sidebar:"tutorialSidebar",previous:{title:"Gitea",permalink:"/es/docs/integration/go/gitea"},next:{title:"MinIO",permalink:"/es/docs/integration/go/minio"}},s={},l=[{value:"Usando Casdoor para autenticaci\xf3n en Grafana",id:"usando-casdoor-para-autenticaci\xf3n-en-grafana",level:2},{value:"Paso 1: Crear una aplicaci\xf3n para Grafana en Casdoor",id:"paso-1-crear-una-aplicaci\xf3n-para-grafana-en-casdoor",level:2},{value:"Paso 2: Modificar la configuraci\xf3n de Grafana",id:"paso-2-modificar-la-configuraci\xf3n-de-grafana",level:2},{value:"Acerca de HTTPS",id:"acerca-de-https",level:3},{value:"Acerca de redirectURI despu\xe9s de Iniciar Sesi\xf3n Con Casdoor",id:"acerca-de-redirecturi-despu\xe9s-de-iniciar-sesi\xf3n-con-casdoor",level:3},{value:"Acerca del Mapeo de Roles",id:"acerca-del-mapeo-de-roles",level:3},{value:"Paso 3: Ver si funciona",id:"paso-3-ver-si-funciona",level:2}],u={toc:l};function p(a){let{components:e,...o}=a;return(0,t.kt)("wrapper",(0,n.Z)({},u,o,{components:e,mdxType:"MDXLayout"}),(0,t.kt)("h2",{id:"usando-casdoor-para-autenticaci\xf3n-en-grafana"},"Usando Casdoor para autenticaci\xf3n en Grafana"),(0,t.kt)("p",null,(0,t.kt)("a",{parentName:"p",href:"https://grafana.com/oss/grafana/"},"Grafana")," soporta autenticaci\xf3n v\xeda OAuth. Por lo tanto, es extremadamente f\xe1cil para los usuarios utilizar Casdoor para iniciar sesi\xf3n en Grafana. Solo se necesitan varios pasos y configuraciones simples para lograrlo."),(0,t.kt)("p",null,"Aqu\xed hay un tutorial sobre c\xf3mo usar Casdoor para autenticaci\xf3n en Grafana. Antes de continuar, por favor aseg\xfarate de tener Grafana instalado y en funcionamiento."),(0,t.kt)("h2",{id:"paso-1-crear-una-aplicaci\xf3n-para-grafana-en-casdoor"},"Paso 1: Crear una aplicaci\xf3n para Grafana en Casdoor"),(0,t.kt)("p",null,"Aqu\xed hay un ejemplo de c\xf3mo crear una aplicaci\xf3n en Casdoor:"),(0,t.kt)("p",null,(0,t.kt)("img",{alt:"Crear una aplicaci\xf3n en Casdoor",src:r(34709).Z,width:"1367",height:"810"})),(0,t.kt)("p",null,"Por favor copia el secreto del cliente y el ID del cliente para el siguiente paso."),(0,t.kt)("p",null,"Por favor agrega la URL de callback de Grafana. Por defecto, el callback OAuth de Grafana es ",(0,t.kt)("inlineCode",{parentName:"p"},"/login/generic_oauth"),". As\xed que por favor concatena esta URL correctamente."),(0,t.kt)("h2",{id:"paso-2-modificar-la-configuraci\xf3n-de-grafana"},"Paso 2: Modificar la configuraci\xf3n de Grafana"),(0,t.kt)("p",null,"Por defecto, el archivo de configuraci\xf3n para OAuth se encuentra en ",(0,t.kt)("inlineCode",{parentName:"p"},"conf/defaults.ini")," en el directorio de trabajo de Grafana."),(0,t.kt)("p",null,"Por favor encuentra la secci\xf3n ",(0,t.kt)("inlineCode",{parentName:"p"},"[auth.generic_oauth]")," y modifica los siguientes campos:"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-ini"},"[auth.generic_oauth]\nname = Casdoor\nicon = signin\nenabled = true\nallow_sign_up = true\nclient_id = <client ID from previous step>\nclient_secret = <client secret from previous step>\nauth_url = <Casdoor endpoint>/login/oauth/authorize\ntoken_url = <Casdoor endpoint>/api/login/oauth/access_token\n\n")),(0,t.kt)("h3",{id:"acerca-de-https"},"Acerca de HTTPS"),(0,t.kt)("p",null,"Si no quieres que HTTPS est\xe9 habilitado para Casdoor o si despliegas Grafana sin HTTPS habilitado, por favor tambi\xe9n establece ",(0,t.kt)("inlineCode",{parentName:"p"},"tls_skip_verify_insecure = true"),"."),(0,t.kt)("h3",{id:"acerca-de-redirecturi-despu\xe9s-de-iniciar-sesi\xf3n-con-casdoor"},"Acerca de redirectURI despu\xe9s de Iniciar Sesi\xf3n Con Casdoor"),(0,t.kt)("p",null,"Si la URI de redirecci\xf3n no es correcta despu\xe9s de iniciar sesi\xf3n con Casdoor en Grafana, es posible que quieras configurar ",(0,t.kt)("a",{parentName:"p",href:"https://stackoverflow.com/a/69814805"},"root_url"),"."),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-ini"},"[server]\nhttp_port = 3000\n# The public-facing domain name used to access Grafana from a browser\ndomain = <your IP here>\n# The full public-facing URL\nroot_url = %(protocol)s://%(domain)s:%(http_port)s/\n")),(0,t.kt)("p",null,"Enlaces relacionados:"),(0,t.kt)("ol",null,(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("p",{parentName:"li"},(0,t.kt)("a",{parentName:"p",href:"https://grafana.com/docs/grafana/latest/setup-grafana/configure-grafana/#root_url"},"Documentaci\xf3n de Grafana"))),(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("p",{parentName:"li"},(0,t.kt)("a",{parentName:"p",href:"https://github.com/grafana/grafana/blob/main/conf/defaults.ini"},"Grafana defaults.ini")))),(0,t.kt)("h3",{id:"acerca-del-mapeo-de-roles"},"Acerca del Mapeo de Roles"),(0,t.kt)("p",null,"Es posible que quieras configurar ",(0,t.kt)("inlineCode",{parentName:"p"},"role_attribute_path")," para mapear el rol de tu usuario a Grafana v\xeda ",(0,t.kt)("a",{parentName:"p",href:"https://grafana.com/docs/grafana/latest/setup-grafana/configure-security/configure-authentication/generic-oauth/#role-mapping"},"role_attribute_path"),"."),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-ini"},"[auth.generic_oauth]\nrole_attribute_path = contains(roles[*].name, 'admin') && 'Admin' || contains(roles[*].name, 'editor') && 'Editor' || 'Viewer'\nrole_attribute_strict = true\nallow_assign_grafana_admin = true\n")),(0,t.kt)("p",null,"La expresi\xf3n JMESPath despu\xe9s de ",(0,t.kt)("inlineCode",{parentName:"p"},"role_attribute_path")," es muy importante aqu\xed. Por favor consulta la documentaci\xf3n de Grafana."),(0,t.kt)("h2",{id:"paso-3-ver-si-funciona"},"Paso 3: Ver si funciona"),(0,t.kt)("p",null,"Apaga Grafana y rein\xedcialo."),(0,t.kt)("p",null,"Ve a la p\xe1gina de inicio de sesi\xf3n. Deber\xedas ver algo como esto:"),(0,t.kt)("p",null,(0,t.kt)("img",{alt:"Resultado final",src:r(60591).Z,width:"1384",height:"739"})))}p.isMDXComponent=!0},34709:(a,e,r)=>{r.d(e,{Z:()=>n});const n=r.p+"assets/images/grafana_1-9f197ebf06da48585fe18ce1d66ce212.png"},60591:(a,e,r)=>{r.d(e,{Z:()=>n});const n=r.p+"assets/images/grafana_2-5136a37a917e1c899feedb23e218fa13.png"}}]);