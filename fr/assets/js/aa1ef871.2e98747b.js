"use strict";(self.webpackChunkcasdoor_website=self.webpackChunkcasdoor_website||[]).push([[2588],{3905:(e,t,r)=>{r.d(t,{Zo:()=>u,kt:()=>m});var n=r(67294);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var s=n.createContext({}),p=function(e){var t=n.useContext(s),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},u=function(e){var t=p(e.components);return n.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var r=e.components,o=e.mdxType,a=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),d=p(r),m=o,b=d["".concat(s,".").concat(m)]||d[m]||c[m]||a;return r?n.createElement(b,i(i({ref:t},u),{},{components:r})):n.createElement(b,i({ref:t},u))}));function m(e,t){var r=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=r.length,i=new Array(a);i[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:o,i[1]=l;for(var p=2;p<a;p++)i[p]=r[p];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}d.displayName="MDXCreateElement"},54460:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>c,frontMatter:()=>a,metadata:()=>l,toc:()=>p});var n=r(87462),o=(r(67294),r(3905));const a={title:"GitLab",description:"Utiliser Casdoor pour l'authentification dans un serveur GitLab auto-d\xe9velopp\xe9",keywords:["GitLab"],authors:["Steve0x2a"]},i=void 0,l={unversionedId:"integration/ruby/gitlab",id:"integration/ruby/gitlab",title:"GitLab",description:"Utiliser Casdoor pour l'authentification dans un serveur GitLab auto-d\xe9velopp\xe9",source:"@site/i18n/fr/docusaurus-plugin-content-docs/current/integration/ruby/gitlab.md",sourceDirName:"integration/ruby",slug:"/integration/ruby/gitlab",permalink:"/fr/docs/integration/ruby/gitlab",draft:!1,editUrl:"https://github.com/casdoor/casdoor-website/edit/master/docs/integration/ruby/gitlab.md",tags:[],version:"current",frontMatter:{title:"GitLab",description:"Utiliser Casdoor pour l'authentification dans un serveur GitLab auto-d\xe9velopp\xe9",keywords:["GitLab"],authors:["Steve0x2a"]},sidebar:"tutorialSidebar",previous:{title:"Ruby",permalink:"/fr/docs/category/ruby"},next:{title:"Haskell",permalink:"/fr/docs/category/haskell"}},s={},p=[{value:"\xc9tape 1 : D\xe9ployer Casdoor et GitLab",id:"\xe9tape-1--d\xe9ployer-casdoor-et-gitlab",level:2},{value:"\xc9tape 2 : Configurer l&#39;application Casdoor",id:"\xe9tape-2--configurer-lapplication-casdoor",level:2},{value:"\xc9tape 3 : Configurer GitLab",id:"\xe9tape-3--configurer-gitlab",level:2}],u={toc:p};function c(e){let{components:t,...a}=e;return(0,o.kt)("wrapper",(0,n.Z)({},u,a,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Casdoor peut utiliser le protocole OIDC pour se lier \xe0 un serveur GitLab auto-d\xe9ploy\xe9, et ce document vous montrera comment faire."),(0,o.kt)("admonition",{type:"caution"},(0,o.kt)("p",{parentName:"admonition"},"Comme le stipulent les ",(0,o.kt)("a",{parentName:"p",href:"https://docs.gitlab.com/ee/administration/auth/oidc.html#configure-keycloak"},"documents GitLab"),", GitLab ne fonctionne qu'avec les fournisseurs OpenID qui utilisent HTTPS, donc vous devez d\xe9ployer Casdoor avec HTTPS, comme le mettre derri\xe8re un proxy inverse NGINX avec une configuration de certificat SSL. Casdoor lui-m\xeame n'\xe9coute que sur le port 8000 par d\xe9faut via HTTP et n'a aucune fonctionnalit\xe9 li\xe9e \xe0 HTTPS.")),(0,o.kt)("p",null,"Voici quelques-uns des noms mentionn\xe9s dans la configuration :"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"CASDOOR_HOSTNAME")," : Le nom de domaine ou l'IP o\xf9 le serveur Casdoor est d\xe9ploy\xe9, par exemple, ",(0,o.kt)("inlineCode",{parentName:"p"},"https://door.casbin.com"),"."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"GITLAB_HOSTNAME")," : Le nom de domaine ou l'IP o\xf9 GitLab est d\xe9ploy\xe9, par exemple, ",(0,o.kt)("inlineCode",{parentName:"p"},"https://gitlab.com"),"."),(0,o.kt)("h2",{id:"\xe9tape-1--d\xe9ployer-casdoor-et-gitlab"},"\xc9tape 1 : D\xe9ployer Casdoor et GitLab"),(0,o.kt)("p",null,"Tout d'abord, Casdoor et GitLab doivent \xeatre d\xe9ploy\xe9s."),(0,o.kt)("p",null,"Apr\xe8s un d\xe9ploiement r\xe9ussi, vous devez vous assurer :"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Casdoor peut \xeatre connect\xe9 et utilis\xe9 normalement."),(0,o.kt)("li",{parentName:"ol"},"D\xe9finissez la valeur ",(0,o.kt)("inlineCode",{parentName:"li"},"origin")," de Casdoor (conf/app.conf) sur ",(0,o.kt)("inlineCode",{parentName:"li"},"CASDOOR_HOSTNAME"),". ",(0,o.kt)("img",{alt:"Configuration de Casdoor",src:r(66496).Z,width:"1013",height:"448"}))),(0,o.kt)("h2",{id:"\xe9tape-2--configurer-lapplication-casdoor"},"\xc9tape 2 : Configurer l'application Casdoor"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Cr\xe9ez ou utilisez une application Casdoor existante."),(0,o.kt)("li",{parentName:"ol"},"Ajoutez une URL de redirection : ",(0,o.kt)("inlineCode",{parentName:"li"},"http://GITLAB_HOSTNAME/users/auth/openid_connect/callback"),"."),(0,o.kt)("li",{parentName:"ol"},"Ajoutez le fournisseur que vous souhaitez et compl\xe9tez les autres param\xe8tres.")),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Param\xe8tre d&#39;application",src:r(18687).Z,width:"1571",height:"658"})," Notamment, vous pouvez obtenir deux valeurs sur la page des param\xe8tres de l'application : ",(0,o.kt)("inlineCode",{parentName:"p"},"Client ID")," et ",(0,o.kt)("inlineCode",{parentName:"p"},"Client secret")," (voir l'image ci-dessus), et nous les utiliserons \xe0 l'\xe9tape suivante."),(0,o.kt)("p",null,"Ouvrez votre navigateur pr\xe9f\xe9r\xe9 et visitez : ",(0,o.kt)("strong",{parentName:"p"},"http://",(0,o.kt)("inlineCode",{parentName:"strong"},"CASDOOR_HOSTNAME"),"/.well-known/openid-configuration"),", o\xf9 vous verrez la configuration OIDC de Casdoor."),(0,o.kt)("h2",{id:"\xe9tape-3--configurer-gitlab"},"\xc9tape 3 : Configurer GitLab"),(0,o.kt)("p",null,"Vous pouvez suivre les \xe9tapes ci-dessous pour configurer cela, ou apporter des modifications personnalis\xe9es selon ",(0,o.kt)("a",{parentName:"p",href:"https://docs.gitlab.com/ee/administration/auth/oidc.html#casdoor"},"ce document")," (par exemple, si vous installez GitLab \xe0 l'aide du code source plut\xf4t que de l'Omnibus)."),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Sur votre serveur GitLab, ouvrez le fichier de configuration."),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"sudo editor /etc/gitlab/gitlab.rb\n"))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Ajoutez la configuration du fournisseur. (L'URL HOSTNAME doit inclure http ou https)"),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-ruby"},'gitlab_rails[\'omniauth_providers\'] = [\n    {\n        name: "openid_connect",\n        label: "Casdoor", # optional label for the login button, defaults to "Openid Connect"\n        args: {\n            name: "openid_connect",\n            scope: ["openid", "profile", "email"],\n            response_type: "code",\n            issuer:  "<CASDOOR_HOSTNAME>",\n            client_auth_method: "query",\n            discovery: true,\n            uid_field: "preferred_username",\n            client_options: {\n                identifier: "<YOUR CLIENT ID>",\n                secret: "<YOUR CLIENT SECRET>",\n                redirect_uri: "<GITLAB_HOSTNAME>/users/auth/openid_connect/callback"\n            }\n        }\n    }\n]\n'))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Red\xe9marrez votre serveur GitLab.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Chaque utilisateur enregistr\xe9 peut ouvrir ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"strong"},"GITLAB_HOSTNAME"),"/-/profile/account")," et connecter le compte Casdoor. ",(0,o.kt)("img",{alt:"Connexion GitLab",src:r(11405).Z,width:"2648",height:"926"}))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Termin\xe9. Maintenant, vous pouvez vous connecter \xe0 votre propre GitLab en utilisant Casdoor. ",(0,o.kt)("img",{alt:"Login GitLab",src:r(149).Z,width:"2127",height:"1315"})))))}c.isMDXComponent=!0},66496:(e,t,r)=>{r.d(t,{Z:()=>n});const n=r.p+"assets/images/casdoor_origin-8f5d9e44f6b58828ce69e6e6d896e122.png"},18687:(e,t,r)=>{r.d(t,{Z:()=>n});const n=r.p+"assets/images/appsetting_gitlab-a7b6bb0c825259b068b3761fc249e79d.png"},11405:(e,t,r)=>{r.d(t,{Z:()=>n});const n=r.p+"assets/images/gitlab_connect-f62ead92f802fcdb4db244f128b04711.png"},149:(e,t,r)=>{r.d(t,{Z:()=>n});const n=r.p+"assets/images/gitlab_login-190fea801337b81056835c566872d439.png"}}]);