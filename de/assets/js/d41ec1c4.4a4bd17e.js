(self.webpackChunkcasdoor_website=self.webpackChunkcasdoor_website||[]).push([[9019],{3905:function(e,n,t){"use strict";t.d(n,{Zo:function(){return u},kt:function(){return g}});var r=t(7294);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,r,i=function(e,n){if(null==e)return{};var t,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var s=r.createContext({}),d=function(e){var n=r.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},u=function(e){var n=d(e.components);return r.createElement(s.Provider,{value:n},e.children)},c={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},p=r.forwardRef((function(e,n){var t=e.components,i=e.mdxType,a=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),p=d(t),g=i,m=p["".concat(s,".").concat(g)]||p[g]||c[g]||a;return t?r.createElement(m,o(o({ref:n},u),{},{components:t})):r.createElement(m,o({ref:n},u))}));function g(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var a=t.length,o=new Array(a);o[0]=p;var l={};for(var s in n)hasOwnProperty.call(n,s)&&(l[s]=n[s]);l.originalType=e,l.mdxType="string"==typeof e?e:i,o[1]=l;for(var d=2;d<a;d++)o[d]=t[d];return r.createElement.apply(null,o)}return r.createElement.apply(null,t)}p.displayName="MDXCreateElement"},8215:function(e,n,t){"use strict";var r=t(7294);n.Z=function(e){var n=e.children,t=e.hidden,i=e.className;return r.createElement("div",{role:"tabpanel",hidden:t,className:i},n)}},5064:function(e,n,t){"use strict";t.d(n,{Z:function(){return p}});var r=t(4034),i=t(7294),a=t(2389),o=t(9443);var l=function(){var e=(0,i.useContext)(o.Z);if(null==e)throw new Error('"useUserPreferencesContext" is used outside of "Layout" component.');return e},s=t(9558),d=t(6010),u="tabItem_1uMI";function c(e){var n,t,r,a=e.lazy,o=e.block,c=e.defaultValue,p=e.values,g=e.groupId,m=e.className,f=i.Children.map(e.children,(function(e){if((0,i.isValidElement)(e)&&"string"==typeof e.props.value)return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})),h=null!=p?p:f.map((function(e){var n=e.props;return{value:n.value,label:n.label}})),v=(0,s.lx)(h,(function(e,n){return e.value===n.value}));if(v.length>0)throw new Error('Docusaurus error: Duplicate values "'+v.map((function(e){return e.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.');var k=null===c?c:null!=(n=null!=c?c:null==(t=f.find((function(e){return e.props.default})))?void 0:t.props.value)?n:null==(r=f[0])?void 0:r.props.value;if(null!==k&&!h.some((function(e){return e.value===k})))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+k+'" but none of its children has the corresponding value. Available values are: '+h.map((function(e){return e.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");var b=l(),S=b.tabGroupChoices,C=b.setTabGroupChoices,N=(0,i.useState)(k),w=N[0],y=N[1],z=[],I=(0,s.o5)().blockElementScrollPositionUntilNextRender;if(null!=g){var x=S[g];null!=x&&x!==w&&h.some((function(e){return e.value===x}))&&y(x)}var j=function(e){var n=e.currentTarget,t=z.indexOf(n),r=h[t].value;r!==w&&(I(n),y(r),null!=g&&C(g,r))},T=function(e){var n,t=null;switch(e.key){case"ArrowRight":var r=z.indexOf(e.currentTarget)+1;t=z[r]||z[0];break;case"ArrowLeft":var i=z.indexOf(e.currentTarget)-1;t=z[i]||z[z.length-1]}null==(n=t)||n.focus()};return i.createElement("div",{className:"tabs-container"},i.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,d.Z)("tabs",{"tabs--block":o},m)},h.map((function(e){var n=e.value,t=e.label;return i.createElement("li",{role:"tab",tabIndex:w===n?0:-1,"aria-selected":w===n,className:(0,d.Z)("tabs__item",u,{"tabs__item--active":w===n}),key:n,ref:function(e){return z.push(e)},onKeyDown:T,onFocus:j,onClick:j},null!=t?t:n)}))),a?(0,i.cloneElement)(f.filter((function(e){return e.props.value===w}))[0],{className:"margin-vert--md"}):i.createElement("div",{className:"margin-vert--md"},f.map((function(e,n){return(0,i.cloneElement)(e,{key:n,hidden:e.props.value!==w})}))))}function p(e){var n=(0,a.Z)();return i.createElement(c,(0,r.Z)({key:String(n)},e))}},9443:function(e,n,t){"use strict";var r=(0,t(7294).createContext)(void 0);n.Z=r},3082:function(e,n,t){"use strict";t.r(n),t.d(n,{frontMatter:function(){return d},contentTitle:function(){return u},metadata:function(){return c},toc:function(){return p},default:function(){return m}});var r=t(4034),i=t(9973),a=(t(7294),t(3905)),o=t(5064),l=t(8215),s=["components"],d={sidebar_position:1,title:"Fr\xfchlingsstart"},u=void 0,c={unversionedId:"integration/spring-boot",id:"integration/spring-boot",isDocsHomePage:!1,title:"Fr\xfchlingsstart",description:"casdoor-spring-boot-example ist ein Beispiel f\xfcr die Verwendung von casdoor-java-sdk im SpringBoot Projekt. Wir zeigen Ihnen die folgenden Schritte.",source:"@site/i18n/de/docusaurus-plugin-content-docs/current/integration/spring-boot.mdx",sourceDirName:"integration",slug:"/integration/spring-boot",permalink:"/de/docs/integration/spring-boot",editUrl:"https://github.com/casdoor/casdoor-website/tree/master/docs/integration/spring-boot.mdx",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1,title:"Fr\xfchlingsstart"},sidebar:"tutorialSidebar",previous:{title:"Konfiguration",permalink:"/de/docs/ldap/config"},next:{title:"Jenkins (OIDC)",permalink:"/de/docs/integration/jenkins"}},p=[{value:"Schritt1. Deploy Casdoor",id:"schritt1-deploy-casdoor",children:[],level:2},{value:"Schritt 2. Casdoor-java-sdk importieren",id:"schritt-2-casdoor-java-sdk-importieren",children:[],level:2},{value:"Schritt3. Init-Konfiguration",id:"schritt3-init-konfiguration",children:[],level:2},{value:"Schritt 4. Zur Login-Seite weiterleiten",id:"schritt-4-zur-login-seite-weiterleiten",children:[],level:2},{value:"Schritt5. Token und parsen",id:"schritt5-token-und-parsen",children:[],level:2},{value:"Schritt6. Benutzerdienst",id:"schritt6-benutzerdienst",children:[],level:2}],g={toc:p};function m(e){var n=e.components,t=(0,i.Z)(e,s);return(0,a.kt)("wrapper",(0,r.Z)({},g,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://github.com/casdoor/casdoor-spring-boot-example"},"casdoor-spring-boot-example")," ist ein Beispiel f\xfcr die Verwendung von ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/casdoor/casdoor-java-sdk"},"casdoor-java-sdk")," im SpringBoot Projekt. Wir zeigen Ihnen die folgenden Schritte."),(0,a.kt)("h2",{id:"schritt1-deploy-casdoor"},"Schritt1. Deploy Casdoor"),(0,a.kt)("p",null,"Erstens sollte die Casdoor eingesetzt werden."),(0,a.kt)("p",null,"Sie k\xf6nnen sich die offizielle Casdoor Dokumentation f\xfcr die ",(0,a.kt)("a",{parentName:"p",href:"/docs/basic/server-installation"},"Server-Installation")," ansehen."),(0,a.kt)("p",null,"Nach einem erfolgreichen Einsatz musst du sicherstellen:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Der Casdoor Server l\xe4uft erfolgreich auf ",(0,a.kt)("strong",{parentName:"li"},"http://localhost:8000"),"."),(0,a.kt)("li",{parentName:"ul"},"\xd6ffnen Sie Ihren bevorzugten Browser und besuchen Sie ",(0,a.kt)("strong",{parentName:"li"},"http://localhost:7001"),", Sie sehen die Login-Seite von Casdoor."),(0,a.kt)("li",{parentName:"ul"},"Eingabe von ",(0,a.kt)("inlineCode",{parentName:"li"},"Admin")," und ",(0,a.kt)("inlineCode",{parentName:"li"},"123")," , um die Login-Funktionalit\xe4t zu testen, funktioniert gut.")),(0,a.kt)("p",null,"Dann k\xf6nnen Sie schnell eine kassierende Anmeldeseite in Ihrer eigenen App mit den folgenden Schritten implementieren."),(0,a.kt)("h2",{id:"schritt-2-casdoor-java-sdk-importieren"},"Schritt 2. Casdoor-java-sdk importieren"),(0,a.kt)("p",null,"Sie k\xf6nnen die casdoor-java-sdk mit maven oder gradle importieren."),(0,a.kt)(o.Z,{defaultValue:"maven",groupId:"import-sdk",values:[{label:"Maven",value:"maven"},{label:"Gradle",value:"gradle"}],mdxType:"Tabs"},(0,a.kt)(l.Z,{value:"maven",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-xml"},"<dependency>\n    <groupId>org.casbin</groupId>\n    <artifactId>casdoor-java-sdk</artifactId>\n    <version>1.x.y</version>\n</dependency>\n"))),(0,a.kt)(l.Z,{value:"gradle",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-xml"},"implementation 'org.casbin:casdoor-java-sdk:1.x.y'\n")))),(0,a.kt)("h2",{id:"schritt3-init-konfiguration"},"Schritt3. Init-Konfiguration"),(0,a.kt)("p",null,"Die Initialisierung erfordert 6 Parameter, die alle String-Typen sind.\n| Name (in Reihenfolge) | Muss | Beschreibung                                    |\n| --------------------- | ---- | ----------------------------------------------- |\n| endpoint              | Ja   | Casdoor Server Url, wie ",(0,a.kt)("inlineCode",{parentName:"p"},"http://localhost:8000")," |\n| clientId              | Ja   | Anwendung.client_id                             |\n| clientSecret          | Ja   | Anwendung.client_secret                         |\n| jwtSecret             | Ja   | Wie Casdoor JWT Geheimnis.                      |\n| organisationsname     | Ja   | Anwendung.Organisation                          |\n| anwendungsname        | Ja   | Application.name                                |\nSie k\xf6nnen Java-Eigenschaften oder YAML-Dateien verwenden, um init wie unten."),(0,a.kt)(o.Z,{defaultValue:"properties",groupId:"configuration",values:[{label:"Properties",value:"properties"},{label:"YML",value:"yml"}],mdxType:"Tabs"},(0,a.kt)(l.Z,{value:"properties",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-properties"},"casdoor.endpoint = http://localhost:8000\ncasdoor.clientId = 874e3e05e58d50148c65\ncasdoor.clientSecret = 41510b84c7267ad2e4d2b51096b7f11dc9c5fdc8\ncasdoor.jwtSecret = CasdoorSecret\ncasdoor.organizationName = built-in\ncasdoor.applicationName = app-built-in\n"))),(0,a.kt)(l.Z,{value:"yml",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml"},"casdoor:\n  endpoint: http://localhost:8000\n  client-id: 874e3e05e58d50148c65\n  client-secret: 41510b84c7267ad2e4d2b51096b7f11dc9c5fdc8\n  jwt-secret: CasdoorSecret\n  organization-name: built-in\n  application-name: app-built-in\n")))),(0,a.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,a.kt)("div",{parentName:"div",className:"admonition-heading"},(0,a.kt)("h5",{parentName:"div"},(0,a.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,a.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,a.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,a.kt)("div",{parentName:"div",className:"admonition-content"},(0,a.kt)("p",{parentName:"div"},"Sie sollten die Konfiguration durch Ihre eigene Casdoor Instanz ersetzen, insbesondere durch die ",(0,a.kt)("inlineCode",{parentName:"p"},"clientId")," und den ",(0,a.kt)("inlineCode",{parentName:"p"},"clientSecret"),"."))),(0,a.kt)("p",null,"Erstellen Sie dann ",(0,a.kt)("inlineCode",{parentName:"p"},"CasdoorSdkProperties")," Klasse, deklarieren Sie Mitgliedsvariablen, die der Konfiguration entsprechen und liefern Sie Getter und Setter."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},'@Data\n@Component\n@ConfigurationProperties(prefix = "casdoor")\npublic class CasdoorSdkProperties {\n    private String endpoint;\n    private String clientId;\n    private String clientSecret;\n    private String jwtSecret;\n    private String organizationName;\n    private String applicationName;\n}\n')),(0,a.kt)("p",null,"Erstelle ",(0,a.kt)("inlineCode",{parentName:"p"},"CasdoorSdkConfig")," Klasse, init ",(0,a.kt)("inlineCode",{parentName:"p"},"CasdoorConfig")," mit der Instanz von CasdoorSdkProperties."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},"@Configuration\npublic class CasdoorSdkConfig {\n\n    @Resource\n    private CasdoorSdkProperties casdoorSdkProperties;\n\n    @Bean\n    public CasdoorConfig getCasdoorConfig() {\n        return new CasdoorConfig(\n                casdoorSdkProperties.getEndpoint(),\n                casdoorSdkProperties.getClientId(),\n                casdoorSdkProperties.getClientSecret(),\n                casdoorSdkProperties.getJwtSecret(),\n                casdoorSdkProperties.getOrganizationName(),\n                casdoorSdkProperties.getApplicationName()\n        );\n    }\n}\n")),(0,a.kt)("p",null,"Beim Start der SpringBoot Anwendung wird die Konfiguration in den Java-Eigenschaften oder YAML automatisch in die Mitgliedsvariablen in ",(0,a.kt)("inlineCode",{parentName:"p"},"CasdoorSdkProperties")," injiziert."),(0,a.kt)("p",null,"So k\xf6nnen Sie ",(0,a.kt)("inlineCode",{parentName:"p"},"getCasdoorConfig")," Methode in ",(0,a.kt)("inlineCode",{parentName:"p"},"CasdoorSdkConfig")," Klasse verwenden, um ",(0,a.kt)("inlineCode",{parentName:"p"},"CasdoorConfig")," Instanz \xfcberall zu erhalten."),(0,a.kt)("h2",{id:"schritt-4-zur-login-seite-weiterleiten"},"Schritt 4. Zur Login-Seite weiterleiten"),(0,a.kt)("p",null,"Wenn Sie die Authentifizierung ben\xf6tigen, die auf Ihre App zugreift, k\xf6nnen Sie die Ziel-URL senden und zur Login-Seite von Casdoor weiterleiten."),(0,a.kt)("p",null,"Bitte stellen Sie sicher, dass Sie die Callback-URL (z.B. ",(0,a.kt)("strong",{parentName:"p"},"http://localhost:8080/login"),") in der Anwendungskonfiguration im Voraus hinzugef\xfcgt haben."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},'@RequestMapping("toLogin")\npublic String toLogin() {\n    CasdoorConfig casdoorConfig = casdoorSdkConfig.getCasdoorConfig();\n    String targetUrl = String.format("%s/login/oauth/authorize?client_id=%s&response_type=code&redirect_uri=%s&scope=read&state=%s",\n            "http://localhost:7001", casdoorConfig.getClientId(),\n            "http://localhost:8080/login", casdoorConfig.getApplicationName());\n    return "redirect:" + targetUrl;\n}\n')),(0,a.kt)("h2",{id:"schritt5-token-und-parsen"},"Schritt5. Token und parsen"),(0,a.kt)("p",null,"Nach dem Verifizieren von Casdoor wird es auf Ihre Bewerbung mit Code und Status umgeleitet."),(0,a.kt)("p",null,"Sie k\xf6nnen den Code erhalten und die ",(0,a.kt)("inlineCode",{parentName:"p"},"getOAuthToken")," Methode aufrufen, dann jwt token parsen."),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"CasdoorUser")," enth\xe4lt die grundlegenden Informationen \xfcber den Nutzer von Casdoor, Sie k\xf6nnen es als Schl\xfcsselwort verwenden, um die Sitzung in Ihrer Anwendung zu setzen."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},'@RequestMapping("login")\npublic String login(String code, String state, HttpServletRequest request) {\n    CasdoorAuthService casdoorAuthService = new CasdoorAuthService(casdoorSdkConfig.getCasdoorConfig());\n    String token = "";\n    CasdoorUser user = null;\n    try {\n        token = casdoorAuthService.getOAuthToken(code, state);\n        user = casdoorAuthService.parseJwtToken(token);\n    } catch (OAuthSystemException | OAuthProblemException | ParseException | InvocationTargetException | IllegalAccessException e) {\n        e.printStackTrace();\n    }\n    HttpSession session = request.getSession();\n    session.setAttribute("casdoorUser", user);\n    return "redirect:/";\n}\n')),(0,a.kt)("h2",{id:"schritt6-benutzerdienst"},"Schritt6. Benutzerdienst"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"CasdoorUserService")," unterst\xfctzt einfache Benutzeroperationen, wie:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"GetUser(name string)"),", erhalte einen Benutzer mit Benutzernamen."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"GetUsers()"),", holen Sie alle Benutzer."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"UpdateUser(auth.User)/AddUser(auth.User)/DeleteUser(auth.User)"),", schreibt Benutzer in die Datenbank.")))}m.isMDXComponent=!0}}]);