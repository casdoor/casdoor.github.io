"use strict";(self.webpackChunkcasdoor_website=self.webpackChunkcasdoor_website||[]).push([[7503],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>m});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),d=p(n),m=r,g=d["".concat(s,".").concat(m)]||d[m]||c[m]||i;return n?a.createElement(g,o(o({ref:t},u),{},{components:n})):a.createElement(g,o({ref:t},u))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:r,o[1]=l;for(var p=2;p<i;p++)o[p]=n[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},48182:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>c,frontMatter:()=>i,metadata:()=>l,toc:()=>p});var a=n(87462),r=(n(67294),n(3905));const i={title:"Nginx",description:"Utilisation de Casdoor avec Nginx",keywords:["nginx","plus","nginx-plus"],authors:["SkipperQ"]},o=void 0,l={unversionedId:"integration/C++/Nginx",id:"integration/C++/Nginx",title:"Nginx",description:"Utilisation de Casdoor avec Nginx",source:"@site/i18n/fr/docusaurus-plugin-content-docs/current/integration/C++/Nginx.md",sourceDirName:"integration/C++",slug:"/integration/C++/Nginx",permalink:"/fr/docs/integration/C++/Nginx",draft:!1,editUrl:"https://github.com/casdoor/casdoor-website/edit/master/docs/integration/C++/Nginx.md",tags:[],version:"current",frontMatter:{title:"Nginx",description:"Utilisation de Casdoor avec Nginx",keywords:["nginx","plus","nginx-plus"],authors:["SkipperQ"]},sidebar:"tutorialSidebar",previous:{title:"C++",permalink:"/fr/docs/category/cpp"},next:{title:"NginxCommunityVersion",permalink:"/fr/docs/integration/C++/NginxCommunityVersion"}},s={},p=[{value:"Pr\xe9requis",id:"pr\xe9requis",level:2},{value:"Configuration de Casdoor",id:"configuration-de-casdoor",level:2},{value:"Configuration de NGINX Plus",id:"configuration-de-nginx-plus",level:2},{value:"Tests",id:"tests",level:2},{value:"D\xe9pannage",id:"d\xe9pannage",level:2}],u={toc:p};function c(e){let{components:t,...i}=e;return(0,r.kt)("wrapper",(0,a.Z)({},u,i,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"Activez la connexion unique bas\xe9e sur OpenID Connect pour les applications proxifi\xe9es par NGINX Plus en utilisant Casdoor comme fournisseur d'identit\xe9 (IdP)."),(0,r.kt)("p",null,"Ce guide explique comment activer la connexion unique (SSO) pour les applications qui sont proxifi\xe9es par NGINX Plus. La solution utilise OpenID Connect comme m\xe9canisme d'authentification, avec ",(0,r.kt)("a",{parentName:"p",href:"https://casdoor.org/"},"Casdoor")," comme fournisseur d'identit\xe9 (IdP), et NGINX Plus comme partie de confiance."),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Voir aussi : Vous pouvez trouver plus d'informations sur l'int\xe9gration OpenID Connect de NGINX Plus dans le r\xe9pertoire GitHub du projet.")),(0,r.kt)("h2",{id:"pr\xe9requis"},"Pr\xe9requis"),(0,r.kt)("p",null,"Les instructions supposent que vous disposez des \xe9l\xe9ments suivants :"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Un serveur Casdoor en fonctionnement. Reportez-vous \xe0 la documentation de Casdoor pour ",(0,r.kt)("a",{parentName:"p",href:"https://casdoor.org/docs/basic/server-installation"},"l'Installation du Serveur")," et ",(0,r.kt)("a",{parentName:"p",href:"https://casdoor.org/docs/basic/try-with-docker"},"Essayer avec Docker"),".")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Un abonnement NGINX Plus et NGINX Plus R15 ou ult\xe9rieur. Pour les instructions d'installation, consultez le ",(0,r.kt)("a",{parentName:"p",href:"https://docs.nginx.com/nginx/admin-guide/installing-nginx/installing-nginx-plus/"},"Guide d'administration NGINX Plus"),".")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Le ",(0,r.kt)("a",{parentName:"p",href:"https://www.nginx.com/blog/introduction-nginscript/"},"module JavaScript NGINX"),", qui est requis pour g\xe9rer l'interaction entre NGINX Plus et l'IdP. Apr\xe8s avoir install\xe9 NGINX Plus, installez le module en utilisant la commande appropri\xe9e pour votre syst\xe8me d'exploitation."),(0,r.kt)("p",{parentName:"li"},"  Pour Debian et Ubuntu :"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"sudo apt install nginx-plus-module-njs\n")),(0,r.kt)("p",{parentName:"li"},"  Pour CentOS, RHEL et Oracle Linux :"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"sudo yum install nginx-plus-module-njs\n"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},'La directive suivante doit \xeatre incluse dans le contexte de configuration de niveau sup\xe9rieur ("main") dans ',(0,r.kt)("strong",{parentName:"p"},"/etc/nginx/nginx.conf")," afin de charger le module JavaScript NGINX :"),(0,r.kt)("p",{parentName:"li"},"  ",(0,r.kt)("inlineCode",{parentName:"p"},"load_module modules/ngx_http_js_module.so;")))),(0,r.kt)("h2",{id:"configuration-de-casdoor"},"Configuration de Casdoor"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Note :")," La proc\xe9dure suivante refl\xe8te l'interface utilisateur de Casdoor au moment de la publication, mais l'interface utilisateur est susceptible de changer. Utilisez ce guide comme r\xe9f\xe9rence et adaptez-le \xe0 l'interface utilisateur actuelle de Casdoor si n\xe9cessaire."),(0,r.kt)("p",null,"Pour cr\xe9er un client Casdoor pour NGINX Plus dans l'interface utilisateur de Casdoor, suivez ces \xe9tapes :"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Connectez-vous \xe0 votre compte Casdoor sur ",(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("a",{parentName:"strong",href:"http://your-casdoor-url.com/login/"},"http://your-casdoor-url.com/login/")),".")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Dans la colonne de navigation sup\xe9rieure, cliquez sur ",(0,r.kt)("strong",{parentName:"p"},"Application"),". Sur la page ",(0,r.kt)("strong",{parentName:"p"},"Application")," qui s'ouvre, cliquez sur le bouton ",(0,r.kt)("strong",{parentName:"p"},"Ajouter")," dans le coin sup\xe9rieur gauche."),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{alt:"addApp",src:n(38655).Z,width:"1974",height:"228"}))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Sur la page ",(0,r.kt)("strong",{parentName:"p"},"Modifier l'Application")," qui s'ouvre, changez la valeur dans les champs ",(0,r.kt)("strong",{parentName:"p"},"Nom")," et ",(0,r.kt)("strong",{parentName:"p"},"Nom d'affichage")," pour le nom de l'application pour laquelle vous activez le SSO. Ici, nous utilisons NGINX Plus."),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{alt:"appName",src:n(82431).Z,width:"570",height:"214"})),(0,r.kt)("p",{parentName:"li"},"Dans le champ ",(0,r.kt)("strong",{parentName:"p"},"URLs de redirection"),", tapez l'URL de l'instance NGINX Plus incluant le num\xe9ro de port, et se terminant par ",(0,r.kt)("strong",{parentName:"p"},"/_codexch")," (dans ce guide, c'est ",(0,r.kt)("a",{parentName:"p",href:"https://your-site-url.com/_codexch"},"https://your-site-url.com:443/_codexch"),")."),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{alt:"redirectURL",src:n(4124).Z,width:"988",height:"252"})),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Notes :")),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Pour la production, nous recommandons fortement d'utiliser SSL/TLS (port 443)."),(0,r.kt)("li",{parentName:"ul"},"Le num\xe9ro de port est obligatoire m\xeame lorsque vous utilisez le port par d\xe9faut pour HTTP (80) ou HTTPS (443)."))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Notez les valeurs dans les champs ",(0,r.kt)("strong",{parentName:"p"},"ID Client")," et ",(0,r.kt)("strong",{parentName:"p"},"Secret Client"),". Vous les copierez dans le fichier de configuration NGINX Plus dans ",(0,r.kt)("a",{parentName:"p",href:"#jump1"},"l'\xe9tape 4 de ",(0,r.kt)("em",{parentName:"a"},"Configuration de NGINX Plus")),".",(0,r.kt)("span",{id:"jump3"})),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{alt:"Client",src:n(87564).Z,width:"1004",height:"216"}))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Cliquez sur ",(0,r.kt)("strong",{parentName:"p"},"R\xf4les")," dans la colonne de navigation sup\xe9rieure, puis cliquez sur le bouton ",(0,r.kt)("strong",{parentName:"p"},"Ajouter")," dans le coin sup\xe9rieur gauche de la page qui s'ouvre."),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{alt:"addRole",src:n(80816).Z,width:"1986",height:"224"}))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Sur la page ",(0,r.kt)("strong",{parentName:"p"},"Ajouter")," qui s'ouvre, tapez une valeur dans les champs ",(0,r.kt)("strong",{parentName:"p"},"Nom")," et ",(0,r.kt)("strong",{parentName:"p"},"Nom d'affichage")," (ici c'est nginx-casdoor-role) et cliquez sur le bouton ",(0,r.kt)("strong",{parentName:"p"},"Enregistrer"),"."),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{alt:"roleName",src:n(88165).Z,width:"670",height:"204"}))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Dans la colonne de navigation sup\xe9rieure, cliquez sur ",(0,r.kt)("strong",{parentName:"p"},"Utilisateurs"),". Sur la page ",(0,r.kt)("strong",{parentName:"p"},"Utilisateurs")," qui s'ouvre, cliquez soit sur ",(0,r.kt)("strong",{parentName:"p"},"Modifier")," pour \xe9diter l'un des utilisateurs existants, soit sur le bouton ",(0,r.kt)("strong",{parentName:"p"},"Ajouter")," dans le coin sup\xe9rieur gauche pour cr\xe9er un nouvel utilisateur.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Sur la page ",(0,r.kt)("strong",{parentName:"p"},"Ajouter")," qui s'ouvre, modifiez les champs ",(0,r.kt)("strong",{parentName:"p"},"Nom")," et ",(0,r.kt)("strong",{parentName:"p"},"Nom d'affichage")," comme vous le souhaitez (ici c'est user1)."),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{alt:"userName",src:n(17830).Z,width:"436",height:"230"})),(0,r.kt)("p",{parentName:"li"},"S\xe9lectionnez ",(0,r.kt)("strong",{parentName:"p"},"NGINX Plus")," dans le ",(0,r.kt)("strong",{parentName:"p"},"Application d'inscription"),"."),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{alt:"signupApp",src:n(30614).Z,width:"432",height:"108"})),(0,r.kt)("p",{parentName:"li"},"Dans le champ ",(0,r.kt)("strong",{parentName:"p"},"Comptes g\xe9r\xe9s"),", s\xe9lectionnez ",(0,r.kt)("strong",{parentName:"p"},"NGINX Plus")," dans ",(0,r.kt)("strong",{parentName:"p"},"Application")," et remplissez le nom d'utilisateur et le mot de passe."),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{alt:"managedAcc",src:n(15943).Z,width:"1694",height:"238"}))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Retournez \xe0 la page ",(0,r.kt)("strong",{parentName:"p"},"R\xf4les")," et cliquez sur ",(0,r.kt)("strong",{parentName:"p"},"Modifier")," sur la ligne ",(0,r.kt)("strong",{parentName:"p"},"nginx-casdoor-role"),". Dans la page qui s'ouvre, dans le champ ",(0,r.kt)("strong",{parentName:"p"},"Sous-utilisateurs"),", s\xe9lectionnez le nom d'utilisateur que vous venez de cr\xe9er (ici c'est built-in/user1)."),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{alt:"subUsers",src:n(95856).Z,width:"528",height:"106"})))),(0,r.kt)("h2",{id:"configuration-de-nginx-plus"},"Configuration de NGINX Plus"),(0,r.kt)("p",null,"Pour configurer NGINX Plus en tant que partie de confiance OpenID Connect, suivez ces \xe9tapes :"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Commencez par cr\xe9er un clone du r\xe9pertoire GitHub ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/nginxinc/nginx-openid-connect"},"nginx-openid-connect")," :"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"git clone https://github.com/nginxinc/nginx-openid-connect\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Copiez les fichiers suivants du clone dans le r\xe9pertoire ",(0,r.kt)("strong",{parentName:"p"},"/etc/nginx/conf.d")," :"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"frontend.conf")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"openid_connect.js")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"openid_connect.server_conf")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"openid_connect_configuration.conf")))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"R\xe9cup\xe9rez les URL pour le point de terminaison d'autorisation, le point de terminaison de jeton et le fichier JSON Web Key (JWK) \xe0 partir de la configuration de Casdoor. Ouvrez un terminal et ex\xe9cutez la commande ",(0,r.kt)("inlineCode",{parentName:"p"},"curl")," suivante, en dirigeant la sortie vers la commande ",(0,r.kt)("inlineCode",{parentName:"p"},"python")," indiqu\xe9e pour g\xe9n\xe9rer un format de configuration lisible. Par souci de concision, nous avons tronqu\xe9 la sortie pour afficher uniquement les champs pertinents. ",(0,r.kt)("span",{id:"jump1"})),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"curl http://<casdoor-server-address>/.well-known/openid-configuration | python -m json.tool\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Ouvrez ",(0,r.kt)("strong",{parentName:"p"},"/etc/nginx/conf.d/openid_connect_configuration.conf"),' avec votre \xe9diteur de texte pr\xe9f\xe9r\xe9. Modifiez la valeur du param\xe8tre "default" pour chacune des directives ',(0,r.kt)("a",{parentName:"p",href:"https://nginx.org/en/docs/http/ngx_http_map_module.html#map"},"map")," suivantes avec les valeurs sp\xe9cifi\xe9es :",(0,r.kt)("span",{id:"jump2"})),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"map $host $oidc_authz_endpoint")," \u2013 Utilisez la valeur de ",(0,r.kt)("inlineCode",{parentName:"li"},"authorization_endpoint")," de ",(0,r.kt)("a",{parentName:"li",href:"#jump1"},"l'\xe9tape 3")," (dans ce guide, ",(0,r.kt)("inlineCode",{parentName:"li"},"https://<casdoor-server-address>/login/oauth/authorize"),")"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"map $host $oidc_token_endpoint")," \u2013 Utilisez la valeur de ",(0,r.kt)("inlineCode",{parentName:"li"},"token_endpoint")," de ",(0,r.kt)("a",{parentName:"li",href:"#jump1"},"l'\xe9tape 3")," (dans ce guide, ",(0,r.kt)("inlineCode",{parentName:"li"},"http://<casdoor-server-address>/api/login/oauth/access_token"),")"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"map $host $oidc_client")," \u2013 Utilisez la valeur dans le champ ",(0,r.kt)("strong",{parentName:"li"},"ID Client")," de ",(0,r.kt)("a",{parentName:"li",href:"#jump3"},"l'\xe9tape 4 de ",(0,r.kt)("em",{parentName:"a"},"Configuration de Casdoor"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"map $host $oidc_client_secret")," \u2013 Utilisez la valeur dans le champ ",(0,r.kt)("strong",{parentName:"li"},"Secret Client")," de ",(0,r.kt)("a",{parentName:"li",href:"#jump3"},"l'\xe9tape 2 de ",(0,r.kt)("em",{parentName:"a"},"Configuration de Casdoor"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"map $host $oidc_hmac_key")," \u2013 Utilisez une phrase unique, longue et s\xe9curis\xe9e"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Configurez le fichier JWK en fonction de la version de NGINX Plus utilis\xe9e :"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Dans NGINX Plus R17 et ult\xe9rieur, NGINX Plus peut lire directement le fichier JWK \xe0 partir de l'URL sp\xe9cifi\xe9e comme ",(0,r.kt)("inlineCode",{parentName:"li"},"jwks_uri")," dans ",(0,r.kt)("a",{parentName:"li",href:"#jump2"},"l'\xe9tape 3"),". Apportez les modifications suivantes \xe0 ",(0,r.kt)("strong",{parentName:"li"},"/etc/nginx/conf.d/frontend.conf")," :",(0,r.kt)("ol",{parentName:"li"},(0,r.kt)("li",{parentName:"ol"},"Commentez (ou supprimez) la directive ",(0,r.kt)("a",{parentName:"li",href:"http://nginx.org/en/docs/http/ngx_http_auth_jwt_module.html#auth_jwt_key_file"},"auth_jwt_key_file"),"."),(0,r.kt)("li",{parentName:"ol"},"D\xe9commentez la directive ",(0,r.kt)("a",{parentName:"li",href:"http://nginx.org/en/docs/http/ngx_http_auth_jwt_module.html#auth_jwt_key_request"},"auth_jwt_key_request"),". (Le param\xe8tre ",(0,r.kt)("inlineCode",{parentName:"li"},"/_jwks_uri")," fait r\xe9f\xe9rence \xe0 la valeur de la variable ",(0,r.kt)("inlineCode",{parentName:"li"},"$oidc_jwt_keyfile"),", qui sera d\xe9finie \xe0 l'\xe9tape suivante.)"),(0,r.kt)("li",{parentName:"ol"},'Mettez \xe0 jour le param\xe8tre "default" de la directive ',(0,r.kt)("inlineCode",{parentName:"li"},"map $host $oidc_jwt_keyfile")," avec la valeur obtenue du champ ",(0,r.kt)("inlineCode",{parentName:"li"},"jwks_uri")," dans ",(0,r.kt)("a",{parentName:"li",href:"#jump2"},"l'\xe9tape 3")," (dans ce guide, ",(0,r.kt)("inlineCode",{parentName:"li"},"http://<casdoor-server-address>/.well-known/jwks"),")."))),(0,r.kt)("li",{parentName:"ul"},"Dans NGINX Plus R16 et ant\xe9rieur, ou si pr\xe9f\xe9r\xe9, le fichier JWK doit \xeatre situ\xe9 sur le disque local. Suivez ces \xe9tapes :",(0,r.kt)("ol",{parentName:"li"},(0,r.kt)("li",{parentName:"ol"},"Copiez le contenu JSON du fichier JWK sp\xe9cifi\xe9 dans le champ ",(0,r.kt)("inlineCode",{parentName:"li"},"jwks_uri")," dans ",(0,r.kt)("a",{parentName:"li",href:"#jump2"},"l'\xe9tape 3")," (dans ce guide, ",(0,r.kt)("inlineCode",{parentName:"li"},"http://<casdoor-server-address>/.well-known/jwks"),") dans un fichier local (par exemple, ",(0,r.kt)("inlineCode",{parentName:"li"},"/etc/nginx/my_casdoor_jwk.json"),")."),(0,r.kt)("li",{parentName:"ol"},"Dans ",(0,r.kt)("strong",{parentName:"li"},"/etc/nginx/conf.d/openid_connect_configuration.conf"),', changez le param\xe8tre "default" de la directive ',(0,r.kt)("inlineCode",{parentName:"li"},"map $host $oidc_jwt_keyfile")," avec le chemin du fichier local."))))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Assurez-vous que l'utilisateur sp\xe9cifi\xe9 dans la directive ",(0,r.kt)("a",{parentName:"p",href:"http://nginx.org/en/docs/ngx_core_module.html#user"},"user")," dans le fichier de configuration de NGINX Plus (g\xe9n\xe9ralement ",(0,r.kt)("strong",{parentName:"p"},"/etc/nginx/nginx.conf"),") a les permissions de lecture pour le fichier JWK."))),(0,r.kt)("h2",{id:"tests"},"Tests"),(0,r.kt)("p",null,"Ouvrez un navigateur et entrez l'adresse de votre instance NGINX Plus. Ensuite, essayez de vous connecter en utilisant les identifiants d'un utilisateur qui a \xe9t\xe9 assign\xe9 au r\xf4le NGINX Plus."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"test",src:n(68185).Z,width:"734",height:"710"})),(0,r.kt)("h2",{id:"d\xe9pannage"},"D\xe9pannage"),(0,r.kt)("p",null,"Veuillez vous r\xe9f\xe9rer \xe0 la section ",(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("a",{parentName:"strong",href:"https://github.com/nginxinc/nginx-openid-connect#troubleshooting"},"D\xe9pannage"))," dans le r\xe9pertoire ",(0,r.kt)("strong",{parentName:"p"},"nginx-openid-connect")," sur GitHub."))}c.isMDXComponent=!0},87564:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/Client-a96b885b28b974e3594d8cc621e20d26.png"},38655:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/addApp-f0c3c3804e0f0c7c46099a967b140011.png"},80816:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/addRole-0472f1742fb90683f03e7754f6b443c9.png"},82431:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/appName-e76303a2d8f848e2cb82e8244580be67.png"},15943:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/managedAcc-2c79bf01d04970685e1db9e8800ab613.png"},4124:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/redirectURL-94f6fbadde9bd1dce2447f42ab5cd556.png"},88165:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/roleName-e4bb131db4aa1457aec6894f674c54c5.png"},30614:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/signupApp-f3444949e6ce9f7becbda49f59490a7f.png"},95856:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/subUsers-c5bcd4229c84f7b62e169783e8418a1a.png"},68185:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/test-61892faf0c0e4fbe4c43b277c0eab745.png"},17830:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/userName-0244eca3ebd618b68ad03ae9cda14dee.png"}}]);