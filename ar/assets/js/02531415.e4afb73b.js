"use strict";(self.webpackChunkcasdoor_website=self.webpackChunkcasdoor_website||[]).push([[8673],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>u});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),p=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},d=function(e){var t=p(e.components);return a.createElement(l.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),c=p(n),u=r,k=c["".concat(l,".").concat(u)]||c[u]||m[u]||i;return n?a.createElement(k,o(o({ref:t},d),{},{components:n})):a.createElement(k,o({ref:t},d))}));function u(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=c;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,o[1]=s;for(var p=2;p<i;p++)o[p]=n[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},10665:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>m,frontMatter:()=>i,metadata:()=>s,toc:()=>p});var a=n(87462),r=(n(67294),n(3905));const i={title:"\u0646\u0638\u0631\u0629 \u0639\u0627\u0645\u0629",description:"\u0627\u0633\u062a\u062e\u062f\u0627\u0645 Casdoor \u0643\u0645\u0632\u0648\u062f \u0647\u0648\u064a\u0629 SAML",keywords:["SAML","IdP"]},o=void 0,s={unversionedId:"how-to-connect/saml/overview",id:"how-to-connect/saml/overview",title:"\u0646\u0638\u0631\u0629 \u0639\u0627\u0645\u0629",description:"\u0627\u0633\u062a\u062e\u062f\u0627\u0645 Casdoor \u0643\u0645\u0632\u0648\u062f \u0647\u0648\u064a\u0629 SAML",source:"@site/i18n/ar/docusaurus-plugin-content-docs/current/how-to-connect/saml/overview.md",sourceDirName:"how-to-connect/saml",slug:"/how-to-connect/saml/overview",permalink:"/ar/docs/how-to-connect/saml/overview",draft:!1,editUrl:"https://github.com/casdoor/casdoor-website/edit/master/docs/how-to-connect/saml/overview.md",tags:[],version:"current",frontMatter:{title:"\u0646\u0638\u0631\u0629 \u0639\u0627\u0645\u0629",description:"\u0627\u0633\u062a\u062e\u062f\u0627\u0645 Casdoor \u0643\u0645\u0632\u0648\u062f \u0647\u0648\u064a\u0629 SAML",keywords:["SAML","IdP"]},sidebar:"tutorialSidebar",previous:{title:"SAML",permalink:"/ar/docs/category/saml"},next:{title:"\u0639\u0645\u064a\u0644 VPN \u0644\u0640 AWS",permalink:"/ar/docs/how-to-connect/saml/aws"}},l={},p=[{value:"\u0627\u0644\u062a\u0643\u0648\u064a\u0646 \u0641\u064a \u0645\u0632\u0648\u062f \u0627\u0644\u062e\u062f\u0645\u0629 SP",id:"\u0627\u0644\u062a\u0643\u0648\u064a\u0646-\u0641\u064a-\u0645\u0632\u0648\u062f-\u0627\u0644\u062e\u062f\u0645\u0629-sp",level:3},{value:"\u0627\u0644\u062a\u0643\u0648\u064a\u0646 \u0641\u064a \u0645\u0632\u0648\u062f \u0627\u0644\u0647\u0648\u064a\u0629 Casdoor IdP",id:"\u0627\u0644\u062a\u0643\u0648\u064a\u0646-\u0641\u064a-\u0645\u0632\u0648\u062f-\u0627\u0644\u0647\u0648\u064a\u0629-casdoor-idp",level:3},{value:"SAML attributes",id:"saml-attributes",level:3},{value:"Assertion signature control",id:"assertion-signature-control",level:3},{value:"\u0645\u0644\u0641 \u062a\u0639\u0631\u064a\u0641 \u0627\u0644\u0645\u0633\u062a\u062e\u062f\u0645",id:"\u0645\u0644\u0641-\u062a\u0639\u0631\u064a\u0641-\u0627\u0644\u0645\u0633\u062a\u062e\u062f\u0645",level:3},{value:"\u0645\u062b\u0627\u0644",id:"\u0645\u062b\u0627\u0644",level:3}],d={toc:p};function m(e){let{components:t,...i}=e;return(0,r.kt)("wrapper",(0,a.Z)({},d,i,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"\u064a\u0645\u0643\u0646 \u0627\u0644\u0622\u0646 \u0627\u0633\u062a\u062e\u062f\u0627\u0645 Casdoor \u0643\u0645\u0632\u0648\u062f \u0647\u0648\u064a\u0629 SAML IdP. \u062d\u062a\u0649 \u0647\u0630\u0647 \u0627\u0644\u0646\u0642\u0637\u0629\u060c \u062f\u0639\u0645 Casdoor \u0627\u0644\u0645\u064a\u0632\u0627\u062a \u0627\u0644\u0631\u0626\u064a\u0633\u064a\u0629 \u0644\u0640 SAML 2.0."),(0,r.kt)("h3",{id:"\u0627\u0644\u062a\u0643\u0648\u064a\u0646-\u0641\u064a-\u0645\u0632\u0648\u062f-\u0627\u0644\u062e\u062f\u0645\u0629-sp"},"\u0627\u0644\u062a\u0643\u0648\u064a\u0646 \u0641\u064a \u0645\u0632\u0648\u062f \u0627\u0644\u062e\u062f\u0645\u0629 SP"),(0,r.kt)("p",null,"\u0628\u0634\u0643\u0644 \u0639\u0627\u0645\u060c \u064a\u062a\u0637\u0644\u0628 \u0645\u0632\u0648\u062f \u0627\u0644\u062e\u062f\u0645\u0629 SP \u062b\u0644\u0627\u062b\u0629 \u062d\u0642\u0648\u0644 \u0645\u0637\u0644\u0648\u0628\u0629: ",(0,r.kt)("inlineCode",{parentName:"p"},"Single Sign-On"),"\u060c ",(0,r.kt)("inlineCode",{parentName:"p"},"Issuer"),"\u060c \u0648 ",(0,r.kt)("inlineCode",{parentName:"p"},"Public Certificate"),". \u064a\u0645\u0643\u0646 \u0644\u0645\u0639\u0638\u0645 \u0645\u0632\u0648\u062f\u064a \u0627\u0644\u062e\u062f\u0645\u0629 SP \u0627\u0644\u062d\u0635\u0648\u0644 \u0639\u0644\u0649 \u0647\u0630\u0647 \u0627\u0644\u062d\u0642\u0648\u0644 \u0639\u0646 \u0637\u0631\u064a\u0642 \u062a\u062d\u0645\u064a\u0644 \u0645\u0644\u0641 XML Metadata \u0623\u0648 URL \u0644\u0640 XML Metadata \u0644\u0644\u0625\u0643\u0645\u0627\u0644 \u0627\u0644\u062a\u0644\u0642\u0627\u0626\u064a."),(0,r.kt)("p",null,"\u0628\u064a\u0627\u0646\u0627\u062a metadata \u0644\u0646\u0642\u0637\u0629 \u0646\u0647\u0627\u064a\u0629 SAML \u0641\u064a Casdoor \u0647\u064a ",(0,r.kt)("inlineCode",{parentName:"p"},"<Endpoint of casdoor>/api/saml/metadata?application=admin/<application name>"),". \u0644\u0646\u0641\u062a\u0631\u0636 \u0623\u0646 \u0646\u0642\u0637\u0629 \u0646\u0647\u0627\u064a\u0629 Casdoor \u0647\u064a ",(0,r.kt)("inlineCode",{parentName:"p"},"https://door.casdoor.com"),"\u060c \u0648\u062a\u062d\u062a\u0648\u064a \u0639\u0644\u0649 \u062a\u0637\u0628\u064a\u0642 \u064a\u0633\u0645\u0649 ",(0,r.kt)("inlineCode",{parentName:"p"},"app-built-in"),". \u0646\u0642\u0637\u0629 \u0646\u0647\u0627\u064a\u0629 \u0628\u064a\u0627\u0646\u0627\u062a XML Metadata \u0633\u062a\u0643\u0648\u0646:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"https://door.casdoor.com/api/saml/metadata?application=admin/app-built-in\n")),(0,r.kt)("p",null,"\u064a\u0645\u0643\u0646\u0643 \u0623\u064a\u0636\u064b\u0627 \u0627\u0644\u0639\u062b\u0648\u0631 \u0639\u0644\u0649 \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a metadata \u0641\u064a \u0635\u0641\u062d\u0629 \u062a\u062d\u0631\u064a\u0631 \u0627\u0644\u062a\u0637\u0628\u064a\u0642. \u0627\u0646\u0642\u0631 \u0639\u0644\u0649 \u0627\u0644\u0632\u0631 \u0644\u0646\u0633\u062e \u0627\u0644\u0631\u0627\u0628\u0637 \u0648\u0627\u0644\u0635\u0642\u0647 \u0641\u064a \u0627\u0644\u0645\u062a\u0635\u0641\u062d \u0644\u062a\u0646\u0632\u064a\u0644 \u0645\u0644\u0641 XML Metadata."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"metadata",src:n(43587).Z,width:"1807",height:"505"})),(0,r.kt)("h3",{id:"\u0627\u0644\u062a\u0643\u0648\u064a\u0646-\u0641\u064a-\u0645\u0632\u0648\u062f-\u0627\u0644\u0647\u0648\u064a\u0629-casdoor-idp"},"\u0627\u0644\u062a\u0643\u0648\u064a\u0646 \u0641\u064a \u0645\u0632\u0648\u062f \u0627\u0644\u0647\u0648\u064a\u0629 Casdoor IdP"),(0,r.kt)("p",null,"Casdoor \u064a\u062f\u0639\u0645 \u0643\u0644\u0627\u064b \u0645\u0646 \u0637\u0644\u0628\u0627\u062a GET \u0648 POST ",(0,r.kt)("inlineCode",{parentName:"p"},"SAMLResponse"),". Casdoor \u064a\u062d\u062a\u0627\u062c \u0625\u0644\u0649 \u0645\u0639\u0631\u0641\u0629 \u0623\u0646\u0648\u0627\u0639 \u0627\u0644\u0637\u0644\u0628\u0627\u062a \u0627\u0644\u062a\u064a \u064a\u062f\u0639\u0645\u0647\u0627 \u0645\u0632\u0648\u062f \u0627\u0644\u062e\u062f\u0645\u0629 SP \u0639\u0646\u062f\u0645\u0627 \u064a\u0631\u0633\u0644 Casdoor \u0627\u0644\u0640 ",(0,r.kt)("inlineCode",{parentName:"p"},"SAMLResponse")," \u0625\u0644\u0649 \u0645\u0632\u0648\u062f \u0627\u0644\u062e\u062f\u0645\u0629 SP. \u062a\u062d\u062a\u0627\u062c \u0625\u0644\u0649 \u062a\u0643\u0648\u064a\u0646 \u0627\u0644\u062a\u0637\u0628\u064a\u0642 \u0641\u064a Casdoor \u0628\u0646\u0627\u0621\u064b \u0639\u0644\u0649 \u0646\u0648\u0639 ",(0,r.kt)("inlineCode",{parentName:"p"},"SAMLResponse")," \u0627\u0644\u0630\u064a \u064a\u062f\u0639\u0645\u0647 \u0645\u0632\u0648\u062f \u0627\u0644\u062e\u062f\u0645\u0629 SP \u0627\u0644\u062e\u0627\u0635 \u0628\u0643."),(0,r.kt)("p",null,"When integrating Casdoor as a SAML IdP with external identity providers (like Azure AD), the ",(0,r.kt)("inlineCode",{parentName:"p"},"/api/acs")," endpoint receives SAML responses. This endpoint is configured to accept cross-origin POST requests, allowing IdPs from different domains to send authentication data."),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"\u0625\u0630\u0627 \u0642\u0645\u062a \u0628\u0645\u0644\u0621 ",(0,r.kt)("inlineCode",{parentName:"p"},"Reply URL"),"\u060c \u0633\u064a\u0631\u0633\u0644 Casdoor \u0627\u0644\u0640 ",(0,r.kt)("inlineCode",{parentName:"p"},"SAMLResponse")," \u0628\u0648\u0627\u0633\u0637\u0629 \u0637\u0644\u0628 ",(0,r.kt)("strong",{parentName:"p"},"POST"),". \u0625\u0630\u0627 \u0643\u0627\u0646 \u0639\u0646\u0648\u0627\u0646 \u0627\u0644\u0631\u062f \u0641\u0627\u0631\u063a\u064b\u0627\u060c \u0633\u064a\u0633\u062a\u062e\u062f\u0645 Casdoor \u0637\u0644\u0628 ",(0,r.kt)("strong",{parentName:"p"},"GET"),". \u0642\u062f \u062a\u062a\u0633\u0627\u0621\u0644 \u0643\u064a\u0641 \u064a\u0639\u0631\u0641 Casdoor ",(0,r.kt)("inlineCode",{parentName:"p"},"Reply URL")," \u0644\u0645\u0632\u0648\u062f \u0627\u0644\u062e\u062f\u0645\u0629 SP \u0625\u0630\u0627 \u0643\u0627\u0646 ",(0,r.kt)("inlineCode",{parentName:"p"},"Reply URL")," \u0641\u0627\u0631\u063a\u064b\u0627. \u0641\u064a \u0627\u0644\u0648\u0627\u0642\u0639\u060c \u064a\u0645\u0643\u0646 \u0644\u0640 Casdoor \u0627\u0644\u062d\u0635\u0648\u0644 \u0639\u0644\u0649 \u0627\u0644\u0631\u0627\u0628\u0637 \u0627\u0644\u0645\u0633\u0645\u0649 ",(0,r.kt)("inlineCode",{parentName:"p"},"AssertionConsumerServiceURL")," \u0639\u0646 \u0637\u0631\u064a\u0642 \u062a\u062d\u0644\u064a\u0644 ",(0,r.kt)("inlineCode",{parentName:"p"},"SAMLRequest")," \u0648\u0625\u0631\u0633\u0627\u0644 \u0627\u0644\u0637\u0644\u0628 \u0645\u0639 ",(0,r.kt)("inlineCode",{parentName:"p"},"SAMLResponse")," \u0625\u0644\u0649 ",(0,r.kt)("inlineCode",{parentName:"p"},"AssertionConsumerServiceURL"),". \u0633\u064a\u062a\u0645 \u0627\u0644\u0643\u062a\u0627\u0628\u0629 \u0641\u0648\u0642 ",(0,r.kt)("inlineCode",{parentName:"p"},"Reply URL")," \u0644\u0640 ",(0,r.kt)("inlineCode",{parentName:"p"},"AssertionConsumerServiceURL")," \u0641\u064a ",(0,r.kt)("inlineCode",{parentName:"p"},"SAMLRequest"),".")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"\u0639\u0646\u0648\u0627\u0646 \u0627\u0644\u0631\u062f Reply URL"),": \u0627\u0643\u062a\u0628 \u0639\u0646\u0648\u0627\u0646 URL \u0644\u062e\u062f\u0645\u0629 ACS \u0627\u0644\u062a\u064a \u062a\u062a\u062d\u0642\u0642 \u0645\u0646 \u0627\u0633\u062a\u062c\u0627\u0628\u0629 SAML."),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{alt:"\u0639\u0646\u0648\u0627\u0646 \u0627\u0644\u0631\u062f",src:n(73524).Z,width:"727",height:"251"}))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"\u0639\u0646\u0648\u0627\u0646 \u0625\u0639\u0627\u062f\u0629 \u0627\u0644\u062a\u0648\u062c\u064a\u0647 Redirect URL"),": \u0627\u0643\u062a\u0628 \u0627\u0633\u0645\u064b\u0627 \u0641\u0631\u064a\u062f\u064b\u0627. \u0642\u062f \u064a\u064f\u0637\u0644\u0642 \u0639\u0644\u0649 \u0647\u0630\u0627 ",(0,r.kt)("inlineCode",{parentName:"p"},"Audience")," \u0623\u0648 ",(0,r.kt)("inlineCode",{parentName:"p"},"Entity ID")," \u0641\u064a \u0645\u0632\u0648\u062f \u0627\u0644\u062e\u062f\u0645\u0629 SP \u0627\u0644\u062e\u0627\u0635 \u0628\u0643. \u062a\u0623\u0643\u062f \u0645\u0646 \u0645\u0644\u0621 \u0646\u0641\u0633 ",(0,r.kt)("inlineCode",{parentName:"p"},"Redirect URL")," \u0647\u0646\u0627 \u0643\u0645\u0627 \u0641\u064a \u0645\u0632\u0648\u062f \u0627\u0644\u062e\u062f\u0645\u0629 SP \u0627\u0644\u062e\u0627\u0635 \u0628\u0643."),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{alt:"\u0645\u0639\u0631\u0641 \u0627\u0644\u0643\u064a\u0627\u0646 Entity ID",src:n(21605).Z,width:"743",height:"229"})))),(0,r.kt)("h3",{id:"saml-attributes"},"SAML attributes"),(0,r.kt)("p",null,"Some SP will require you to provide external attributes in SAML Response, you can add those in SAML attributes table. And you can insert user's field to it."),(0,r.kt)("p",null,"If your service provider only requires the NameID field and doesn't need additional user attributes (Email, Name, DisplayName, Roles), you can enable the ",(0,r.kt)("strong",{parentName:"p"},"Disable SAML attributes")," option in the application settings. When enabled, Casdoor will omit these attributes from the SAML response, which can help avoid XML namespace issues with certain SPs that have strict validation requirements."),(0,r.kt)("h3",{id:"assertion-signature-control"},"Assertion signature control"),(0,r.kt)("p",null,"SAML responses from Casdoor are always signed to ensure authenticity. However, some service providers may not support or require signed assertions within the response itself. Starting from version 2.81.0, Casdoor added assertion signatures following SAML 2.0 best practices, but this caused compatibility issues with certain SPs like Sentry."),(0,r.kt)("p",null,"When you encounter login failures with service providers that don't handle signed assertions properly, you can disable assertion signatures while keeping the overall response signature intact. Toggle the ",(0,r.kt)("strong",{parentName:"p"},"Enable SAML assertion signature")," option in your application settings to control this behavior. When disabled, Casdoor will sign only the SAML response envelope, which maintains security while ensuring compatibility with a wider range of service providers."),(0,r.kt)("p",null,"For example"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"center"},"\u0627\u0644\u0627\u0633\u0645"),(0,r.kt)("th",{parentName:"tr",align:"center"},"Name format"),(0,r.kt)("th",{parentName:"tr",align:"center"},"Value"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"center"},(0,r.kt)("inlineCode",{parentName:"td"},"https://www.aliyun.com/SAML-Role/Attributes/RoleSessionName")),(0,r.kt)("td",{parentName:"tr",align:"center"},"Unspecified"),(0,r.kt)("td",{parentName:"tr",align:"center"},(0,r.kt)("inlineCode",{parentName:"td"},"$user.name"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"center"},(0,r.kt)("inlineCode",{parentName:"td"},"https://www.aliyun.com/SAML-Role/Attributes/Role")),(0,r.kt)("td",{parentName:"tr",align:"center"},"Unspecified"),(0,r.kt)("td",{parentName:"tr",align:"center"},(0,r.kt)("inlineCode",{parentName:"td"},"acs:ram::1879818006829152:role/$user.roles,acs:ram::1879818006829152:saml-provider/testa"))))),(0,r.kt)("p",null,"will generate response with external ",(0,r.kt)("inlineCode",{parentName:"p"},"saml:Attribute")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<saml:Attribute Name="https://www.aliyun.com/SAML-Role/Attributes/RoleSessionName" NameFormat="urn:oasis:names:tc:SAML:2.0:attrname-format:unspecified">\n    <saml:AttributeValue xsi:type="xs:string">admi122n@outlook.com</saml:AttributeValue>\n</saml:Attribute>\n<saml:Attribute Name="https://www.aliyun.com/SAML-Role/Attributes/Role" NameFormat="urn:oasis:names:tc:SAML:2.0:attrname-format:unspecified">\n    <saml:AttributeValue xsi:type="xs:string"> acs:ram::1879818006829152:role/role1,acs:ram::1879818006829152:saml-provider/testa</saml:AttributeValue>\n    <saml:AttributeValue xsi:type="xs:string"> acs:ram::1879818006829152:role/role2,acs:ram::1879818006829152:saml-provider/testa</saml:AttributeValue>\n</saml:Attribute>\n')),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"We only support insert ",(0,r.kt)("inlineCode",{parentName:"p"},"$user.owner"),",",(0,r.kt)("inlineCode",{parentName:"p"},"$user.name"),",",(0,r.kt)("inlineCode",{parentName:"p"},"$user.email"),",",(0,r.kt)("inlineCode",{parentName:"p"},"$user.id"),",",(0,r.kt)("inlineCode",{parentName:"p"},"$user.phone"),",",(0,r.kt)("inlineCode",{parentName:"p"},"$user.roles"),",",(0,r.kt)("inlineCode",{parentName:"p"},"$user.permissions"),",",(0,r.kt)("inlineCode",{parentName:"p"},"$user.groups"))),(0,r.kt)("h3",{id:"\u0645\u0644\u0641-\u062a\u0639\u0631\u064a\u0641-\u0627\u0644\u0645\u0633\u062a\u062e\u062f\u0645"},"\u0645\u0644\u0641 \u062a\u0639\u0631\u064a\u0641 \u0627\u0644\u0645\u0633\u062a\u062e\u062f\u0645"),(0,r.kt)("p",null,"\u0628\u0639\u062f \u062a\u0633\u062c\u064a\u0644 \u0627\u0644\u062f\u062e\u0648\u0644 \u0628\u0646\u062c\u0627\u062d\u060c \u064a\u062d\u062a\u0648\u064a \u0645\u0644\u0641 \u062a\u0639\u0631\u064a\u0641 \u0627\u0644\u0645\u0633\u062a\u062e\u062f\u0645 \u0641\u064a \u0627\u0644\u0627\u0633\u062a\u062c\u0627\u0628\u0629 ",(0,r.kt)("inlineCode",{parentName:"p"},"SAMLResponse")," \u0627\u0644\u0639\u0627\u0626\u062f\u0629 \u0645\u0646 Casdoor \u0639\u0644\u0649 \u062b\u0644\u0627\u062b\u0629 \u062d\u0642\u0648\u0644. \u064a\u062a\u0645 \u062a\u0639\u064a\u064a\u0646 \u0627\u0644\u0633\u0645\u0627\u062a \u0641\u064a XML \u0648\u0633\u0645\u0627\u062a \u0627\u0644\u0645\u0633\u062a\u062e\u062f\u0645 \u0641\u064a Casdoor \u0639\u0644\u0649 \u0627\u0644\u0646\u062d\u0648 \u0627\u0644\u062a\u0627\u0644\u064a:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"center"},"\u0627\u0633\u0645 \u0627\u0644\u0633\u0645\u0629 XML"),(0,r.kt)("th",{parentName:"tr",align:"center"},"\u062d\u0642\u0644 \u0627\u0644\u0645\u0633\u062a\u062e\u062f\u0645"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"center"},"\u0627\u0644\u0628\u0631\u064a\u062f \u0627\u0644\u0625\u0644\u0643\u062a\u0631\u0648\u0646\u064a"),(0,r.kt)("td",{parentName:"tr",align:"center"},"email")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"center"},"\u0627\u0633\u0645 \u0627\u0644\u0639\u0631\u0636"),(0,r.kt)("td",{parentName:"tr",align:"center"},"displayName")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"center"},"Name"),(0,r.kt)("td",{parentName:"tr",align:"center"},"name")))),(0,r.kt)("p",null,"\u0631\u0627\u062c\u0639 ",(0,r.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/SAML_2.0"},"https://en.wikipedia.org/wiki/SAML_2.0")," \u0644\u0645\u0632\u064a\u062f \u0645\u0646 \u0627\u0644\u0645\u0639\u0644\u0648\u0645\u0627\u062a \u062d\u0648\u0644 SAML \u0648\u0625\u0635\u062f\u0627\u0631\u0627\u062a\u0647 \u0627\u0644\u0645\u062e\u062a\u0644\u0641\u0629."),(0,r.kt)("h3",{id:"\u0645\u062b\u0627\u0644"},"\u0645\u062b\u0627\u0644"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://github.com/russellhaering/gosaml2"},"gosaml2")," \u0647\u0648 \u062a\u0646\u0641\u064a\u0630 \u0644\u0640 SAML 2.0 \u0644\u0645\u0632\u0648\u062f\u064a \u0627\u0644\u062e\u062f\u0645\u0629 \u0645\u0628\u0646\u064a \u0639\u0644\u0649 etree \u0648 goxmldsig\u060c \u0648\u0647\u0648 \u062a\u0646\u0641\u064a\u0630 \u0628\u0644\u063a\u0629 Go \u0644\u0644\u062a\u0648\u0642\u064a\u0639\u0627\u062a \u0627\u0644\u0631\u0642\u0645\u064a\u0629 XML. \u0646\u062d\u0646 \u0646\u0633\u062a\u062e\u062f\u0645 \u0647\u0630\u0647 \u0627\u0644\u0645\u0643\u062a\u0628\u0629 \u0644\u0627\u062e\u062a\u0628\u0627\u0631 SAML 2.0 \u0641\u064a Casdoor \u0643\u0645\u0627 \u0647\u0648 \u0645\u0648\u0636\u062d \u0623\u062f\u0646\u0627\u0647."),(0,r.kt)("p",null,"\u0644\u0646\u0641\u062a\u0631\u0636 \u0623\u0646\u0647 \u064a\u0645\u0643\u0646\u0643 \u0627\u0644\u0648\u0635\u0648\u0644 \u0625\u0644\u0649 Casdoor \u0645\u0646 \u062e\u0644\u0627\u0644 ",(0,r.kt)("inlineCode",{parentName:"p"},"http://localhost:7001/"),"\u060c \u0648\u064a\u062d\u062a\u0648\u064a Casdoor \u0627\u0644\u062e\u0627\u0635 \u0628\u0643 \u0639\u0644\u0649 \u062a\u0637\u0628\u064a\u0642 \u064a\u0633\u0645\u0649 ",(0,r.kt)("inlineCode",{parentName:"p"},"app-built-in"),"\u060c \u0648\u0627\u0644\u0630\u064a \u064a\u0646\u062a\u0645\u064a \u0625\u0644\u0649 \u0645\u0646\u0638\u0645\u0629 \u062a\u0633\u0645\u0649 ",(0,r.kt)("inlineCode",{parentName:"p"},"built-in"),". \u064a\u062c\u0628 \u0625\u0636\u0627\u0641\u0629 \u0627\u0644\u0631\u0648\u0627\u0628\u0637\u060c ",(0,r.kt)("inlineCode",{parentName:"p"},"http://localhost:6900/acs/example")," \u0648 ",(0,r.kt)("inlineCode",{parentName:"p"},"http://localhost:6900/saml/acs/example"),"\u060c \u0625\u0644\u0649 \u0631\u0648\u0627\u0628\u0637 \u0625\u0639\u0627\u062f\u0629 \u0627\u0644\u062a\u0648\u062c\u064a\u0647 Redirect URLs \u0641\u064a ",(0,r.kt)("inlineCode",{parentName:"p"},"app-built-in"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-go"},'import (\n    "crypto/x509"\n    "fmt"\n    "net/http"\n\n    "io/ioutil"\n\n    "encoding/base64"\n    "encoding/xml"\n\n    saml2 "github.com/russellhaering/gosaml2"\n    "github.com/russellhaering/gosaml2/types"\n    dsig "github.com/russellhaering/goxmldsig"\n)\n\nfunc main() {\n    res, err := http.Get("http://localhost:7001/api/saml/metadata?application=admin/app-built-in")\n    if err != nil {\n        panic(err)\n    }\n\n    rawMetadata, err := ioutil.ReadAll(res.Body)\n    if err != nil {\n        panic(err)\n    }\n\n    metadata := &types.EntityDescriptor{}\n    err = xml.Unmarshal(rawMetadata, metadata)\n    if err != nil {\n        panic(err)\n    }\n\n    certStore := dsig.MemoryX509CertificateStore{\n        Roots: []*x509.Certificate{},\n    }\n\n    for _, kd := range metadata.IDPSSODescriptor.KeyDescriptors {\n        for idx, xcert := range kd.KeyInfo.X509Data.X509Certificates {\n            if xcert.Data == "" {\n                panic(fmt.Errorf("metadata certificate(%d) must not be empty", idx))\n            }\n            certData, err := base64.StdEncoding.DecodeString(xcert.Data)\n            if err != nil {\n                panic(err)\n            }\n\n            idpCert, err := x509.ParseCertificate(certData)\n            if err != nil {\n                panic(err)\n            }\n\n            certStore.Roots = append(certStore.Roots, idpCert)\n        }\n    }\n\n    randomKeyStore := dsig.RandomKeyStoreForTest()\n\n    sp := &saml2.SAMLServiceProvider{\n        IdentityProviderSSOURL:      metadata.IDPSSODescriptor.SingleSignOnServices[0].Location,\n        IdentityProviderIssuer:      metadata.EntityID,\n        ServiceProviderIssuer:       "http://localhost:6900/acs/example",\n        AssertionConsumerServiceURL: "http://localhost:6900/v1/_saml_callback",\n        SignAuthnRequests:           true,\n        AudienceURI:                 "http://localhost:6900/saml/acs/example",\n        IDPCertificateStore:         &certStore,\n        SPKeyStore:                  randomKeyStore,\n    }\n\n    http.HandleFunc("/v1/_saml_callback", func(rw http.ResponseWriter, req *http.Request) {\n        err := req.ParseForm()\n        if err != nil {\n            rw.WriteHeader(http.StatusBadRequest)\n            return\n        }\n        samlReponse := req.URL.Query().Get("SAMLResponse")\n        assertionInfo, err := sp.RetrieveAssertionInfo(samlReponse)\n        if err != nil {\n            fmt.Println(err)\n            rw.WriteHeader(http.StatusForbidden)\n            return\n        }\n        fmt.Println(assertionInfo)\n        if assertionInfo.WarningInfo.InvalidTime {\n            fmt.Println("here12:", assertionInfo.WarningInfo.InvalidTime)\n            rw.WriteHeader(http.StatusForbidden)\n            return\n        }\n\n        if assertionInfo.WarningInfo.NotInAudience {\n            fmt.Println(assertionInfo)\n            fmt.Println("here13:", assertionInfo.WarningInfo.NotInAudience)\n            rw.WriteHeader(http.StatusForbidden)\n            return\n        }\n\n        fmt.Fprintf(rw, "NameID: %s\\n", assertionInfo.NameID)\n\n        fmt.Fprintf(rw, "Assertions:\\n")\n\n        for key, val := range assertionInfo.Values {\n            fmt.Fprintf(rw, "  %s: %+v\\n", key, val)\n        }\n        fmt.Println(assertionInfo.Values.Get("FirstName"))\n        fmt.Fprintf(rw, "\\n")\n\n        fmt.Fprintf(rw, "Warnings:\\n")\n        fmt.Fprintf(rw, "%+v\\n", assertionInfo.WarningInfo)\n    })\n\n    println("Visit this URL To Authenticate:")\n    authURL, err := sp.BuildAuthURL("")\n    if err != nil {\n        panic(err)\n    }\n\n    println(authURL)\n\n    println("Supply:")\n    fmt.Printf("  SP ACS URL      : %s\\n", sp.AssertionConsumerServiceURL)\n\n    err = http.ListenAndServe(":6900", nil)\n    if err != nil {\n        panic(err)\n    }\n}\n')),(0,r.kt)("p",null,"\u0642\u0645 \u0628\u062a\u0634\u063a\u064a\u0644 \u0627\u0644\u0643\u0648\u062f \u0623\u0639\u0644\u0627\u0647\u060c \u0648\u0633\u064a\u0639\u0631\u0636 \u0627\u0644\u0648\u062d\u062f\u0629 \u0627\u0644\u0637\u0631\u0641\u064a\u0629 \u0627\u0644\u0631\u0633\u0627\u0644\u0629 \u0627\u0644\u062a\u0627\u0644\u064a\u0629."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"Visit this URL To Authenticate:\nhttp://localhost:7001/login/saml/authorize/admin/app-built-in?SAMLRequest=lFVbk6K8Fv0rFvNo2QR...\nSupply:\n  SP ACS URL      : http://localhost:6900/v1/_saml_callback\n")),(0,r.kt)("p",null,"\u0627\u0646\u0642\u0631 \u0639\u0644\u0649 \u0627\u0644\u0631\u0627\u0628\u0637 \u0644\u0644\u0645\u0635\u0627\u062f\u0642\u0629\u060c \u0648\u0633\u062a\u0638\u0647\u0631 \u0635\u0641\u062d\u0629 \u062a\u0633\u062c\u064a\u0644 \u0627\u0644\u062f\u062e\u0648\u0644 \u0625\u0644\u0649 Casdoor."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"\u062a\u0633\u062c\u064a\u0644 \u0627\u0644\u062f\u062e\u0648\u0644",src:n(80683).Z,width:"2560",height:"1462"})),(0,r.kt)("p",null,"\u0628\u0639\u062f \u0627\u0644\u0645\u0635\u0627\u062f\u0642\u0629\u060c \u0633\u062a\u062a\u0644\u0642\u0649 \u0631\u0633\u0627\u0626\u0644 \u0627\u0644\u0627\u0633\u062a\u062c\u0627\u0628\u0629 \u0643\u0645\u0627 \u0647\u0648 \u0645\u0648\u0636\u062d \u0623\u062f\u0646\u0627\u0647."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"\u0627\u0644\u0627\u0633\u062a\u062c\u0627\u0628\u0629",src:n(94139).Z,width:"2560",height:"375"})))}m.isMDXComponent=!0},21605:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/saml_entityId-02cf13e2debc60f1c7babe47bb443cbf.png"},80683:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/saml_login-bf1964a645b97ac59818a2d352a733aa.png"},43587:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/saml_metadata-0511209f4c6ccd88259d4438388eadae.png"},73524:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/saml_replyURL-54e1796b344daaab144af1999228412e.png"},94139:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/saml_response-b3ad831adea4c2d5b78f6ffa5e410ab6.png"}}]);