"use strict";(self.webpackChunkcasdoor_website=self.webpackChunkcasdoor_website||[]).push([[692],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>m});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=n.createContext({}),p=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},c=function(e){var t=p(e.components);return n.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),u=p(a),m=r,h=u["".concat(s,".").concat(m)]||u[m]||d[m]||i;return a?n.createElement(h,o(o({ref:t},c),{},{components:a})):n.createElement(h,o({ref:t},c))}));function m(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,o=new Array(i);o[0]=u;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:r,o[1]=l;for(var p=2;p<i;p++)o[p]=a[p];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}u.displayName="MDXCreateElement"},49836:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>d,frontMatter:()=>i,metadata:()=>l,toc:()=>p});var n=a(87462),r=(a(67294),a(3905));const i={title:"\u6570\u636e\u5e93",description:"\u4f7f\u7528 Databse \u540c\u6b65\u5668\u540c\u6b65\u6570\u636e\u5e93",keywords:["\u540c\u6b65\u5668","\u6570\u636e\u5e93"],authors:["Marvelousp4"]},o=void 0,l={unversionedId:"syncer/Database",id:"syncer/Database",title:"\u6570\u636e\u5e93",description:"\u4f7f\u7528 Databse \u540c\u6b65\u5668\u540c\u6b65\u6570\u636e\u5e93",source:"@site/i18n/zh/docusaurus-plugin-content-docs/current/syncer/Database.md",sourceDirName:"syncer",slug:"/syncer/Database",permalink:"/zh/docs/syncer/Database",draft:!1,editUrl:"https://crowdin.com/project/casdoor-website/zh-CN",tags:[],version:"current",frontMatter:{title:"\u6570\u636e\u5e93",description:"\u4f7f\u7528 Databse \u540c\u6b65\u5668\u540c\u6b65\u6570\u636e\u5e93",keywords:["\u540c\u6b65\u5668","\u6570\u636e\u5e93"],authors:["Marvelousp4"]},sidebar:"tutorialSidebar",previous:{title:"\u6982\u8ff0",permalink:"/zh/docs/syncer/overview"},next:{title:"Keycloak",permalink:"/zh/docs/syncer/Keycloak"}},s={},p=[{value:"\u6570\u636e\u5e93\u540c\u6b65\u5668",id:"\u6570\u636e\u5e93\u540c\u6b65\u5668",level:2}],c={toc:p};function d(e){let{components:t,...i}=e;return(0,r.kt)("wrapper",(0,n.Z)({},c,i,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"\u6570\u636e\u5e93\u540c\u6b65\u5668"},"\u6570\u636e\u5e93\u540c\u6b65\u5668"),(0,r.kt)("p",null,"\u6211\u4eec\u4f5c\u4e3a\u6f14\u793a\u521b\u5efa\u7684\u7528\u6237\u8868\u4ece ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/casdoor/casdoor/blob/master/xlsx/user_test.xlsx"},"\u6a21\u677f XLSX \u6587\u4ef6")," \u5bfc\u5165\u3002"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"\u8868\u683c",src:a(95899).Z,width:"2244",height:"241"})),(0,r.kt)("p",null,"\u70b9\u51fb ",(0,r.kt)("strong",{parentName:"p"},"Syncers")," \u6807\u7b7e\u9875\u5e76\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u540c\u6b65\u5668\u3002 \u586b\u5199\u4e0b\u9762\u6240\u9700\u7684\u6240\u6709\u4fe1\u606f\u5e76\u4fdd\u5b58\u3002"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"\u7f16\u8f91",src:a(2739).Z,width:"1758",height:"872"})),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"\u4e00\u822c\u800c\u8a00\uff0c\u60a8\u81f3\u5c11\u9700\u8981\u586b\u5199Casdoor\u5217\u4e2d\u7684 ",(0,r.kt)("inlineCode",{parentName:"p"},"ID")," \u548c ",(0,r.kt)("inlineCode",{parentName:"p"},"Name")," \u4ee5\u53ca\u5176\u4ed6\u91cd\u8981\u4fe1\u606f\uff0c\u5982 ",(0,r.kt)("inlineCode",{parentName:"p"},"createdTime"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"Password"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"DisplayName"),".")),(0,r.kt)("p",null,"\u4ee5\u4e0b\u662f\u5fc5\u586b\u5b57\u6bb5\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Organization"),": The organization that the user will import"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Name"),": \u540c\u6b65\u5668\u540d\u79f0"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Type"),": \u9009\u62e9\u6570\u636e\u5e93"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Host"),": \u539f\u59cb\u6570\u636e\u5e93\u4e3b\u673a\u5730\u5740"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Port"),": \u539f\u59cb\u6570\u636e\u5e93\u7aef\u53e3"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"User"),": \u539f\u59cb\u6570\u636e\u5e93\u7528\u6237\u540d"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Password"),": \u539f\u59cb\u6570\u636e\u5e93\u5bc6\u7801"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Database type"),": \u6240\u6709 Xorm \u652f\u6301\u7684\u6570\u636e\u5e93\uff0c\u4f8b\u5982: MySQL, PostgreSQL, SQL Server, Oracle, Sqlite"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Database"),": \u539f\u59cb\u6570\u636e\u5e93\u540d\u79f0"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Table"),": The original user table name"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"\u8868\u683c\u5217")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Column name"),": The original user column name"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Column type"),": The original user column type"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Casdoor Column"),": The casdoor user column name")),(0,r.kt)("p",null,"\u53ef\u9009\u9879"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Is hashed"),': \u662f\u5426\u8ba1\u7b97\u54c8\u5e0c\u503c. When enable "',(0,r.kt)("strong",{parentName:"li"},"Is hashed"),'", if the field of user in origin table updated, the syncer will sync this user. Disable "Is hashed", meaning if only the field update, the syncer need not sync the user. In short, the user does not synchronize until the fields involved in the hash calculation(enable "Is hashed") are updated.'),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Is key"),": Whether it is the ",(0,r.kt)("strong",{parentName:"li"},"primary key"),' of the user in origin table and the user in casdoor table. When synchronizing the database, it is judged based on the field whose "Is key" is selected, so at least one of  "Is key" button of field is selected. If not selected, the first "Is key" is selected by default.'),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Avatar base URL"),": When sync users, if ",(0,r.kt)("strong",{parentName:"li"},"Avatar base URL")," is not empty and origin ",(0,r.kt)("strong",{parentName:"li"},"user.avatar"),' not hasPrefix "http", new ',(0,r.kt)("strong",{parentName:"li"},"user.avatar")," will be replaced by ",(0,r.kt)("strong",{parentName:"li"},"Avatar base URL + user.avatar"),"."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Affiliation table"),': It is used to sync the affiliation of user from this table in database. Because the affiliation may be code of int type in "Affiliation table", so we need to map the int to a string. See ',(0,r.kt)("a",{parentName:"li",href:"https://github.com/casdoor/casdoor/blob/9f3ee275a8b747f914f0e74e897a79abeff96ccb/object/syncer_affiliation.go#L32"},"getAffiliationMap()")," . Because Casdoor has some redundant fields to borrow, ",(0,r.kt)("a",{parentName:"li",href:"https://github.com/casdoor/casdoor/blob/9f3ee275a8b747f914f0e74e897a79abeff96ccb/object/syncer_util.go#L65"},"here")," we use ",(0,r.kt)("inlineCode",{parentName:"li"},"score")," to map the int code to a string name.")),(0,r.kt)("p",null,"\u7136\u540e\u60a8\u53ef\u4ee5\u6253\u5f00 ",(0,r.kt)("strong",{parentName:"p"},"\u542f\u7528")," \u6309\u94ae\u5e76\u4fdd\u5b58\uff0c\u540c\u6b65\u5668\u5c06\u5f00\u59cb\u5de5\u4f5c\u3002"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"\u7528\u6237",src:a(55155).Z,width:"1784",height:"163"})),(0,r.kt)("p",null,'You can also select the "Sync" button for database synchronization.'),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Update")),(0,r.kt)("p",null,"When the ",(0,r.kt)("inlineCode",{parentName:"p"},"Table columns")," is set to the following figure, the update operation is performed."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"table_columns",src:a(43292).Z,width:"1755",height:"273"})),(0,r.kt)("p",null,"When the data of the two table to the key is different, we can synchronize the data between the two table by the primary key."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"update user in origin table")),(0,r.kt)("video",{src:"/video/syncer/update_user.mp4",controls:"controls",width:"100%"}),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"update user in casdoor table")),(0,r.kt)("video",{src:"/video/syncer/update_casdoor.mp4",controls:"controls",width:"100%"}),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Add")),(0,r.kt)("p",null,"When the ",(0,r.kt)("inlineCode",{parentName:"p"},"Table columns")," is set to the following figure, the add operation is performed."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"table_columns",src:a(43292).Z,width:"1755",height:"273"})),(0,r.kt)("p",null,"If the number of data between the two table is different, add the data to the table with the lower number of data by the primary key."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"add user in origin table")),(0,r.kt)("video",{src:"/video/syncer/add_user.mp4",controls:"controls",width:"100%"}),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"add user in casdoor table")),(0,r.kt)("video",{src:"/video/syncer/add_casdoor.mp4",controls:"controls",width:"100%"}))}d.isMDXComponent=!0},2739:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/syncer_database_edit-435b2fa3ce01e17c2b551c6729303c24.png"},95899:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/syncer_database_table-b7ed36d236791d6de4e3a0e5b7c5e75e.png"},55155:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/syncer_database_users-ac0f4230b3b21198217baa1ebf02ea7f.png"},43292:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/syner_database_table_columns-6251bc6562ba8ab0e90d2e9e823d52f8.png"}}]);