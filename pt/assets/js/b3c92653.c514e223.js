"use strict";(self.webpackChunkcasdoor_website=self.webpackChunkcasdoor_website||[]).push([[1345],{3905:(e,o,t)=>{t.d(o,{Zo:()=>d,kt:()=>u});var a=t(67294);function n(e,o,t){return o in e?Object.defineProperty(e,o,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[o]=t,e}function r(e,o){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);o&&(a=a.filter((function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable}))),t.push.apply(t,a)}return t}function i(e){for(var o=1;o<arguments.length;o++){var t=null!=arguments[o]?arguments[o]:{};o%2?r(Object(t),!0).forEach((function(o){n(e,o,t[o])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(t,o))}))}return e}function p(e,o){if(null==e)return{};var t,a,n=function(e,o){if(null==e)return{};var t,a,n={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],o.indexOf(t)>=0||(n[t]=e[t]);return n}(e,o);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],o.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(n[t]=e[t])}return n}var c=a.createContext({}),l=function(e){var o=a.useContext(c),t=o;return e&&(t="function"==typeof e?e(o):i(i({},o),e)),t},d=function(e){var o=l(e.components);return a.createElement(c.Provider,{value:o},e.children)},s={inlineCode:"code",wrapper:function(e){var o=e.children;return a.createElement(a.Fragment,{},o)}},m=a.forwardRef((function(e,o){var t=e.components,n=e.mdxType,r=e.originalType,c=e.parentName,d=p(e,["components","mdxType","originalType","parentName"]),m=l(t),u=n,f=m["".concat(c,".").concat(u)]||m[u]||s[u]||r;return t?a.createElement(f,i(i({ref:o},d),{},{components:t})):a.createElement(f,i({ref:o},d))}));function u(e,o){var t=arguments,n=o&&o.mdxType;if("string"==typeof e||n){var r=t.length,i=new Array(r);i[0]=m;var p={};for(var c in o)hasOwnProperty.call(o,c)&&(p[c]=o[c]);p.originalType=e,p.mdxType="string"==typeof e?e:n,i[1]=p;for(var l=2;l<r;l++)i[l]=t[l];return a.createElement.apply(null,i)}return a.createElement.apply(null,t)}m.displayName="MDXCreateElement"},82091:(e,o,t)=>{t.r(o),t.d(o,{assets:()=>c,contentTitle:()=>i,default:()=>s,frontMatter:()=>r,metadata:()=>p,toc:()=>l});var a=t(87462),n=(t(67294),t(3905));const r={title:"Zentao",description:"Usando Casdoor para autentica\xe7\xe3o no Zentao",keywords:["Zentao","zentao-oidc"],authors:["leo220yuyaodog"]},i=void 0,p={unversionedId:"integration/php/zentao",id:"integration/php/zentao",title:"Zentao",description:"Usando Casdoor para autentica\xe7\xe3o no Zentao",source:"@site/i18n/pt/docusaurus-plugin-content-docs/current/integration/php/zentao.md",sourceDirName:"integration/php",slug:"/integration/php/zentao",permalink:"/pt/docs/integration/php/zentao",draft:!1,editUrl:"https://github.com/casdoor/casdoor-website/edit/master/docs/integration/php/zentao.md",tags:[],version:"current",frontMatter:{title:"Zentao",description:"Usando Casdoor para autentica\xe7\xe3o no Zentao",keywords:["Zentao","zentao-oidc"],authors:["leo220yuyaodog"]},sidebar:"tutorialSidebar",previous:{title:"PHP",permalink:"/pt/docs/category/php"},next:{title:"Usando Casdoor como um Servidor OAuth2 no ShowDoc",permalink:"/pt/docs/integration/php/showdoc"}},c={},l=[{value:"Etapa 1: Implementar Casdoor e Zentao",id:"etapa-1-implementar-casdoor-e-zentao",level:2},{value:"Etapa 2: Integrar o m\xf3dulo OIDC de terceiros do Zentao",id:"etapa-2-integrar-o-m\xf3dulo-oidc-de-terceiros-do-zentao",level:2},{value:"Etapa 3: Configurar Aplicativo Casdoor",id:"etapa-3-configurar-aplicativo-casdoor",level:2},{value:"Etapa 4: Configurar Zentao",id:"etapa-4-configurar-zentao",level:2}],d={toc:l};function s(e){let{components:o,...r}=e;return(0,n.kt)("wrapper",(0,a.Z)({},d,r,{components:o,mdxType:"MDXLayout"}),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://www.zentao.pm/"},"Zentao")," \xe9 um sistema/ferramenta de gerenciamento de projetos \xe1gil (scrum), mas n\xe3o suporta OIDC por si s\xf3. Para integrar o Zentao com o SSO do Casdoor, precisamos usar um m\xf3dulo OIDC de terceiros chamado ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/casdoor/zentao-oidc"},"zentao-oidc"),", e este documento mostrar\xe1 como fazer isso."),(0,n.kt)("h2",{id:"etapa-1-implementar-casdoor-e-zentao"},"Etapa 1: Implementar Casdoor e Zentao"),(0,n.kt)("p",null,"Primeiramente, implemente ",(0,n.kt)("a",{parentName:"p",href:"/docs/basic/server-installation"},"Casdoor")," e ",(0,n.kt)("a",{parentName:"p",href:"https://www.zentao.pm/download/zentao-community-edition-release-164-1100.html"},"Zentao"),". Ap\xf3s uma implementa\xe7\xe3o bem-sucedida, certifique-se de:"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"Casdoor pode ser acessado e usado com sucesso."),(0,n.kt)("li",{parentName:"ol"},"Voc\xea pode acessar e usar o Zentao com sucesso.")),(0,n.kt)("h2",{id:"etapa-2-integrar-o-m\xf3dulo-oidc-de-terceiros-do-zentao"},"Etapa 2: Integrar o m\xf3dulo OIDC de terceiros do Zentao"),(0,n.kt)("p",null,"Instale ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/casdoor/zentao-oidc"},"zentao-oidc")," executando o seguinte comando:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-java"},"git clone https://github.com/casdoor/zentao-oidc.git\n")),(0,n.kt)("p",null,"Alternativamente, voc\xea pode baixar o ZIP e descompact\xe1-lo."),(0,n.kt)("p",null,"Este m\xf3dulo \xe9 usado para integrar o Zentao com SSO para OpenId. Eis como us\xe1-lo:"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Copie o diret\xf3rio inteiro ",(0,n.kt)("inlineCode",{parentName:"p"},"oidc")," para o m\xf3dulo do Zentao e use-o como um m\xf3dulo do Zentao. Renomeie o pacote baixado para 'oidc'.")),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Configure o filtro."),(0,n.kt)("p",{parentName:"li"},"Como o framework do Zentao filtra os par\xe2metros na URL e n\xe3o permite espa\xe7os, voc\xea precisa colocar o seguinte c\xf3digo no final de ",(0,n.kt)("inlineCode",{parentName:"p"},"/config/my.php"),"."),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-php"},"$filter->oidc = new stdclass();\n$filter->oidc->index = new stdclass();\n$filter->oidc->index->paramValue['scope'] = 'reg::any';\n"))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Modifique ",(0,n.kt)("inlineCode",{parentName:"p"},"/module/commom/model.php"),"."),(0,n.kt)("p",{parentName:"li"},"Adicione 'oidc' \xe0 lista de acesso an\xf4nimo e adicione uma linha ao m\xe9todo ",(0,n.kt)("inlineCode",{parentName:"p"},"isOpenMethod")," de ",(0,n.kt)("inlineCode",{parentName:"p"},"model.php"),"."),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-php"},"public function isOpenMethod($module, $method)\n{          \n    if ($module == 'oidc' and $method == 'index') {\n        return true; \n    }\n}\n"))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Se voc\xea n\xe3o quer que a tela de login do Zentao apare\xe7a, v\xe1 diretamente para a tela de login do Casdoor."),(0,n.kt)("p",{parentName:"li"},"Modifique a \xfaltima linha de c\xf3digo em ",(0,n.kt)("inlineCode",{parentName:"p"},"public function checkPriv()")," em ",(0,n.kt)("inlineCode",{parentName:"p"},"/module/common/model.php"),"."),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-php"},"//return print(js::locate(helper::createLink('user', 'login', \"referer=$referer\")));\nreturn print(js::locate(helper::createLink('oidc', 'index', \"referer=$referer\")));\n"))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Modifique o m\xe9todo ",(0,n.kt)("inlineCode",{parentName:"p"},"setSuperVars()")," dentro de ",(0,n.kt)("inlineCode",{parentName:"p"},"framework/base/router.class.php")," e comente as seguintes declara\xe7\xf5es."),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-php"},"public function setSuperVars()\n//  unset($_REQUEST);\n")))),(0,n.kt)("h2",{id:"etapa-3-configurar-aplicativo-casdoor"},"Etapa 3: Configurar Aplicativo Casdoor"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"Crie um novo aplicativo Casdoor ou use um existente."),(0,n.kt)("li",{parentName:"ol"},"Adicione sua URL de redirecionamento.",(0,n.kt)("img",{alt:"Configura\xe7\xe3o do Aplicativo Casdoor",src:t(9798).Z,width:"793",height:"360"})),(0,n.kt)("li",{parentName:"ol"},"Adicione o provedor que voc\xea deseja e preencha outras configura\xe7\xf5es necess\xe1rias.")),(0,n.kt)("h2",{id:"etapa-4-configurar-zentao"},"Etapa 4: Configurar Zentao"),(0,n.kt)("p",null,"Configure o arquivo ",(0,n.kt)("inlineCode",{parentName:"p"},"config.php")," no diret\xf3rio ",(0,n.kt)("inlineCode",{parentName:"p"},"oidc"),"."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-php"},'$config->oidc->clientId = "<Your ClientId>";\n$config->oidc->clientSecret = "<Your ClientSecret>";\n$config->oidc->issuer = "http://localhost:8000";\n')),(0,n.kt)("p",null,"Defina sua URL de redirecionamento em ",(0,n.kt)("inlineCode",{parentName:"p"},"module/oidc")," no m\xe9todo ",(0,n.kt)("inlineCode",{parentName:"p"},"public function index()"),"."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-php"},'$oidc->setRedirectURL($path."/zentao/oidc-index.html");\n')),(0,n.kt)("admonition",{type:"note"},(0,n.kt)("p",{parentName:"admonition"},"A URL aqui se refere a chamar o m\xe9todo 'index' no m\xf3dulo 'oidc'. Voc\xea tamb\xe9m precisa definir um separador de vari\xe1veis. Por padr\xe3o, o framework usa um tra\xe7o ('-'). Por favor, consulte o framework oficial do Zentao para mais detalhes. ",(0,n.kt)("a",{parentName:"p",href:"https://devel.easycorp.cn/book/zentaophphelp/about-10.html"},'"zentaoPHP\u6846\u67b6"'))))}s.isMDXComponent=!0},9798:(e,o,t)=>{t.d(o,{Z:()=>a});const a=t.p+"assets/images/clientId-563efc95f2798062bde65091a87cc546.png"}}]);