"use strict";(self.webpackChunkcasdoor_website=self.webpackChunkcasdoor_website||[]).push([[7215],{3905:(e,t,o)=>{o.d(t,{Zo:()=>u,kt:()=>m});var r=o(67294);function n(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function a(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,r)}return o}function i(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?a(Object(o),!0).forEach((function(t){n(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):a(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function s(e,t){if(null==e)return{};var o,r,n=function(e,t){if(null==e)return{};var o,r,n={},a=Object.keys(e);for(r=0;r<a.length;r++)o=a[r],t.indexOf(o)>=0||(n[o]=e[o]);return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)o=a[r],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}var p=r.createContext({}),l=function(e){var t=r.useContext(p),o=t;return e&&(o="function"==typeof e?e(t):i(i({},t),e)),o},u=function(e){var t=l(e.components);return r.createElement(p.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var o=e.components,n=e.mdxType,a=e.originalType,p=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),d=l(o),m=n,h=d["".concat(p,".").concat(m)]||d[m]||c[m]||a;return o?r.createElement(h,i(i({ref:t},u),{},{components:o})):r.createElement(h,i({ref:t},u))}));function m(e,t){var o=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var a=o.length,i=new Array(a);i[0]=d;var s={};for(var p in t)hasOwnProperty.call(t,p)&&(s[p]=t[p]);s.originalType=e,s.mdxType="string"==typeof e?e:n,i[1]=s;for(var l=2;l<a;l++)i[l]=o[l];return r.createElement.apply(null,i)}return r.createElement.apply(null,o)}d.displayName="MDXCreateElement"},56082:(e,t,o)=>{o.r(t),o.d(t,{assets:()=>p,contentTitle:()=>i,default:()=>c,frontMatter:()=>a,metadata:()=>s,toc:()=>l});var r=o(87462),n=(o(67294),o(3905));const a={title:"Custom OAuth",description:"Add your custom OAuth provider to Casdoor",keywords:["Custom Provider","OAuth","Casdoor"],authors:["halozhy"]},i=void 0,s={unversionedId:"provider/oauth/CustomProvider",id:"provider/oauth/CustomProvider",title:"Custom OAuth",description:"Add your custom OAuth provider to Casdoor",source:"@site/docs/provider/oauth/CustomProvider.md",sourceDirName:"provider/oauth",slug:"/provider/oauth/CustomProvider",permalink:"/docs/provider/oauth/CustomProvider",draft:!1,editUrl:"https://github.com/casdoor/casdoor-website/edit/master/docs/provider/oauth/CustomProvider.md",tags:[],version:"current",frontMatter:{title:"Custom OAuth",description:"Add your custom OAuth provider to Casdoor",keywords:["Custom Provider","OAuth","Casdoor"],authors:["halozhy"]},sidebar:"tutorialSidebar",previous:{title:"Azure AD B2C",permalink:"/docs/provider/oauth/azureADb2c"},next:{title:"Okta",permalink:"/docs/provider/oauth/okta"}},p={},l=[{value:"Overview",id:"overview",level:2},{value:"Multiple Custom Providers Support",id:"multiple-custom-providers-support",level:2},{value:"Creating a Custom Provider",id:"creating-a-custom-provider",level:2}],u={toc:l};function c(e){let{components:t,...a}=e;return(0,n.kt)("wrapper",(0,r.Z)({},u,a,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("admonition",{type:"note"},(0,n.kt)("p",{parentName:"admonition"},"Casdoor supports custom providers. However, the custom providers must follow the standard process of 3-legged OAuth, and the return values of ",(0,n.kt)("inlineCode",{parentName:"p"},"Token URL")," and ",(0,n.kt)("inlineCode",{parentName:"p"},"UserInfo URL")," must conform to the format specified by Casdoor.")),(0,n.kt)("h2",{id:"overview"},"Overview"),(0,n.kt)("p",null,"Custom OAuth providers allow you to integrate any OAuth 2.0 compliant authentication service with Casdoor, even if it's not officially supported. This is useful when you want to integrate with:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Internal enterprise OAuth servers"),(0,n.kt)("li",{parentName:"ul"},"Self-hosted authentication systems"),(0,n.kt)("li",{parentName:"ul"},"Third-party services not yet officially supported by Casdoor")),(0,n.kt)("h2",{id:"multiple-custom-providers-support"},"Multiple Custom Providers Support"),(0,n.kt)("p",null,"Casdoor supports up to ",(0,n.kt)("strong",{parentName:"p"},"10 different custom OAuth providers")," simultaneously. When creating custom providers, you can choose from the following types:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"Custom")," - The first custom provider"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"Custom2")," through ",(0,n.kt)("strong",{parentName:"li"},"Custom10")," - Additional custom providers")),(0,n.kt)("p",null,"This allows you to integrate multiple custom OAuth services without conflicts. Each custom provider maintains its own separate configuration and user data fields."),(0,n.kt)("h2",{id:"creating-a-custom-provider"},"Creating a Custom Provider"),(0,n.kt)("p",null,'To create a new custom provider, navigate to the provider page of Casdoor, and select one of the custom types ("Custom", "Custom2", "Custom3", etc.) in the Type field. You will then need to fill in ',(0,n.kt)("inlineCode",{parentName:"p"},"Client ID"),", ",(0,n.kt)("inlineCode",{parentName:"p"},"Client Secret"),", ",(0,n.kt)("inlineCode",{parentName:"p"},"Auth URL"),", ",(0,n.kt)("inlineCode",{parentName:"p"},"Scope"),",",(0,n.kt)("inlineCode",{parentName:"p"},"Token URL"),", ",(0,n.kt)("inlineCode",{parentName:"p"},"UserInfo URL"),", and ",(0,n.kt)("inlineCode",{parentName:"p"},"Favicon"),"."),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"image-20220418100744005",src:o(38744).Z,width:"685",height:"676"})),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("inlineCode",{parentName:"p"},"Auth URL")," is the custom provider's OAuth login page address."),(0,n.kt)("p",{parentName:"li"},"If you fill in ",(0,n.kt)("inlineCode",{parentName:"p"},"https://door.casdoor.com/login/oauth/authorize")," as the ",(0,n.kt)("inlineCode",{parentName:"p"},"Auth URL"),", then, when a user logs in with this custom provider, the browser will first redirect to"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-url"},"https://door.casdoor.com/login/oauth/authorize?client_id={ClientID}&redirect_uri=https://{your-casdoor-hostname}/callback&state={State_generated_by_Casdoor}&response_type=code&scope={Scope}` \n")),(0,n.kt)("p",{parentName:"li"},"After authorization is completed, the custom provider should redirect to"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-url"},"https://{your-casdoor-hostname}/callback?code={code}\n")),(0,n.kt)("p",{parentName:"li"},"After this step, Casdoor will recognize the code parameter in the URL.")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("inlineCode",{parentName:"p"},"Scope")," is the scope parameter carried when accessing the ",(0,n.kt)("inlineCode",{parentName:"p"},"Auth URL"),", and you should fill it in as per the custom provider's requirements.")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("inlineCode",{parentName:"p"},"Token URL")," is the API endpoint for obtaining the accessToken."),(0,n.kt)("p",{parentName:"li"},"Once you obtain the code in the previous step, Casdoor should use it to get the accessToken."),(0,n.kt)("p",{parentName:"li"},"If you fill in ",(0,n.kt)("inlineCode",{parentName:"p"},"https://door.casdoor.com/api/login/oauth/access_token")," as the ",(0,n.kt)("inlineCode",{parentName:"p"},"Token URL"),", then Casdoor will access it using the following command"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-bash"},'curl -X POST -u "{ClientID}:{ClientSecret}" --data-binary "code={code}&grant_type=authorization_code&redirect_uri=https://{your-casdoor-hostname}/callback" https://door.casdoor.com/api/login/oauth/access_token\n')),(0,n.kt)("p",{parentName:"li"},"The custom provider should return at least the following information:"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "access_token": "eyJhbGciOiJSUzI1NiIsImtpZCI6Ixxxxxxxxxxxxxx",\n  "refresh_token": "eyJhbGciOiJSUzI1NiIsInR5cCI6xxxxxxxxxxxxxx",\n  "token_type": "Bearer",\n  "expires_in": 10080,\n  "scope": "openid profile email"\n}\n'))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("inlineCode",{parentName:"p"},"UserInfo URL")," is the API endpoint for obtaining user information via the accessToken."),(0,n.kt)("p",{parentName:"li"},"If you fill in ",(0,n.kt)("inlineCode",{parentName:"p"},"https://door.casdoor.com/api/userinfo")," as the ",(0,n.kt)("inlineCode",{parentName:"p"},"UserInfo URL"),", then Casdoor will access it using the following command"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-bash"},'curl -X GET -H "Authorization: Bearer {accessToken}" https://door.casdoor.com/api/userinfo\n')),(0,n.kt)("p",{parentName:"li"},"The custom provider should return at least the following information:"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "name": "admin",\n  "preferred_username": "Admin",\n  "email": "admin@example.com",\n  "picture": "https://casbin.org/img/casbin.svg"\n}\n'))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("inlineCode",{parentName:"p"},"Favicon")," is the logo URL of a custom provider."),(0,n.kt)("p",{parentName:"li"},"This logo will be displayed on Casdoor's login page together with other third-party login providers."))))}c.isMDXComponent=!0},38744:(e,t,o)=>{o.d(t,{Z:()=>r});const r=o.p+"assets/images/customprovider-16ebdacc5cde9ec89c0fb2cd4d42a536.png"}}]);