"use strict";(self.webpackChunkcasdoor_website=self.webpackChunkcasdoor_website||[]).push([[5919],{3905:(e,a,t)=>{t.d(a,{Zo:()=>c,kt:()=>u});var o=t(67294);function r(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function n(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);a&&(o=o.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,o)}return t}function i(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?n(Object(t),!0).forEach((function(a){r(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):n(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function l(e,a){if(null==e)return{};var t,o,r=function(e,a){if(null==e)return{};var t,o,r={},n=Object.keys(e);for(o=0;o<n.length;o++)t=n[o],a.indexOf(t)>=0||(r[t]=e[t]);return r}(e,a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(o=0;o<n.length;o++)t=n[o],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var s=o.createContext({}),p=function(e){var a=o.useContext(s),t=a;return e&&(t="function"==typeof e?e(a):i(i({},a),e)),t},c=function(e){var a=p(e.components);return o.createElement(s.Provider,{value:a},e.children)},d={inlineCode:"code",wrapper:function(e){var a=e.children;return o.createElement(o.Fragment,{},a)}},m=o.forwardRef((function(e,a){var t=e.components,r=e.mdxType,n=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),m=p(t),u=r,k=m["".concat(s,".").concat(u)]||m[u]||d[u]||n;return t?o.createElement(k,i(i({ref:a},c),{},{components:t})):o.createElement(k,i({ref:a},c))}));function u(e,a){var t=arguments,r=a&&a.mdxType;if("string"==typeof e||r){var n=t.length,i=new Array(n);i[0]=m;var l={};for(var s in a)hasOwnProperty.call(a,s)&&(l[s]=a[s]);l.originalType=e,l.mdxType="string"==typeof e?e:r,i[1]=l;for(var p=2;p<n;p++)i[p]=t[p];return o.createElement.apply(null,i)}return o.createElement.apply(null,t)}m.displayName="MDXCreateElement"},56360:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>s,contentTitle:()=>i,default:()=>d,frontMatter:()=>n,metadata:()=>l,toc:()=>p});var o=t(87462),r=(t(67294),t(3905));const n={title:"AWS Client VPN",description:"Usando o Casdoor como um SAML IdP",keywords:["SAML","IdP"],authors:["UsherFall"]},i=void 0,l={unversionedId:"how-to-connect/saml/aws",id:"how-to-connect/saml/aws",title:"AWS Client VPN",description:"Usando o Casdoor como um SAML IdP",source:"@site/i18n/pt/docusaurus-plugin-content-docs/current/how-to-connect/saml/aws.md",sourceDirName:"how-to-connect/saml",slug:"/how-to-connect/saml/aws",permalink:"/pt/docs/how-to-connect/saml/aws",draft:!1,editUrl:"https://github.com/casdoor/casdoor-website/edit/master/docs/how-to-connect/saml/aws.md",tags:[],version:"current",frontMatter:{title:"AWS Client VPN",description:"Usando o Casdoor como um SAML IdP",keywords:["SAML","IdP"],authors:["UsherFall"]},sidebar:"tutorialSidebar",previous:{title:"Vis\xe3o Geral",permalink:"/pt/docs/how-to-connect/saml/overview"},next:{title:"Keycloak",permalink:"/pt/docs/how-to-connect/saml/keycloak"}},s={},p=[{value:"Casdoor como um SAML IdP no AWS Client VPN",id:"casdoor-como-um-saml-idp-no-aws-client-vpn",level:2},{value:"Pr\xe9-requisitos",id:"pr\xe9-requisitos",level:2},{value:"Configurar Aplicativo SAML",id:"configurar-aplicativo-saml",level:2},{value:"Configurar AWS",id:"configurar-aws",level:2},{value:"Configurar o Casdoor como um Provedor de Identidade AWS",id:"configurar-o-casdoor-como-um-provedor-de-identidade-aws",level:3},{value:"Criar um Endpoint de VPN do Cliente AWS",id:"criar-um-endpoint-de-vpn-do-cliente-aws",level:3},{value:"Associar uma VPN do Cliente com um VPC Alvo",id:"associar-uma-vpn-do-cliente-com-um-vpc-alvo",level:3},{value:"Configurar Autoriza\xe7\xe3o Espec\xedfica de Grupo SAML",id:"configurar-autoriza\xe7\xe3o-espec\xedfica-de-grupo-saml",level:3},{value:"Conectar \xe0 VPN do Cliente",id:"conectar-\xe0-vpn-do-cliente",level:2}],c={toc:p};function d(e){let{components:a,...n}=e;return(0,r.kt)("wrapper",(0,o.Z)({},c,n,{components:a,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"casdoor-como-um-saml-idp-no-aws-client-vpn"},"Casdoor como um SAML IdP no AWS Client VPN"),(0,r.kt)("p",null,"Este guia mostrar\xe1 como configurar o Casdoor e o AWS Client VPN para adicionar o Casdoor como um SAML IdP no AWS Client VPN."),(0,r.kt)("h2",{id:"pr\xe9-requisitos"},"Pr\xe9-requisitos"),(0,r.kt)("p",null,"Para completar esta configura\xe7\xe3o, voc\xea precisar\xe1:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Uma conta AWS com direitos administrativos para acessar as configura\xe7\xf5es do provedor de servi\xe7o.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Um Amazon VPC com uma inst\xe2ncia EC2"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://docs.aws.amazon.com/zh_cn/vpc/latest/userguide/vpc-getting-started.html"},"Configurando o VPC")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://docs.aws.amazon.com/zh_cn/AWSEC2/latest/UserGuide/EC2_GetStarted.html"},"Iniciando uma inst\xe2ncia EC2"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"No Grupo de Seguran\xe7a da inst\xe2ncia, permita o tr\xe1fego ICMP do intervalo CIDR do VPC - isso \xe9 necess\xe1rio para testes."))))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Um certificado privado importado para o ",(0,r.kt)("a",{parentName:"p",href:"https://aws.amazon.com/cn/certificate-manager/"},"AWS Certificate Manager (ACM)")),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://docs.aws.amazon.com/zh_cn/vpn/latest/clientvpn-admin/what-is.html"},"Gerando e importando um certificado para o ACM")))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Um sistema Windows ou Mac executando o software AWS Client VPN mais recente."),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://aws.amazon.com/cn/vpn/client-vpn-download/"},"Baixe o software"))))),(0,r.kt)("h2",{id:"configurar-aplicativo-saml"},"Configurar Aplicativo SAML"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"No Aplicativo Casdoor, defina a ",(0,r.kt)("inlineCode",{parentName:"li"},"URL de Redirecionamento")," para ",(0,r.kt)("inlineCode",{parentName:"li"},"urn:amazon:webservices:clientvpn"),".")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"saml_aws_redirect_url.png",src:t(29984).Z,width:"1676",height:"1144"})),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Defina a ",(0,r.kt)("inlineCode",{parentName:"li"},"URL de Resposta SAML")," para ",(0,r.kt)("inlineCode",{parentName:"li"},"http://127.0.0.1:35001"),".")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"saml_aws_reply_url.png",src:t(44307).Z,width:"1506",height:"840"})),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Salve o conte\xfado no ",(0,r.kt)("inlineCode",{parentName:"li"},"Metadados SAML")," como um arquivo XML.")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"saml_aws_metadata.png",src:t(96587).Z,width:"2780",height:"748"})),(0,r.kt)("h2",{id:"configurar-aws"},"Configurar AWS"),(0,r.kt)("h3",{id:"configurar-o-casdoor-como-um-provedor-de-identidade-aws"},"Configurar o Casdoor como um Provedor de Identidade AWS"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Abrir o console IAM e selecionar ",(0,r.kt)("strong",{parentName:"p"},"Provedores de identidade")," na barra de navega\xe7\xe3o.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Clique em ",(0,r.kt)("strong",{parentName:"p"},"Criar um Provedor"),".")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Especifique SAML para o Tipo de Provedor, adicione um nome \xfanico para este provedor e fa\xe7a o upload do documento de metadados - o mesmo arquivo que voc\xea salvou do Aplicativo Casdoor na se\xe7\xe3o anterior.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Clique em ",(0,r.kt)("strong",{parentName:"p"},"Pr\xf3ximo Passo"),". Na pr\xf3xima tela, clique em ",(0,r.kt)("strong",{parentName:"p"},"Criar"),"."))),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"saml_aws_create.png",src:t(89004).Z,width:"2720",height:"1206"})),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"saml_aws_choose_metadata.png",src:t(26080).Z,width:"1810",height:"1104"})),(0,r.kt)("h3",{id:"criar-um-endpoint-de-vpn-do-cliente-aws"},"Criar um Endpoint de VPN do Cliente AWS"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Abrir o console Amazon VPC em uma Regi\xe3o AWS de sua escolha.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"No menu de navega\xe7\xe3o do lado esquerdo, selecione ",(0,r.kt)("strong",{parentName:"p"},"Endpoints de VPN do Cliente")," em ",(0,r.kt)("strong",{parentName:"p"},"Rede Privada Virtual (VPN)"),".")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Clique em ",(0,r.kt)("strong",{parentName:"p"},"Criar Endpoint de VPN do Cliente"),".")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Digite o intervalo de IP para seus usu\xe1rios remotos no campo ",(0,r.kt)("strong",{parentName:"p"},"CIDR IPv4 do Cliente")," para alocar um intervalo de IP.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Para ",(0,r.kt)("strong",{parentName:"p"},"ARN do Certificado do Servidor"),", selecione o certificado que voc\xea criou.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Para Op\xe7\xf5es de Autentica\xe7\xe3o, selecione ",(0,r.kt)("strong",{parentName:"p"},"Usar autentica\xe7\xe3o baseada em usu\xe1rio"),", em seguida, ",(0,r.kt)("strong",{parentName:"p"},"Autentica\xe7\xe3o federada"),".")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Para ",(0,r.kt)("strong",{parentName:"p"},"ARN do provedor SAML"),", selecione o provedor de identidade que voc\xea criou.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Clique em ",(0,r.kt)("strong",{parentName:"p"},"Criar Endpoint de VPN do Cliente"),"."))),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"saml_aws_vpn_endpoint.png",src:t(23539).Z,width:"2800",height:"704"})),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"saml_aws_create_vpn.png",src:t(81674).Z,width:"1596",height:"1232"})),(0,r.kt)("h3",{id:"associar-uma-vpn-do-cliente-com-um-vpc-alvo"},"Associar uma VPN do Cliente com um VPC Alvo"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Selecione ",(0,r.kt)("strong",{parentName:"p"},"Associa\xe7\xf5es de rede alvo")," nas op\xe7\xf5es de VPN do Cliente, em seguida, clique em ",(0,r.kt)("strong",{parentName:"p"},"Associar rede alvo"),".")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"No menu suspenso, selecione o VPC alvo e a sub-rede que voc\xea deseja associar ao seu endpoint."))),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"saml_aws_target_network.png",src:t(21010).Z,width:"2792",height:"1226"})),(0,r.kt)("h3",{id:"configurar-autoriza\xe7\xe3o-espec\xedfica-de-grupo-saml"},"Configurar Autoriza\xe7\xe3o Espec\xedfica de Grupo SAML"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Escolha a aba ",(0,r.kt)("strong",{parentName:"p"},"Regras de autoriza\xe7\xe3o")," nas suas op\xe7\xf5es de VPN do Cliente e clique em ",(0,r.kt)("strong",{parentName:"p"},"Adicionar regra de autoriza\xe7\xe3o"),".")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Para Rede de destino a habilitar, especifique o endere\xe7o IP da sua inst\xe2ncia EC2 criada nos pr\xe9-requisitos. Por exemplo, ",(0,r.kt)("inlineCode",{parentName:"p"},"172.31.16.0/20"),".")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Em Conceder acesso a, selecione ",(0,r.kt)("strong",{parentName:"p"},"Permitir acesso a usu\xe1rios em um grupo de acesso espec\xedfico"),". Por exemplo, ",(0,r.kt)("inlineCode",{parentName:"p"},"casdoor"),".")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Forne\xe7a uma descri\xe7\xe3o opcional e clique em ",(0,r.kt)("strong",{parentName:"p"},"Adicionar regra de autoriza\xe7\xe3o"),"."))),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"saml_aws_rule.png",src:t(60420).Z,width:"1636",height:"1228"})),(0,r.kt)("h2",{id:"conectar-\xe0-vpn-do-cliente"},"Conectar \xe0 VPN do Cliente"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Selecione o endpoint de VPN do Cliente que voc\xea acabou de criar. Agora deve estar no estado Dispon\xedvel.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Clique em ",(0,r.kt)("strong",{parentName:"p"},"Baixar Configura\xe7\xe3o do Cliente")," para baixar o perfil de configura\xe7\xe3o para sua \xe1rea de trabalho.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Abra o aplicativo de desktop AWS Client VPN em sua m\xe1quina.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"No menu superior, selecione Arquivo e Gerenciar Perfis.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Clique em Adicionar Perfil e aponte para o arquivo recentemente baixado.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Voc\xea agora deve ver o perfil na lista no software AWS Client VPN. Selecione-o e clique em Conectar."))),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"saml_aws_download.png",src:t(19303).Z,width:"2762",height:"1202"})),(0,r.kt)("video",{src:"/video/saml_aws.mp4",controls:"controls",width:"100%"}))}d.isMDXComponent=!0},26080:(e,a,t)=>{t.d(a,{Z:()=>o});const o=t.p+"assets/images/saml_aws_choose_metadata-03a549be89dc751e9fd2d7010b3c1e64.png"},89004:(e,a,t)=>{t.d(a,{Z:()=>o});const o=t.p+"assets/images/saml_aws_create-7ba7254466b4227d6e54ef961afa667d.png"},81674:(e,a,t)=>{t.d(a,{Z:()=>o});const o=t.p+"assets/images/saml_aws_create_vpn-d8bbc595d25d862d98c407867d78a5b9.png"},19303:(e,a,t)=>{t.d(a,{Z:()=>o});const o=t.p+"assets/images/saml_aws_download-90aa0d174201c9b1f5dd07dfaeffc2ac.png"},96587:(e,a,t)=>{t.d(a,{Z:()=>o});const o=t.p+"assets/images/saml_aws_metadata-3e50a3c4d4eb20b91f65e4360bc24f1b.png"},29984:(e,a,t)=>{t.d(a,{Z:()=>o});const o=t.p+"assets/images/saml_aws_redirect_url-0f2682850b9a51fec5b58831f4f91566.png"},44307:(e,a,t)=>{t.d(a,{Z:()=>o});const o=t.p+"assets/images/saml_aws_reply_url-bdeed2e8e71987a8378c75016fec2b0d.png"},60420:(e,a,t)=>{t.d(a,{Z:()=>o});const o=t.p+"assets/images/saml_aws_rule-92a9e746b662c901dab47f7f80949371.png"},21010:(e,a,t)=>{t.d(a,{Z:()=>o});const o=t.p+"assets/images/saml_aws_target_network-f29fac01d7049a42983061212ba83ef7.png"},23539:(e,a,t)=>{t.d(a,{Z:()=>o});const o=t.p+"assets/images/saml_aws_vpn_endpoint-8c18603d3d8947a56ccbbb4773450715.png"}}]);